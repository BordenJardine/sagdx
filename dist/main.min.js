(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\data\\CinderProfiles.js":[function(require,module,exports){
var CinderProfiles = function() {
};

CinderProfiles.PROFILES = [
  {
    name: 'Demo 1',
    image: 'demo.png'
  },
  {
    name: 'Demo 2',
    image: 'demo2.png'
  }
];

module.exports = CinderProfiles;

},{}],"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\entities\\CinderProfile.js":[function(require,module,exports){
var CinderProfile = function(game, direction) {
  Phaser.Group.call(this, game);
  this.game = game;
  this.profile = null;
  this.selectionResult = null;
  this.generateProfile(direction);
};

CinderProfile.prototype = Object.create(Phaser.Group.prototype);
CinderProfile.prototype.constructor = CinderProfile;

CinderProfile.prototype.generateProfile = function(direction) {
  // Generate or randomly pick already generated image
  // Generate or randomly pick already generated profile text
  // Generate result of R/L swipes for this profile

  window.CurrentProfileIdx += 1;
  if (window.CurrentProfileIdx === window.CinderProfiles.length)
    window.CurrentProfileIdx = 0;

  this.profile = window.CinderProfiles[window.CurrentProfileIdx];

  var width = this.game.width;
  var cinderFrameW = this.game.cache.getImage('cinderFrame').width;
  var cinderFrameH = this.game.cache.getImage('cinderFrame').height;
  var offset = (width - cinderFrameW) / 2;

  if (direction === 1)
    this.x = -width;
  else
    this.x = width * 2;

  this.image = this.create(offset, offset, this.profile.image);
  this.name = new Phaser.Text(this.game, offset, cinderFrameH + offset, this.profile.name);
  this.add(this.name);

  var tween = this.game.add.tween(this);
  tween.to({ x: 0 }, 500, Phaser.Easing.Cubic.Out, true);
  tween.start();
};

module.exports = CinderProfile;

},{}],"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(414, 606, Phaser.AUTO, 'body');

window.Utils = require('./utils');

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');

},{"./states/boot":"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\states\\boot.js","./states/game":"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\states\\game.js","./states/menu":"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\states\\menu.js","./states/preloader":"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\states\\preloader.js","./states/splash":"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\states\\splash.js","./utils":"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\utils.js"}],"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\states\\boot.js":[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;
    this.game.stage.backgroundColor = 0xf6f6f2;

    this.game.scale.pageAlignHorizontally = true;
    this.game.scale.pageAlignVertically = true;

    if (!this.game.device.desktop) {
      this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;

      this.game.scale.minWidth =  260;
      this.game.scale.minHeight = 480;
      this.game.scale.maxWidth = 414;
      this.game.scale.maxHeight = 736;

      this.game.scale.setScreenSize(true);
    }

    this.game.scale.refresh();

    this.game.state.start('Preloader');
  }
};

},{}],"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\states\\game.js":[function(require,module,exports){
var SwipeManager = require('../utilities/SwipeManager.js');
var CinderProfile = require('../entities/CinderProfile.js');

var Game = function () {
  currentCinderProfile = null;
  lastSwipeDirection = SwipeManager.SWIPE_DIRECTIONS.RIGHT;
};

Game.prototype = {
  create: function () {
    this.game.plugins.add(new SwipeManager(this.game, {}, this.onSwipe, this));
    currentCinderProfile = new CinderProfile(this.game, lastSwipeDirection);
  },

  onSwipe: function(swipeDirection) {
    var to = -this.game.width;
    lastSwipeDirection = swipeDirection;

    if (swipeDirection == SwipeManager.SWIPE_DIRECTIONS.RIGHT) {
      to = this.game.width;
    }

    var tween = this.game.add.tween(currentCinderProfile);
    tween.onComplete.add(this.onTweenComplete, this);
    tween.to({ x: to }, 700, Phaser.Easing.Cubic.Out, true);
    tween.start();
  },

  onTweenComplete: function() {
    // execute currentCinderProfile.selectionResult
    // or generate new profile:
    currentCinderProfile = new CinderProfile(this.game, lastSwipeDirection);
  },

  update: function () {
  }
};

module.exports = Game;

},{"../entities/CinderProfile.js":"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\entities\\CinderProfile.js","../utilities/SwipeManager.js":"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\utilities\\SwipeManager.js"}],"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\states\\menu.js":[function(require,module,exports){
var Menu = function () {
};

module.exports = Menu;

Menu.prototype = {
  create: function () {
    var startText = "Press to start!";
    var textProps = { font: '24pt Arial',
                      fill: '#C24300',
                      strokeThickness: 0 };

    var cinderLogoW = this.game.cache.getImage('cinderLogo').width;
    var cinderLogoH = this.game.cache.getImage('cinderLogo').height;

    var x = (this.game.width / 2) - (cinderLogoW / 2);
    var y = (this.game.height / 3) - (cinderLogoH / 2);

    this.game.add.sprite(x, y, 'cinderLogo');
    this.game.add.text(x, y + cinderLogoH * 1.5, startText, textProps);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    //if (!!this.game.device.desktop) {
    if (!this.game.device.desktop) {
      this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.startFullScreen(true);
    }

    this.game.state.start('Game');
  }
};

},{}],"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\states\\preloader.js":[function(require,module,exports){
var CinderProfiles = require('../data/CinderProfiles.js');

var Preloader = function (game) {
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

  preload: function () {
    var assetRoot = 'assets/';

    this.asset = this.add.sprite(320, 240, 'preloader');

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);

    window.CurrentProfileIdx = -1;
    window.CinderProfiles = this.shuffleProfiles();

    this.load.image('cinderLogo', assetRoot + 'cinder-logo.png');
    this.load.image('cinderFrame', assetRoot + 'cinder-frame.png');

    for (var i = 0; i < window.CinderProfiles.length; i++) {
      this.load.image(window.CinderProfiles[i].image, assetRoot + window.CinderProfiles[i].image);
    }
  },

  shuffleProfiles: function() {
    var currentIdx = CinderProfiles.PROFILES.length, tmp, randomIdx;

    while (0 !== currentIdx) {
      randomIdx = Math.floor(Math.random() * currentIdx);
      currentIdx -= 1;

      tmp = CinderProfiles.PROFILES[currentIdx];
      CinderProfiles.PROFILES[currentIdx] = CinderProfiles.PROFILES[randomIdx];
      CinderProfiles.PROFILES[randomIdx] = tmp;
    }

    return CinderProfiles.PROFILES;
  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
      this.game.state.start('Menu');
    }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

},{"../data/CinderProfiles.js":"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\data\\CinderProfiles.js"}],"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\states\\splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\utilities\\SwipeManager.js":[function(require,module,exports){
var SwipeManager = function(game, bounds, callback, receiver) {
  Phaser.Plugin.call(this, game);
  this.game = game;
  this.bounds = bounds;
  this.onCooldown = false;
  this.cooldown = 0;
  this.onSwipe = callback.bind(receiver);
  this.swipeDirection = SwipeManager.SWIPE_DIRECTIONS.LEFT;
};

SwipeManager.prototype = Object.create(Phaser.Plugin.prototype);
SwipeManager.prototype.constructor = SwipeManager;

SwipeManager.prototype.update = function() {
  // TODO: Ensure majority of swipe falls within this.bounds (?)
  var start = this.game.input.activePointer.positionDown;
  var end = this.game.input.activePointer.position;

  var distance = Phaser.Point.distance(start, end);
  var duration = this.game.input.activePointer.duration;

  if (duration > 0 && !this.onCooldown) {
    if (distance > SwipeManager.SWIPE_DIST && duration < SwipeManager.SWIPE_TIME) {
      swipeDirection = end.x > start.x ? SwipeManager.SWIPE_DIRECTIONS.RIGHT :
        SwipeManager.SWIPE_DIRECTIONS.LEFT;
      this.onSwipe(swipeDirection);
      this.onCooldown = true;
    }
  }

  if (this.onCooldown) {
    this.cooldown += 1;

    if (this.cooldown >= SwipeManager.SWIPE_COOLDOWN) {
      this.cooldown = 0;
      this.onCooldown = false;
    }
  }
};

SwipeManager.SWIPE_TIME = 250;
SwipeManager.SWIPE_DIST = 100;
SwipeManager.SWIPE_COOLDOWN = 25;
SwipeManager.SWIPE_DIRECTIONS = {
  LEFT: 0,
  RIGHT: 1
};

module.exports = SwipeManager;

},{}],"C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\utils.js":[function(require,module,exports){
var Utils = {
  containsObject: function(obj, list) {
    var i;
    for (i = 0; i < list.length; i++) {
      if (list[i] === obj) {
        return true;
      }
    }

    return false;
  }
};

module.exports = Utils;

},{}]},{},["C:\\Users\\Admin\\Documents\\Projects\\sagdx\\src\\js\\main.js"])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZGF0YS9DaW5kZXJQcm9maWxlcy5qcyIsInNyYy9qcy9lbnRpdGllcy9DaW5kZXJQcm9maWxlLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvc3RhdGVzL2Jvb3QuanMiLCJzcmMvanMvc3RhdGVzL2dhbWUuanMiLCJzcmMvanMvc3RhdGVzL21lbnUuanMiLCJzcmMvanMvc3RhdGVzL3ByZWxvYWRlci5qcyIsInNyYy9qcy9zdGF0ZXMvc3BsYXNoLmpzIiwic3JjL2pzL3V0aWxpdGllcy9Td2lwZU1hbmFnZXIuanMiLCJzcmMvanMvdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgQ2luZGVyUHJvZmlsZXMgPSBmdW5jdGlvbigpIHtcclxufTtcclxuXHJcbkNpbmRlclByb2ZpbGVzLlBST0ZJTEVTID0gW1xyXG4gIHtcclxuICAgIG5hbWU6ICdEZW1vIDEnLFxyXG4gICAgaW1hZ2U6ICdkZW1vLnBuZydcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdEZW1vIDInLFxyXG4gICAgaW1hZ2U6ICdkZW1vMi5wbmcnXHJcbiAgfVxyXG5dO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDaW5kZXJQcm9maWxlcztcclxuIiwidmFyIENpbmRlclByb2ZpbGUgPSBmdW5jdGlvbihnYW1lLCBkaXJlY3Rpb24pIHtcclxuICBQaGFzZXIuR3JvdXAuY2FsbCh0aGlzLCBnYW1lKTtcclxuICB0aGlzLmdhbWUgPSBnYW1lO1xyXG4gIHRoaXMucHJvZmlsZSA9IG51bGw7XHJcbiAgdGhpcy5zZWxlY3Rpb25SZXN1bHQgPSBudWxsO1xyXG4gIHRoaXMuZ2VuZXJhdGVQcm9maWxlKGRpcmVjdGlvbik7XHJcbn07XHJcblxyXG5DaW5kZXJQcm9maWxlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLkdyb3VwLnByb3RvdHlwZSk7XHJcbkNpbmRlclByb2ZpbGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2luZGVyUHJvZmlsZTtcclxuXHJcbkNpbmRlclByb2ZpbGUucHJvdG90eXBlLmdlbmVyYXRlUHJvZmlsZSA9IGZ1bmN0aW9uKGRpcmVjdGlvbikge1xyXG4gIC8vIEdlbmVyYXRlIG9yIHJhbmRvbWx5IHBpY2sgYWxyZWFkeSBnZW5lcmF0ZWQgaW1hZ2VcclxuICAvLyBHZW5lcmF0ZSBvciByYW5kb21seSBwaWNrIGFscmVhZHkgZ2VuZXJhdGVkIHByb2ZpbGUgdGV4dFxyXG4gIC8vIEdlbmVyYXRlIHJlc3VsdCBvZiBSL0wgc3dpcGVzIGZvciB0aGlzIHByb2ZpbGVcclxuXHJcbiAgd2luZG93LkN1cnJlbnRQcm9maWxlSWR4ICs9IDE7XHJcbiAgaWYgKHdpbmRvdy5DdXJyZW50UHJvZmlsZUlkeCA9PT0gd2luZG93LkNpbmRlclByb2ZpbGVzLmxlbmd0aClcclxuICAgIHdpbmRvdy5DdXJyZW50UHJvZmlsZUlkeCA9IDA7XHJcblxyXG4gIHRoaXMucHJvZmlsZSA9IHdpbmRvdy5DaW5kZXJQcm9maWxlc1t3aW5kb3cuQ3VycmVudFByb2ZpbGVJZHhdO1xyXG5cclxuICB2YXIgd2lkdGggPSB0aGlzLmdhbWUud2lkdGg7XHJcbiAgdmFyIGNpbmRlckZyYW1lVyA9IHRoaXMuZ2FtZS5jYWNoZS5nZXRJbWFnZSgnY2luZGVyRnJhbWUnKS53aWR0aDtcclxuICB2YXIgY2luZGVyRnJhbWVIID0gdGhpcy5nYW1lLmNhY2hlLmdldEltYWdlKCdjaW5kZXJGcmFtZScpLmhlaWdodDtcclxuICB2YXIgb2Zmc2V0ID0gKHdpZHRoIC0gY2luZGVyRnJhbWVXKSAvIDI7XHJcblxyXG4gIGlmIChkaXJlY3Rpb24gPT09IDEpXHJcbiAgICB0aGlzLnggPSAtd2lkdGg7XHJcbiAgZWxzZVxyXG4gICAgdGhpcy54ID0gd2lkdGggKiAyO1xyXG5cclxuICB0aGlzLmltYWdlID0gdGhpcy5jcmVhdGUob2Zmc2V0LCBvZmZzZXQsIHRoaXMucHJvZmlsZS5pbWFnZSk7XHJcbiAgdGhpcy5uYW1lID0gbmV3IFBoYXNlci5UZXh0KHRoaXMuZ2FtZSwgb2Zmc2V0LCBjaW5kZXJGcmFtZUggKyBvZmZzZXQsIHRoaXMucHJvZmlsZS5uYW1lKTtcclxuICB0aGlzLmFkZCh0aGlzLm5hbWUpO1xyXG5cclxuICB2YXIgdHdlZW4gPSB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRoaXMpO1xyXG4gIHR3ZWVuLnRvKHsgeDogMCB9LCA1MDAsIFBoYXNlci5FYXNpbmcuQ3ViaWMuT3V0LCB0cnVlKTtcclxuICB0d2Vlbi5zdGFydCgpO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDaW5kZXJQcm9maWxlO1xyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG52YXIgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZSg0MTQsIDYwNiwgUGhhc2VyLkFVVE8sICdib2R5Jyk7XHJcblxyXG53aW5kb3cuVXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XHJcblxyXG5nYW1lLnN0YXRlLmFkZCgnQm9vdCcsIHJlcXVpcmUoJy4vc3RhdGVzL2Jvb3QnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdTcGxhc2gnLCByZXF1aXJlKCcuL3N0YXRlcy9zcGxhc2gnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdQcmVsb2FkZXInLCByZXF1aXJlKCcuL3N0YXRlcy9wcmVsb2FkZXInKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdNZW51JywgcmVxdWlyZSgnLi9zdGF0ZXMvbWVudScpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ0dhbWUnLCByZXF1aXJlKCcuL3N0YXRlcy9nYW1lJykpO1xyXG5cclxuZ2FtZS5zdGF0ZS5zdGFydCgnQm9vdCcpO1xyXG4iLCJ2YXIgQm9vdCA9IGZ1bmN0aW9uICgpIHt9O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBCb290O1xyXG5cclxuQm9vdC5wcm90b3R5cGUgPSB7XHJcblxyXG4gIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgncHJlbG9hZGVyJywgJ2Fzc2V0cy9wcmVsb2FkZXIuZ2lmJyk7XHJcbiAgfSxcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmdhbWUuaW5wdXQubWF4UG9pbnRlcnMgPSAxO1xyXG4gICAgdGhpcy5nYW1lLnN0YWdlLmJhY2tncm91bmRDb2xvciA9IDB4ZjZmNmYyO1xyXG5cclxuICAgIHRoaXMuZ2FtZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xyXG4gICAgdGhpcy5nYW1lLnNjYWxlLnBhZ2VBbGlnblZlcnRpY2FsbHkgPSB0cnVlO1xyXG5cclxuICAgIGlmICghdGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xyXG5cclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1pbldpZHRoID0gIDI2MDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1pbkhlaWdodCA9IDQ4MDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1heFdpZHRoID0gNDE0O1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWF4SGVpZ2h0ID0gNzM2O1xyXG5cclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLnNldFNjcmVlblNpemUodHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5nYW1lLnNjYWxlLnJlZnJlc2goKTtcclxuXHJcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ1ByZWxvYWRlcicpO1xyXG4gIH1cclxufTtcclxuIiwidmFyIFN3aXBlTWFuYWdlciA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9Td2lwZU1hbmFnZXIuanMnKTtcclxudmFyIENpbmRlclByb2ZpbGUgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9DaW5kZXJQcm9maWxlLmpzJyk7XHJcblxyXG52YXIgR2FtZSA9IGZ1bmN0aW9uICgpIHtcclxuICBjdXJyZW50Q2luZGVyUHJvZmlsZSA9IG51bGw7XHJcbiAgbGFzdFN3aXBlRGlyZWN0aW9uID0gU3dpcGVNYW5hZ2VyLlNXSVBFX0RJUkVDVElPTlMuUklHSFQ7XHJcbn07XHJcblxyXG5HYW1lLnByb3RvdHlwZSA9IHtcclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuZ2FtZS5wbHVnaW5zLmFkZChuZXcgU3dpcGVNYW5hZ2VyKHRoaXMuZ2FtZSwge30sIHRoaXMub25Td2lwZSwgdGhpcykpO1xyXG4gICAgY3VycmVudENpbmRlclByb2ZpbGUgPSBuZXcgQ2luZGVyUHJvZmlsZSh0aGlzLmdhbWUsIGxhc3RTd2lwZURpcmVjdGlvbik7XHJcbiAgfSxcclxuXHJcbiAgb25Td2lwZTogZnVuY3Rpb24oc3dpcGVEaXJlY3Rpb24pIHtcclxuICAgIHZhciB0byA9IC10aGlzLmdhbWUud2lkdGg7XHJcbiAgICBsYXN0U3dpcGVEaXJlY3Rpb24gPSBzd2lwZURpcmVjdGlvbjtcclxuXHJcbiAgICBpZiAoc3dpcGVEaXJlY3Rpb24gPT0gU3dpcGVNYW5hZ2VyLlNXSVBFX0RJUkVDVElPTlMuUklHSFQpIHtcclxuICAgICAgdG8gPSB0aGlzLmdhbWUud2lkdGg7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHR3ZWVuID0gdGhpcy5nYW1lLmFkZC50d2VlbihjdXJyZW50Q2luZGVyUHJvZmlsZSk7XHJcbiAgICB0d2Vlbi5vbkNvbXBsZXRlLmFkZCh0aGlzLm9uVHdlZW5Db21wbGV0ZSwgdGhpcyk7XHJcbiAgICB0d2Vlbi50byh7IHg6IHRvIH0sIDcwMCwgUGhhc2VyLkVhc2luZy5DdWJpYy5PdXQsIHRydWUpO1xyXG4gICAgdHdlZW4uc3RhcnQoKTtcclxuICB9LFxyXG5cclxuICBvblR3ZWVuQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgLy8gZXhlY3V0ZSBjdXJyZW50Q2luZGVyUHJvZmlsZS5zZWxlY3Rpb25SZXN1bHRcclxuICAgIC8vIG9yIGdlbmVyYXRlIG5ldyBwcm9maWxlOlxyXG4gICAgY3VycmVudENpbmRlclByb2ZpbGUgPSBuZXcgQ2luZGVyUHJvZmlsZSh0aGlzLmdhbWUsIGxhc3RTd2lwZURpcmVjdGlvbik7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgfVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBHYW1lO1xyXG4iLCJ2YXIgTWVudSA9IGZ1bmN0aW9uICgpIHtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTWVudTtcclxuXHJcbk1lbnUucHJvdG90eXBlID0ge1xyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHN0YXJ0VGV4dCA9IFwiUHJlc3MgdG8gc3RhcnQhXCI7XHJcbiAgICB2YXIgdGV4dFByb3BzID0geyBmb250OiAnMjRwdCBBcmlhbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICBmaWxsOiAnI0MyNDMwMCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICBzdHJva2VUaGlja25lc3M6IDAgfTtcclxuXHJcbiAgICB2YXIgY2luZGVyTG9nb1cgPSB0aGlzLmdhbWUuY2FjaGUuZ2V0SW1hZ2UoJ2NpbmRlckxvZ28nKS53aWR0aDtcclxuICAgIHZhciBjaW5kZXJMb2dvSCA9IHRoaXMuZ2FtZS5jYWNoZS5nZXRJbWFnZSgnY2luZGVyTG9nbycpLmhlaWdodDtcclxuXHJcbiAgICB2YXIgeCA9ICh0aGlzLmdhbWUud2lkdGggLyAyKSAtIChjaW5kZXJMb2dvVyAvIDIpO1xyXG4gICAgdmFyIHkgPSAodGhpcy5nYW1lLmhlaWdodCAvIDMpIC0gKGNpbmRlckxvZ29IIC8gMik7XHJcblxyXG4gICAgdGhpcy5nYW1lLmFkZC5zcHJpdGUoeCwgeSwgJ2NpbmRlckxvZ28nKTtcclxuICAgIHRoaXMuZ2FtZS5hZGQudGV4dCh4LCB5ICsgY2luZGVyTG9nb0ggKiAxLjUsIHN0YXJ0VGV4dCwgdGV4dFByb3BzKTtcclxuXHJcbiAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5vbkRvd24sIHRoaXMpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gIH0sXHJcblxyXG4gIG9uRG93bjogZnVuY3Rpb24gKCkge1xyXG4gICAgLy9pZiAoISF0aGlzLmdhbWUuZGV2aWNlLmRlc2t0b3ApIHtcclxuICAgIGlmICghdGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5mdWxsU2NyZWVuU2NhbGVNb2RlID0gUGhhc2VyLlNjYWxlTWFuYWdlci5TSE9XX0FMTDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLnN0YXJ0RnVsbFNjcmVlbih0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ0dhbWUnKTtcclxuICB9XHJcbn07XHJcbiIsInZhciBDaW5kZXJQcm9maWxlcyA9IHJlcXVpcmUoJy4uL2RhdGEvQ2luZGVyUHJvZmlsZXMuanMnKTtcclxuXHJcbnZhciBQcmVsb2FkZXIgPSBmdW5jdGlvbiAoZ2FtZSkge1xyXG4gIHRoaXMuYXNzZXQgPSBudWxsO1xyXG4gIHRoaXMucmVhZHkgPSBmYWxzZTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUHJlbG9hZGVyO1xyXG5cclxuUHJlbG9hZGVyLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgcHJlbG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGFzc2V0Um9vdCA9ICdhc3NldHMvJztcclxuXHJcbiAgICB0aGlzLmFzc2V0ID0gdGhpcy5hZGQuc3ByaXRlKDMyMCwgMjQwLCAncHJlbG9hZGVyJyk7XHJcblxyXG4gICAgdGhpcy5sb2FkLm9uTG9hZENvbXBsZXRlLmFkZE9uY2UodGhpcy5vbkxvYWRDb21wbGV0ZSwgdGhpcyk7XHJcbiAgICB0aGlzLmxvYWQuc2V0UHJlbG9hZFNwcml0ZSh0aGlzLmFzc2V0KTtcclxuXHJcbiAgICB3aW5kb3cuQ3VycmVudFByb2ZpbGVJZHggPSAtMTtcclxuICAgIHdpbmRvdy5DaW5kZXJQcm9maWxlcyA9IHRoaXMuc2h1ZmZsZVByb2ZpbGVzKCk7XHJcblxyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdjaW5kZXJMb2dvJywgYXNzZXRSb290ICsgJ2NpbmRlci1sb2dvLnBuZycpO1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdjaW5kZXJGcmFtZScsIGFzc2V0Um9vdCArICdjaW5kZXItZnJhbWUucG5nJyk7XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aW5kb3cuQ2luZGVyUHJvZmlsZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgdGhpcy5sb2FkLmltYWdlKHdpbmRvdy5DaW5kZXJQcm9maWxlc1tpXS5pbWFnZSwgYXNzZXRSb290ICsgd2luZG93LkNpbmRlclByb2ZpbGVzW2ldLmltYWdlKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBzaHVmZmxlUHJvZmlsZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGN1cnJlbnRJZHggPSBDaW5kZXJQcm9maWxlcy5QUk9GSUxFUy5sZW5ndGgsIHRtcCwgcmFuZG9tSWR4O1xyXG5cclxuICAgIHdoaWxlICgwICE9PSBjdXJyZW50SWR4KSB7XHJcbiAgICAgIHJhbmRvbUlkeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGN1cnJlbnRJZHgpO1xyXG4gICAgICBjdXJyZW50SWR4IC09IDE7XHJcblxyXG4gICAgICB0bXAgPSBDaW5kZXJQcm9maWxlcy5QUk9GSUxFU1tjdXJyZW50SWR4XTtcclxuICAgICAgQ2luZGVyUHJvZmlsZXMuUFJPRklMRVNbY3VycmVudElkeF0gPSBDaW5kZXJQcm9maWxlcy5QUk9GSUxFU1tyYW5kb21JZHhdO1xyXG4gICAgICBDaW5kZXJQcm9maWxlcy5QUk9GSUxFU1tyYW5kb21JZHhdID0gdG1wO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBDaW5kZXJQcm9maWxlcy5QUk9GSUxFUztcclxuICB9LFxyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuYXNzZXQuY3JvcEVuYWJsZWQgPSBmYWxzZTtcclxuICB9LFxyXG5cclxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghIXRoaXMucmVhZHkpIHtcclxuICAgICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNZW51Jyk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgb25Mb2FkQ29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMucmVhZHkgPSB0cnVlO1xyXG4gIH1cclxufTtcclxuIiwidmFyIFNwbGFzaCA9IGZ1bmN0aW9uICgpIHtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gU3BsYXNoO1xyXG5cclxuU3BsYXNoLnByb3RvdHlwZSA9IHtcclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICB9XHJcbn07IiwidmFyIFN3aXBlTWFuYWdlciA9IGZ1bmN0aW9uKGdhbWUsIGJvdW5kcywgY2FsbGJhY2ssIHJlY2VpdmVyKSB7XHJcbiAgUGhhc2VyLlBsdWdpbi5jYWxsKHRoaXMsIGdhbWUpO1xyXG4gIHRoaXMuZ2FtZSA9IGdhbWU7XHJcbiAgdGhpcy5ib3VuZHMgPSBib3VuZHM7XHJcbiAgdGhpcy5vbkNvb2xkb3duID0gZmFsc2U7XHJcbiAgdGhpcy5jb29sZG93biA9IDA7XHJcbiAgdGhpcy5vblN3aXBlID0gY2FsbGJhY2suYmluZChyZWNlaXZlcik7XHJcbiAgdGhpcy5zd2lwZURpcmVjdGlvbiA9IFN3aXBlTWFuYWdlci5TV0lQRV9ESVJFQ1RJT05TLkxFRlQ7XHJcbn07XHJcblxyXG5Td2lwZU1hbmFnZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuUGx1Z2luLnByb3RvdHlwZSk7XHJcblN3aXBlTWFuYWdlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBTd2lwZU1hbmFnZXI7XHJcblxyXG5Td2lwZU1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gIC8vIFRPRE86IEVuc3VyZSBtYWpvcml0eSBvZiBzd2lwZSBmYWxscyB3aXRoaW4gdGhpcy5ib3VuZHMgKD8pXHJcbiAgdmFyIHN0YXJ0ID0gdGhpcy5nYW1lLmlucHV0LmFjdGl2ZVBvaW50ZXIucG9zaXRpb25Eb3duO1xyXG4gIHZhciBlbmQgPSB0aGlzLmdhbWUuaW5wdXQuYWN0aXZlUG9pbnRlci5wb3NpdGlvbjtcclxuXHJcbiAgdmFyIGRpc3RhbmNlID0gUGhhc2VyLlBvaW50LmRpc3RhbmNlKHN0YXJ0LCBlbmQpO1xyXG4gIHZhciBkdXJhdGlvbiA9IHRoaXMuZ2FtZS5pbnB1dC5hY3RpdmVQb2ludGVyLmR1cmF0aW9uO1xyXG5cclxuICBpZiAoZHVyYXRpb24gPiAwICYmICF0aGlzLm9uQ29vbGRvd24pIHtcclxuICAgIGlmIChkaXN0YW5jZSA+IFN3aXBlTWFuYWdlci5TV0lQRV9ESVNUICYmIGR1cmF0aW9uIDwgU3dpcGVNYW5hZ2VyLlNXSVBFX1RJTUUpIHtcclxuICAgICAgc3dpcGVEaXJlY3Rpb24gPSBlbmQueCA+IHN0YXJ0LnggPyBTd2lwZU1hbmFnZXIuU1dJUEVfRElSRUNUSU9OUy5SSUdIVCA6XHJcbiAgICAgICAgU3dpcGVNYW5hZ2VyLlNXSVBFX0RJUkVDVElPTlMuTEVGVDtcclxuICAgICAgdGhpcy5vblN3aXBlKHN3aXBlRGlyZWN0aW9uKTtcclxuICAgICAgdGhpcy5vbkNvb2xkb3duID0gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGlmICh0aGlzLm9uQ29vbGRvd24pIHtcclxuICAgIHRoaXMuY29vbGRvd24gKz0gMTtcclxuXHJcbiAgICBpZiAodGhpcy5jb29sZG93biA+PSBTd2lwZU1hbmFnZXIuU1dJUEVfQ09PTERPV04pIHtcclxuICAgICAgdGhpcy5jb29sZG93biA9IDA7XHJcbiAgICAgIHRoaXMub25Db29sZG93biA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcblN3aXBlTWFuYWdlci5TV0lQRV9USU1FID0gMjUwO1xyXG5Td2lwZU1hbmFnZXIuU1dJUEVfRElTVCA9IDEwMDtcclxuU3dpcGVNYW5hZ2VyLlNXSVBFX0NPT0xET1dOID0gMjU7XHJcblN3aXBlTWFuYWdlci5TV0lQRV9ESVJFQ1RJT05TID0ge1xyXG4gIExFRlQ6IDAsXHJcbiAgUklHSFQ6IDFcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gU3dpcGVNYW5hZ2VyO1xyXG4iLCJ2YXIgVXRpbHMgPSB7XHJcbiAgY29udGFpbnNPYmplY3Q6IGZ1bmN0aW9uKG9iaiwgbGlzdCkge1xyXG4gICAgdmFyIGk7XHJcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAobGlzdFtpXSA9PT0gb2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBVdGlscztcclxuIl19
