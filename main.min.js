(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"/Users/borden/src/sagdx/src/js/data/CinderProfiles.js":[function(require,module,exports){
var CinderProfiles = function() {
};

CinderProfiles.PROFILES = [
  {
    name: 'Girl Next Door',
    image: 'frog_profile.png',
    correctDirection: 1,
    revealImage: 'frog_reveal.png',
    revealImage2: 'frog_reveal2.png',
    revealText: 'GET OUT',
    minigame: 'FrogGame',
    minigameDirection: 1
  },
  {
    name: 'Ella',
    image: 'cinderella_profile.jpg',
    correctDirection: 1,
    revealImage: 'cinderella_reveal.jpg',
    revealText: 'TeH B1g R3V34l!!!1',
    minigame: 'CinderellaGame',
    minigameDirection: 1
  },
  {
    name: 'beachgrl',
    image: 'mermaid_profile.jpg',
    correctDirection: 1,
    revealImage: 'mermaid1.png',
    revealText: 'OH OH HOW DOES THIS WORK?',
    minigame: 'MermaidGame',
    minigameDirection: 1
  },
  {
    name: 'loliterallydead',
    image: 'dance_profile.jpg',
    correctDirection: 1,
    revealImage: 'dancing_reveal.jpg',
    revealText: 'WANNA DANCE?',
    minigame: 'DDRGame',
    minigameDirection: 1
  },
  {
    name: 'Gorgon Girl',
    image: 'medusa_before.png',
    correctDirection: 1,
    revealImage: 'medusa_after.png',
    revealText: "OH NO IT'S A GORGON",
    minigame: 'SnakeGame',
    minigameDirection: 1
  },
  {
    name: 'Dr. Huxtable',
    image: 'cosby_before.jpg',
    correctDirection: 1,
    revealImage: 'cosby_after.jpg',
    revealText: "Zip Zop Zoobity Bop!",
    minigame: 'CupGame',
    minigameDirection: 1
  },
  {
    name: 'Liberty Abs',
    image: 'lib_profile.jpg',
    correctDirection: 1,
    revealImage: 'lib_reveal.jpg',
    revealText: 'LIBERTARIANS',
    minigame: 'FlatTaxGame',
    minigameDirection: 1
  },
  {
    name: 'Tazwell',
    image: 'tch_profile.png',
    correctDirection: 1,
    revealImage: 'tch_reveal.png',
    revealText: 'THIS CAT IS HORSESHIT',
    minigame: 'ThisCatIsHorseShit',
    minigameDirection: 1
  }
];

module.exports = CinderProfiles;

},{}],"/Users/borden/src/sagdx/src/js/entities/CinderProfile.js":[function(require,module,exports){
var CinderProfile = function(game, direction) {
  Phaser.Group.call(this, game);
  this.game = game;
  this.profile = null;
  this.selectionResult = null;
  this.generateProfile(direction);
};

CinderProfile.prototype = Object.create(Phaser.Group.prototype);
CinderProfile.prototype.constructor = CinderProfile;

CinderProfile.prototype.generateProfile = function(direction) {
  // Generate or randomly pick already generated image
  // Generate or randomly pick already generated profile text
  // Generate result of R/L swipes for this profile

  window.CurrentProfileIdx += 1;
  if (window.CurrentProfileIdx === window.CinderProfiles.length)
    window.CurrentProfileIdx = 0;

  this.profile = window.CinderProfiles[window.CurrentProfileIdx];

  var width = this.game.width;
  var cinderFrameW = this.game.cache.getImage('cinderFrame').width;
  var cinderFrameH = this.game.cache.getImage('cinderFrame').height;
  var headerH = this.game.cache.getImage('header').height;
  var offsetX = (width - cinderFrameW) / 2;
  var offsetY = offsetX / 2;
  var textMargin = 25;

  if (direction === 1)
    this.x = -width;
  else
    this.x = width * 2;

  this.image = this.create(offsetX, headerH + offsetY, this.profile.image);
  this.frame = new Phaser.Sprite(this.game, 0, 0, 'cinderFrame');
  this.name = new Phaser.Text(this.game, textMargin, cinderFrameH - textMargin * 2, this.profile.name);

  this.image.addChild(this.frame);
  this.image.addChild(this.name);

  var tween = this.game.add.tween(this);
  tween.to({ x: 0 }, 500, Phaser.Easing.Cubic.Out, true);
  tween.start();
};

module.exports = CinderProfile;

},{}],"/Users/borden/src/sagdx/src/js/entities/Interstitial.js":[function(require,module,exports){
var Interstitial = function(game, instructs, timeout, callback, ctx) {
  Phaser.Group.call(this, game);
  this.game = game;
  this.ctx = ctx;
  this.callback = callback;

  this.updateTime = 0;

  var x = this.game.width / 2;
  var y = this.game.height / 2;

  this.blackout = game.add.graphics(0, 0);
  this.currentFill = 0x000000;
  this.blackout.beginFill(this.currentFill, 1);
  this.blackout.boundsPadding = 0;
  this.blackout.drawRect(0, 0, this.game.width, this.game.height);

  this.match = this.game.add.image(0, 0, 'match');
  this.match.x = (this.game.width / 2) - (this.match.width / 2)
  this.match.y = (this.game.height / 4) - (this.match.height / 2)

  this.instruct = this.game.add.text(x, y, instructs, { fill: '#ffffff' });
  this.instruct.x -= (this.instruct.width / 2);
  this.instruct.y -= (this.instruct.height / 2);

  this.add(this.blackout);
  this.add(this.instruct);

  this.game.time.events.add(timeout, this.tearDown, this);
};

Interstitial.prototype = Object.create(Phaser.Group.prototype);
Interstitial.prototype.constructor = Interstitial;

Interstitial.prototype.update = function() {
  this.updateTime += 1;

  if (this.updateTime % 3 === 0) {
    // no XOR in JS...
    this.currentFill = !this.currentFill ? 0xFFFFFF : 0;
    var textFill = !this.currentFill ? '#FFFFFF' : '#000000';
    this.instruct.setStyle({'fill': textFill});
  }
};

Interstitial.prototype.tearDown = function() {
  this.match.kill();
  this.callback.call(this.ctx);
};

module.exports = Interstitial;

},{}],"/Users/borden/src/sagdx/src/js/entities/ProfileReveal.js":[function(require,module,exports){
//This is a sprite that is displayed after the player chooses/rejects a profile
var ProfileReveal = function(game, x, y, profile) {
  Phaser.Sprite.call(this, game, x, y, profile.revealImage);

  this.profile = profile;

  var textArea = new Phaser.Sprite(game, 0, this.height, 'revealTextArea');

  var text = new Phaser.Text(game, 25, this.height + 25, profile.revealText);

  text.x = (textArea.width / 2) - (text.width / 2);
  text.y = textArea.y + (textArea.height / 2) - (text.height / 2);

  this.inputEnabled = true;

  if(!!profile.revealImage2) {
    setTimeout(loadSecondImage.bind(this), 700);
  }

  this.addChild(textArea);
  this.addChild(text);
};

var loadSecondImage = function() {
  if(this.game) this.loadTexture(this.profile.revealImage2);
};

ProfileReveal.prototype = Object.create(Phaser.Sprite.prototype);
ProfileReveal.prototype.constructor = ProfileReveal;

module.exports = ProfileReveal;

},{}],"/Users/borden/src/sagdx/src/js/entities/Timer.js":[function(require,module,exports){
var Timer = function(game, baseTime, endCallback, ctx, reverse) {
  Phaser.Sprite.call(this, game, -6, game.height - 8, 'timer-animation');
  this.game = game;

  this.longer = reverse || false;

  this.baseTime = baseTime;
  this.timer = null;
  this.timerTime = baseTime - (window.SpeedMultiplier * 10);

  if (this.longer)
    this.timerTime += (window.SpeedMultiplier * 10) * 2;

  this.timeDestroyed = false;
  this.timerTween = null;

  this.onTimerTweenComplete = endCallback;
  this.context = ctx;

  this.setup();
  this.game.add.existing(this);
};

Timer.prototype = Object.create(Phaser.Sprite.prototype);
Timer.prototype.constructor = Timer;

Timer.prototype.start = function() {
  this.timerDestroyed = false;
  this.timerTween.start();
  this.timer = this.game.time.events.add(this.timerTime, function() {});
};

Timer.prototype.setup = function() {
  this.x = -6;
  this.timerTime = this.baseTime - (window.SpeedMultiplier * 10);
  if (this.longer)
    this.timerTime += (window.SpeedMultiplier * 10) * 2;

  this.timeDestroyed = false;
  this.timerTween = this.game.add.tween(this).to({ x: this.game.width }, this.timerTime);
  if (typeof this.onTimerTweenComplete !== "undefined")
    this.timerTween.onComplete.add(this.onTimerTweenComplete.bind(this.context), this);
};

Timer.prototype.end = function() {
  if(!this.game) return;
  this.timerDestroyed = true;
  this.game.tweens.remove(this.timerTween);
  this.game.time.events.remove(this.timer);

  this.setup();
};

module.exports = Timer;

},{}],"/Users/borden/src/sagdx/src/js/main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(414, 606, Phaser.AUTO, 'body');

window.TOTAL_GAMES = 8;

window.Utils = require('./utils');
window.Score = 0;
window.Lives = 8;
window.SpeedMultiplier = 1.0;
window.Games = 0;
window.PlayedGames = 0;

game.state.add('Boot', require('./states/boot'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Splash', require('./states/splash'));
game.state.add('ClickMe', require('./states/clickme'));
game.state.add('warning', require('./states/warning'));
game.state.add('SAGDX', require('./states/sagdx'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));
game.state.add('gameover', require('./states/gameover'));

game.state.add('CinderellaGame', require('./states/cinderellagame'));
game.state.add('FrogGame', require('./states/froggame'));
game.state.add('MermaidGame', require('./states/mermaidgame'));
game.state.add('DDRGame', require('./states/ddrgame'));
game.state.add('SnakeGame', require('./states/snakegame'));
game.state.add('CupGame', require('./states/cupgame'));
game.state.add('FlatTaxGame', require('./states/flattaxgame'));
game.state.add('ThisCatIsHorseShit', require('./states/thiscatishorseshit'));

game.state.start('Boot');

},{"./states/boot":"/Users/borden/src/sagdx/src/js/states/boot.js","./states/cinderellagame":"/Users/borden/src/sagdx/src/js/states/cinderellagame.js","./states/clickme":"/Users/borden/src/sagdx/src/js/states/clickme.js","./states/cupgame":"/Users/borden/src/sagdx/src/js/states/cupgame.js","./states/ddrgame":"/Users/borden/src/sagdx/src/js/states/ddrgame.js","./states/flattaxgame":"/Users/borden/src/sagdx/src/js/states/flattaxgame.js","./states/froggame":"/Users/borden/src/sagdx/src/js/states/froggame.js","./states/game":"/Users/borden/src/sagdx/src/js/states/game.js","./states/gameover":"/Users/borden/src/sagdx/src/js/states/gameover.js","./states/menu":"/Users/borden/src/sagdx/src/js/states/menu.js","./states/mermaidgame":"/Users/borden/src/sagdx/src/js/states/mermaidgame.js","./states/preloader":"/Users/borden/src/sagdx/src/js/states/preloader.js","./states/sagdx":"/Users/borden/src/sagdx/src/js/states/sagdx.js","./states/snakegame":"/Users/borden/src/sagdx/src/js/states/snakegame.js","./states/splash":"/Users/borden/src/sagdx/src/js/states/splash.js","./states/thiscatishorseshit":"/Users/borden/src/sagdx/src/js/states/thiscatishorseshit.js","./states/warning":"/Users/borden/src/sagdx/src/js/states/warning.js","./utils":"/Users/borden/src/sagdx/src/js/utils.js"}],"/Users/borden/src/sagdx/src/js/states/boot.js":[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;
    this.game.stage.backgroundColor = 0xffffff;

    if (!this.game.device.iPhone) {
      this.game.scale.pageAlignHorizontally = true;
      this.game.scale.pageAlignVertically = true;
    }

    if (!this.game.device.desktop) {
      this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;

      this.game.scale.minWidth =  260;
      this.game.scale.minHeight = 480;
      this.game.scale.maxWidth = 414;
      this.game.scale.maxHeight = 736;
    }

    this.game.scale.refresh();

    this.game.state.start('Preloader');
  }
};

},{}],"/Users/borden/src/sagdx/src/js/states/cinderellagame.js":[function(require,module,exports){
var TextManager = require('../utilities/TextManager.js');
var Interstitial = require('../entities/Interstitial.js');
var Timer = require('../entities/Timer.js');

var CinderellaGame = function () {
};

CinderellaGame.prototype = {
  create: function () {
    var slipperW = this.game.cache.getImage('slipper').width;
    var slipperH = this.game.cache.getImage('slipper').height;

    this.bad = this.game.add.audio('bad');
    this.good = this.game.add.audio('good');

    this.TextManager = new TextManager(this.game);
    this.Timer = null;

    this.input.onDown.add(this.onDown, this);
    this.game.add.sprite(0, 120, 'foot');
    this.slipper = this.game.add.sprite(this.game.width - slipperW + 20, slipperH, 'slipper');
    this.movement = 2.3 * window.SpeedMultiplier;
    this.ready = false;

    var that = this;
    this.inter = new Interstitial(this.game, "GET THE FOOT", 1500, function() {
      this.inter.destroy();
      this.ready = true;
      this.Timer = new Timer(this.game, 2500, this.onTimerComplete, this);
      this.Timer.start();
    }, this);
  },

  update: function () {
    if (!this.ready)
      return;

    this.slipper.y += this.movement;

    if (this.slipper.y > this.game.height - this.slipper.height)
      this.movement *= -1;
    if (this.slipper.y < this.slipper.height)
      this.movement *= -1;
  },

  onTimerComplete: function () {
    this.lose();
  },

  lose: function () {
    this.bad.play();
    this.ready = false;
    window.Score -= 100;
    window.Lives -= 2;
    this.TextManager.statusText("LOSE!");
    this.game.time.events.add(4000, this.end, this);
  },

  win: function () {
    this.good.play();
    this.ready = false;
    window.SpeedMultiplier += 0.5;
    window.Score += 100;
    this.TextManager.statusText("WIN!");
    this.game.time.events.add(4000, this.end, this);
  },

  onDown: function () {
    if (!this.ready)
      return;

    this.Timer.end();

    this.slipper.x -= 20;
    if (this.slipper.y > 260 && this.slipper.y < 305) {
      this.win();
    } else {
      this.lose();
    }
  },

  end: function() {
    this.game.state.start('Game');
  }
};

module.exports = CinderellaGame;

},{"../entities/Interstitial.js":"/Users/borden/src/sagdx/src/js/entities/Interstitial.js","../entities/Timer.js":"/Users/borden/src/sagdx/src/js/entities/Timer.js","../utilities/TextManager.js":"/Users/borden/src/sagdx/src/js/utilities/TextManager.js"}],"/Users/borden/src/sagdx/src/js/states/clickme.js":[function(require,module,exports){
var ClickMe = function () {
};

module.exports = ClickMe;

ClickMe.prototype = {
  create: function () {
    this.game.stage.backgroundColor = '#ffffff';

    var startText = "Press to start!";
    var textProps = { font: '24pt Arial',
                      fill: '#C24300',
                      strokeThickness: 0 };

    var text = this.game.add.text(0, 0, startText, textProps);

    text.x = (this.game.width / 2) - (text.width / 2);
    text.y = (this.game.height / 2) - (text.height / 2);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    if (!this.game.device.desktop) {
      this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.startFullScreen(true);
    }

    this.startGame();
  },

  startGame: function() {
    if (this.game.device.desktop) {
      this.game.state.start('warning');
    } else {
      this.game.state.start('SAGDX');
    }
  }
};

},{}],"/Users/borden/src/sagdx/src/js/states/cupgame.js":[function(require,module,exports){
var TextManager = require('../utilities/TextManager.js');
var Interstitial = require('../entities/Interstitial.js');
var Timer = require('../entities/Timer.js');

var BASE_CUP_SWAPS = 4;
var CUP_X = 100;

var Cup = function(game, x, y, drugged) {
  Phaser.Sprite.call(this, game, x, y, 'cup');

  this.drugged = drugged;
}

Cup.prototype = Object.create(Phaser.Sprite.prototype);
Cup.prototype.constructor = Cup;

var CupGame = function () {
};

CupGame.prototype = {
  create: function () {

    this.boo = this.game.add.audio('boo');

    var state = this;
    if (!this.game.device.desktop) this.input.onDown.add(this.goFullscreen, this);

    this.TextManager = new TextManager(this.game);

    this.bad = this.game.add.audio('bad');
    this.good = this.game.add.audio('good');

    this.ready = false;

    this.background = this.game.add.image(0, 0, 'cosbyBg');

    this.cups = this.game.add.group();
    for (var i = 0; i < 3; i++) {
      var cup = this.game.add.existing(new Cup(this.game, CUP_X, 20 + i * 120, false));
      this.cups.add(cup);
    }

    this.cupSwaps = BASE_CUP_SWAPS * Math.floor(window.SpeedMultiplier);

    this.TimeUp = new Timer(this.game, 10000, this.onTimeUp, this);

    this.inter = new Interstitial(this.game, "ZIP ZOP ZOOBITY BOP", 1500, function() {
      this.inter.destroy();

      this.drugCups(function() {
        state.scrambleCups(state.cupSwaps, function() {
          state.ready = true;
          state.TimeUp.start();
          state.cupSelection();
        });
      });

    }, this);

  },

  goFullscreen: function() {
    if (this.game.scale.isFullScreen) return;
    this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
    this.game.scale.startFullScreen(true);
  },

  onTimeUp: function () {
    this.lose();
  },

  lose: function () {
    this.bad.play();
    this.ready = false;
    window.Score -= 100;
    window.Lives -= 2;
    this.TextManager.statusText("LOSE!");
    this.game.time.events.add(2000, this.end, this);
  },

  win: function () {
    this.good.play();
    this.ready = false;
    window.SpeedMultiplier += 0.5;
    window.Score += 100;
    this.TextManager.statusText("WIN!");
    this.TimeUp.end();
    this.game.time.events.add(2000, this.end, this);
  },

  end: function() {
    this.game.state.start('Game');
    this.game.stage.backgroundColor = '#FFFFFF';
  },

  scrambleCups: function(swapsRemaining, callback) {
    var cupIndexes = this.twoRandomCupIndexes();
    
    this.swapCups(cupIndexes[0], cupIndexes[1], (function() {
      if(!swapsRemaining) {
        callback();
      } else {
        swapsRemaining -= 1;
        this.scrambleCups(swapsRemaining, callback);
      }
    }).bind(this));
  },

  swapCups: function(index1, index2, callback) {
    var cup1 = this.cups.children[index1];
    var cup2 = this.cups.children[index2];

    var yCoord = cup1.y + (cup2.y - cup1.y)
    var leftX = 0 - this.game.width / 3;
    var rightX = this.game.width - cup1.width + this.game.width / 3;

    var time = 200 + (500 / window.SpeedMultiplier);

    // tween the object down in a linear fashion
    this.game.add.tween(cup1).to({y: cup2.y }, time).start();
    this.game.add.tween(cup2).to({y: cup1.y }, time).start();

    var cup1Tween = this.game.add.tween(cup1)
      .to({x: leftX}, time * 0.5, Phaser.Easing.Sinusoidal.Out).start();

    cup1Tween.onComplete.add(function() {
      this.swapCupDisplayOrder(index1, index2);
      this.game.add.tween(cup1)
        .to({x: CUP_X}, time * 0.5, Phaser.Easing.Sinusoidal.In).start();
    }, this);

    var cup2Tween = this.game.add.tween(cup2)
      .to({x: rightX}, time / 2, Phaser.Easing.Sinusoidal.Out)
      .to({x: CUP_X}, time / 2, Phaser.Easing.Sinusoidal.In)
      .start();

    cup2Tween.onComplete.add(callback, this);
  },

  twoRandomCupIndexes: function() {
    var rands = [0, 0];

    while(rands[0] == rands[1]) {
      rands[0] = Math.floor(Math.random() * 3);
      rands[1] = Math.floor(Math.random() * 3);
    }

    rands.sort();

    return [rands[0], rands[1]];
  },

  swapCupDisplayOrder: function(index1, index2) {
    var tmp = this.cups.children[index1];
    this.cups.children[index1] = this.cups.children[index2];
    this.cups.children[index2] = tmp;
  },

  drugCups: function(callback) {
    var state = this;
    var indexes = this.twoRandomCupIndexes();
    var cup1 = this.cups.children[indexes[0]];
    var cup2 = this.cups.children[indexes[1]];

    this.drugAnimation(cup1, function() {
      state.drugAnimation(cup2, function() {
        callback();
      });
    });
  },

  drugAnimation: function(cup, callback) {
    var state = this;

    var pill = this.game.add.sprite(this.game.width / 2, -50, 'pill');
    pill.animations.add('flip');
    pill.animations.play('flip', 10, true);

    var pillTween = this.game.add.tween(pill).to({y: cup.y + 25 }, 500).start();
    pillTween.onComplete.add(function() {
      cup.drugged = true;
      this.boo.play();
      this.splashAnimation(pill, callback);
    }, this);
  },

  splashAnimation: function(pill, callback) {
      var splash = this.game.add.sprite(0, 0, 'splash');

      splash.x = (pill.x + pill.width / 2) - splash.width / 2
      splash.y = (pill.y + pill.height / 2) - splash.height / 2

      var anim = splash.animations.add('splash');

      anim.onComplete.add(function() {
        splash.kill();
        callback();
      });

      anim.play(10);
      pill.kill();
  },

  cupSelection: function(){
    var state = this;
    var cups = this.cups.children;

    for(i in cups) {
      (function(cup) {
        cup.events.onInputDown.add(function() {
          if(!state.ready) return;
          if(cup.drugged) return state.lose();
          return state.win();
        }, state);

        cup.inputEnabled = true;
      })(cups[i]);
    }
  }
};

module.exports = CupGame;

},{"../entities/Interstitial.js":"/Users/borden/src/sagdx/src/js/entities/Interstitial.js","../entities/Timer.js":"/Users/borden/src/sagdx/src/js/entities/Timer.js","../utilities/TextManager.js":"/Users/borden/src/sagdx/src/js/utilities/TextManager.js"}],"/Users/borden/src/sagdx/src/js/states/ddrgame.js":[function(require,module,exports){
var TextManager = require('../utilities/TextManager.js');
var SwipeManager = require('../utilities/SwipeManager.js');
var Interstitial = require('../entities/Interstitial.js');
var Timer = require('../entities/Timer.js');

var DDRGame = function () {
};

var REQUIRED_HIT_PERCENTAGE = .75;

DDRGame.prototype = {
  create: function () {
    this.bad = this.game.add.audio('bad');
    this.good = this.game.add.audio('good');

    this.yay = this.game.add.audio('yay');
    this.boo = this.game.add.audio('boo');

    this.ready = false;
    this.Timer = null;
    this.TextManager = new TextManager(this.game);

    this.game.stage.backgroundColor = "#000000";

    this.skelly = this.game.add.sprite(50, 100, 'skelly');
    this.skelly.animations.add('dance');
    this.skelly.animations.play('dance', 1.2 * window.SpeedMultiplier, true);

    this.game.plugins.add(new SwipeManager(this.game, this.swipe, this, true));

    var width = this.game.cache.getImage('up-arrow').width / 4;
    var height = this.game.cache.getImage('up-arrow').height;
    var padding = Math.floor((this.game.stage.width - (width * 2 + height * 2)) / 5);

    this.up = this.game.add.sprite(padding, this.topPadding, 'up-arrow');
    this.up.animations.add('blues');
    this.up.animations.play('blues', 10, true);
    this.down = this.game.add.sprite(padding * 2 + width, this.topPadding, 'down-arrow');
    this.down.animations.add('reds');
    this.down.animations.play('reds', 10, true);

    this.left = this.game.add.sprite(padding * 3 + width * 2, height / 2 - 20, 'left-arrow');
    this.left.animations.add('greens');
    this.left.animations.play('greens', 10, true);
    this.right = this.game.add.sprite(padding * 4 + width * 2 + height, height / 2 - 20, 'right-arrow');
    this.right.animations.add('oranges');
    this.right.animations.play('oranges', 10, true);

    this.arrowSpeed = 3 * window.SpeedMultiplier;
    this.arrows = [];
    this.arrowCooldown = 55;
    this.cooldown = 0;
    this.onCooldown = false;

    this.hits = 0;
    this.arrowCount = 0;

    this.emitter = this.game.add.emitter(0, 0, 100);
    this.emitter.makeParticles('spark');

    this.inter = new Interstitial(this.game, "DANCE OFF", 1500, function() {
      this.inter.destroy();
      this.Timer = new Timer(this.game, 6500, this.onTimerComplete, this, true);
      this.game.time.events.add(1500, function() {
        this.Timer.start();
      }, this);
      this.ready = true;
    }, this);
  },

  update: function () {
    if (!this.ready)
      return;

    var removeIdx = -1;

    for (var i = 0; i < this.arrows.length; i++) {
      var arrow = this.arrows[i];

      if (((arrow.dir === 3 || arrow.dir === 2) && arrow.y <= this.up.y) ||
          ((arrow.dir === 1 || arrow.dir == 0) && arrow.y <= this.right.y)) {
        removeIdx = i;
        this.arrowCount += 1;
        arrow.destroy();
      }
      else
        arrow.y -= this.arrowSpeed;
    }

    if (removeIdx >= 0) this.arrows.splice(removeIdx, 1);

    if (this.arrowCooldown === this.cooldown) {
      this.onCooldown = false;
      this.cooldown = 0;
    }
    if (this.onCooldown)
      this.cooldown += 1;

    if (!this.onCooldown) {
      var spawn = Math.floor(Math.random() * 10) + 1 > 6;
      if (spawn) {
        var dir = Math.floor(Math.random() * 4);
        var arrow = null;

        switch(dir) {
        case 0:
          arrow = this.game.add.sprite(this.left.x, this.game.height + this.left.height, 'left-arrow');
          break;
        case 1:
          arrow = this.game.add.sprite(this.right.x, this.game.height + this.left.height, 'right-arrow');
          break;
        case 2:
          arrow = this.game.add.sprite(this.up.x, this.game.height + this.up.height, 'up-arrow');
          break;
        case 3:
          arrow = this.game.add.sprite(this.down.x, this.game.height + this.down.height, 'down-arrow');
          break;
        }

        arrow.animations.add('anim');
        arrow.animations.play('anim', 10, true);
        arrow.dir = dir;
        this.arrows.push(arrow);
        this.onCooldown = true;
      }
    }
  },

  onTimerComplete: function () {
    if (this.hits > this.arrowCount * REQUIRED_HIT_PERCENTAGE)
      this.win();
    else
      this.lose();
  },

  lose: function () {
    this.bad.play();
    this.ready = false;
    window.Score -= 100;
    window.Lives -= 2;
    this.TextManager.statusText("LOSE!");
    this.game.time.events.add(4000, this.end, this);
  },

  win: function () {
    this.good.play();
    this.ready = false;
    window.SpeedMultiplier += 0.5;
    window.Score += 100;
    this.TextManager.statusText("WIN!");
    this.game.time.events.add(4000, this.end, this);
  },

  swipe: function (dir) {
    var hit = false;

    for (var i = 0; i < this.arrows.length; i++) {
      var arrow = this.arrows[i];
      if (arrow.y <= this.up.y + this.up.height) {
        if (arrow.dir === dir) {
          hit = true;
          this.hits += 1;
          this.yay.play();
        } else {
          hit = false;
          this.hits -= 1;
          this.boo.play();
        }

        if (hit) {
          switch (dir) {
          case 0:
            this.emitter.x = this.left.x + this.left.width / 2;
            this.emitter.y = this.left.y + this.left.height / 2;
            break;
          case 1:
            this.emitter.x = this.right.x + this.right.width / 2;
            this.emitter.y = this.right.y + this.right.height / 2;
            break;
          case 2:
            this.emitter.x = this.up.x + this.up.width / 2;
            this.emitter.y = this.up.y + this.up.height / 2;
            break;
          case 3:
            this.emitter.x = this.down.x + this.down.width / 2;
            this.emitter.y = this.down.y + this.down.height / 2;
            break;
          }
          this.emitter.start(true, 1000, null, 10);
        }
      }
    }

    switch (dir) {
    case 0:
    this.game.add.tween(this.left.scale)
        .to({ x: 1.2, y: 1.2 }, 100, Phaser.Easing.Linear.None, true, 0, 0, true);
    break;
    case 1:
    this.game.add.tween(this.right.scale)
        .to({ x: 1.2, y: 1.2 }, 100, Phaser.Easing.Linear.None, true, 0, 0, true);
    break;
    case 2:
    this.game.add.tween(this.up.scale)
        .to({ x: 1.2, y: 1.2 }, 100, Phaser.Easing.Linear.None, true, 0, 0, true);
    break;
    case 3:
    this.game.add.tween(this.down.scale)
        .to({ x: 1.2, y: 1.2 }, 100, Phaser.Easing.Linear.None, true, 0, 0, true);
    break;
    }
  },

  end: function() {
    this.game.stage.backgroundColor = "#ffffff";
    this.game.state.start('Game');
  }
};

module.exports = DDRGame;

},{"../entities/Interstitial.js":"/Users/borden/src/sagdx/src/js/entities/Interstitial.js","../entities/Timer.js":"/Users/borden/src/sagdx/src/js/entities/Timer.js","../utilities/SwipeManager.js":"/Users/borden/src/sagdx/src/js/utilities/SwipeManager.js","../utilities/TextManager.js":"/Users/borden/src/sagdx/src/js/utilities/TextManager.js"}],"/Users/borden/src/sagdx/src/js/states/flattaxgame.js":[function(require,module,exports){
var TextManager = require('../utilities/TextManager.js');
var SwipeManager = require('../utilities/SwipeManager.js');
var Interstitial = require('../entities/Interstitial.js');
var Timer = require('../entities/Timer.js');

var FlatTaxGame = function () {
};

NUM_SEGMENTS = 5;

FlatTaxGame.prototype = {
  create: function () {
    this.ready = false;

    this.bad = this.game.add.audio('bad');
    this.good = this.game.add.audio('good');

    this.Timer = new Timer(this.game, 6500, this.onTimerComplete, this, true);
    this.TextManager = new TextManager(this.game);
    this.game.plugins.add(new SwipeManager(this.game, this.swipe, this, true));
    this.segments = [];
    this.graphics = this.game.add.graphics(0, 0);
    this.graphics.lineStyle(3, 0x000000);

    this.game.add.sprite(0, 0, 'taxbg');
    var header = this.game.add.text(this.game.world.centerX, 20, "U.S. Tax Code", {
      font: '45px serif',
      fill: '#000000',
      align: 'center'
    });
    header.x -= (header.width / 2);
    var sub = this.game.add.text(this.game.world.centerX, 24 + header.height,
                                 "Fig 2.0.1, Marginal Tax Rate", {
      font: '24px serif',
      fill: '#000000',
      align: 'center'
    });
    sub.x -= (sub.width / 2);

    var segmentLength = this.game.width / NUM_SEGMENTS;
    var top = this.game.height / 1.5;
    var bot = this.game.height / 3;
    var level = (this.game.height / 2);
    var whereToGo = {
      0: top,
      1: level,
      2: bot
    };
    var start = { x: 0, y: whereToGo[Math.floor(Math.random() * 3)] };
    for (var i = 0; i < NUM_SEGMENTS; i++) {
      var endY = (start.y === top) ? level :
            (start.y === bot) ? level : whereToGo[Math.floor(Math.random() * 3)];
      var end = {
        x: start.x + segmentLength,
        y: endY
      };
      var line = new Phaser.Line(start.x, start.y, end.x, end.y);
      line.leveled = false;
      this.segments.push(line);
      if (line.start.y === line.end.y) line.leveled = true;
      start = { x: end.x, y: end.y };
    }

    this.graphics.moveTo(this.segments[0].start.x, this.segments[0].start.y);

    this.inter = new Interstitial(this.game, "FLATTEN THE TAX", 1500, function() {
      this.inter.destroy();
      this.Timer.start();
      this.ready = true;
    }, this);
  },

  findSlopeDirection: function(line) {
    return (line.start.y < line.end.y) ? -1 :
      (line.start.y === line.end.y) ? 0 : 1;
  },

  flattenLine: function(line) {
    var slopeDir = this.findSlopeDirection(line);
    switch (slopeDir) {
    case 1:
      if (line.end.y >= (this.game.height / 2)) line.start.y = line.end.y;
      else line.end.y = line.start.y;
      break;
    case -1:
      if (line.end.y > (this.game.height / 2)) line.end.y = line.start.y;
      else line.start.y = line.end.y;
      break;
    case 0:
      return;
    }
  },

  swipe: function (dir, start, end) {
    var swipeLine = new Phaser.Line(start.x, start.y, end.x, end.y);
    for (var i = 0; i < this.segments.length; i++) {
      var seg = this.segments[i];
      var flatten = false;

      if (seg.leveled) continue;

      var int = swipeLine.intersects(seg, true);

      if (int) {
        if (int.y > (this.game.height / 2)) {
          if (dir !== 2) continue;
          flatten = true;
        }
        else if (int.y < (this.game.height / 2)) {
          if (dir !== 3) continue;
          flatten = true;
        }

        if (flatten) {
          var slopeDir = this.findSlopeDirection(seg);
          var nextSlope = 0;
          var prevSlope = 0;
          var prevI = (slopeDir === 1) ? -1 : 1;
          var nextI = (slopeDir === 1) ? 1 : -1;

          var prev = this.segments[i + prevI];
          if (prev)
            prevSlope = this.findSlopeDirection(prev);
          var next = this.segments[i + nextI];
          if (next)
            nextSlope = this.findSlopeDirection(next);

          if (nextSlope != slopeDir && nextSlope != 0) {
            this.flattenLine(next);
            next.leveled = true;
          }
          else if (prevSlope != slopeDir && prevSlope != 0) {
            this.flattenLine(prev);
            prev.leveled = true;
          }

          this.flattenLine(seg);
          seg.leveled = true;
        }
      }
    }
  },

  update: function () {
    if (!this.ready)
      return;
  },

  render: function() {
    this.graphics.clear();
    for (i = 0; i < this.segments.length; i++) {
      this.graphics.lineStyle(3, 0x000000);
      var seg = this.segments[i];
      var slope = this.findSlopeDirection(seg);
      var cpx1 = 0;
      var cpx2 = 0;
      var cpy1 = 0;
      var cpy2 = 0;
      var wDiff = seg.start.x - seg.end.x;
      var hDiff = Math.abs(seg.start.y - seg.end.y);
      this.graphics.moveTo(seg.start.x, seg.start.y);

      switch (slope) {
      case 0:
        cpx1 = seg.start.x + (wDiff / 3);
        cpx2 = seg.start.x + (wDiff / 3) * 2;
        cpy1 = seg.start.y;
        cpy2 = seg.start.y;
        break;
      case 1:
      case -1:
        cpx1 = seg.end.x;
        cpy1 = seg.start.y;
        cpx2 = seg.start.x;
        cpy2 = seg.end.y;
        break;
      }

      this.graphics.bezierCurveTo(cpx1,
                                  cpy1,
                                  cpx2,
                                  cpy2,
                                  seg.end.x,
                                  seg.end.y);
    }
  },

  onTimerComplete: function () {
    var lose = false;
    for (var i = 0; i < this.segments.length; i++) {
      if (!this.segments[i].leveled || this.segments[i].leveled === undefined) {
        lose = true;
        break;
      }
    }

    if (lose) this.lose();
    else this.win();
  },

  lose: function () {
    this.bad.play();
    this.ready = false;
    window.Score -= 100;
    window.Live -= 2;
    this.TextManager.statusText("LOSE!");
    this.game.time.events.add(4000, this.end, this);
  },

  win: function () {
    this.good.play();
    this.ready = false;
    window.SpeedMultiplier += 0.5;
    window.Score += 100;
    this.TextManager.statusText("WIN!");
    this.game.time.events.add(4000, this.end, this);
  },

  end: function() {
    this.game.stage.backgroundColor = "#ffffff";
    this.game.state.start('Game');
  }
};

module.exports = FlatTaxGame;

},{"../entities/Interstitial.js":"/Users/borden/src/sagdx/src/js/entities/Interstitial.js","../entities/Timer.js":"/Users/borden/src/sagdx/src/js/entities/Timer.js","../utilities/SwipeManager.js":"/Users/borden/src/sagdx/src/js/utilities/SwipeManager.js","../utilities/TextManager.js":"/Users/borden/src/sagdx/src/js/utilities/TextManager.js"}],"/Users/borden/src/sagdx/src/js/states/froggame.js":[function(require,module,exports){
var TextManager = require('../utilities/TextManager.js');
var Interstitial = require('../entities/Interstitial.js');
var Timer = require('../entities/Timer.js');
var WIN_X = 1080;
var PLAYER_Y = 290;
var SHOE_Y = 470;

var FrogGame = function () {
};

FrogGame.prototype = {
  create: function () {
    var self = this;

    this.bad = this.game.add.audio('bad');
    this.blip = this.game.add.audio('blip');
    this.good = this.game.add.audio('good');

    if (!this.game.device.desktop) this.input.onDown.add(this.goFullscreen, this);

    this.game.world.width = 1200;
    this.game.camera.setBoundsToWorld();

    this.TextManager = new TextManager(this.game);
    this.Timer = null;

    this.background = this.game.add.image(0, 0, 'frogHaus');
    this.player = this.game.add.sprite(this.game.width / 2, 290, 'frogPlayer');
    this.player.animations.add('idle', [0]);
    this.player.animations.add('left', [1]);
    this.player.animations.add('right', [2]);
    this.player.animations.play('idle', 0, true);

    this.frog = this.game.add.sprite(this.player.x - 350, PLAYER_Y, 'frogChaser');
    this.frog.animations.add('run');
    this.frog.animations.play('run', 10, true);

    this.setupShoes();

    this.frogSpeed = 1.5 + window.SpeedMultiplier;
    this.playerSpeed = 25 + window.SpeedMultiplier;

    this.ready = false;

    this.game.camera.follow(this.player);

    this.inter = new Interstitial(this.game, "GET OUT", 1500, function() {
      this.inter.destroy();
      this.ready = true;
    }, this);
  },

  goFullscreen: function() {
    if(this.game.scale.isFullScreen) return;
    this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
    this.game.scale.startFullScreen(true);
  },

  setupShoes: function() {
    this.leftShoe = this.game.add.sprite(65, SHOE_Y, 'leftShoe');
    this.rightShoe = this.game.add.sprite(295, SHOE_Y, 'rightShoe');

    this.leftShoe.animations.add('idle', [0]);
    this.rightShoe.animations.add('idle', [0]);
    this.leftShoe.animations.add('flash', [1,2]);
    this.rightShoe.animations.add('flash', [1,2]);

    this.leftShoe.fixedToCamera = true;
    this.rightShoe.fixedToCamera = true;

    this.leftShoe.inputEnabled = false;
    this.rightShoe.inputEnabled = false;

    this.leftShoe.events.onInputDown.add(function() {
      this.player.animations.play('left', 10, false);
      this.player.events.onAnimationComplete.add(this.idlePlayer, this);
      this.movePlayer();
      this.activateShoe(this.rightShoe, this.leftShoe);
    }, this);

    this.rightShoe.events.onInputDown.add(function() {
      this.player.animations.play('right', 10, false);
      this.player.events.onAnimationComplete.add(this.idlePlayer, this);
      this.movePlayer();
      this.activateShoe(this.leftShoe, this.rightShoe);
    }, this);

    this.activateShoe(this.leftShoe, this.rightShoe);
  },

  activateShoe: function(activeShoe, unactiveShoe) {
    activeShoe.animations.play('flash', 50, true);
    activeShoe.inputEnabled = true;

    unactiveShoe.animations.play('idle', 50, true);
    unactiveShoe.inputEnabled = false;
  },

  idlePlayer: function() {
    this.player.animations.play('idle', 5, true);
  },

  update: function() {
    if (!this.ready) return;

    if(this.frog.x + (this.frog.width * 0.666) > this.player.x) this.lose();

    if(this.player.x > WIN_X) this.win();

    this.moveFrogTowardPlayer();
  },

  movePlayer: function() {
    this.blip.play('', 0, 0.6);
    if (!this.ready) return;
    this.player.x += this.playerSpeed;
  },

  moveFrogTowardPlayer: function() {
    if (this.frog.x < this.player.x) this.frog.x += this.frogSpeed;
  },

  lose: function () {
    this.bad.play();
    this.ready = false;
    window.Score -= 100;
    window.Lives -= 2;
    this.TextManager.statusText("LOSE!");
    this.game.time.events.add(2000, this.end, this);
  },

  win: function () {
    this.good.play();
    this.ready = false;
    window.SpeedMultiplier += 0.5;
    window.Score += 100;
    this.TextManager.statusText("WIN!");
    this.game.time.events.add(2000, this.end, this);
  },

  end: function() {
    this.game.state.start('Game');
  }
};

module.exports = FrogGame;

},{"../entities/Interstitial.js":"/Users/borden/src/sagdx/src/js/entities/Interstitial.js","../entities/Timer.js":"/Users/borden/src/sagdx/src/js/entities/Timer.js","../utilities/TextManager.js":"/Users/borden/src/sagdx/src/js/utilities/TextManager.js"}],"/Users/borden/src/sagdx/src/js/states/game.js":[function(require,module,exports){
var SwipeManager = require('../utilities/SwipeManager.js');
var CinderProfile = require('../entities/CinderProfile.js');
var ProfileReveal = require('../entities/ProfileReveal.js');
var TextManager = require('../utilities/TextManager.js');

var Game = function () {
  currentCinderProfile = null;
  lastSwipeDirection = SwipeManager.SWIPE_DIRECTIONS.RIGHT;
  swipeScore = 20;
};

Game.prototype = {
  create: function () {
    if (window.Lives <= 0)
      this.game.state.start('gameover');

    this.game.stage.backgroundColor = '#ffffff';
    this.game.world.width = 414;
    this.game.plugins.add(new SwipeManager(this.game, this.swipe, this));
    this.TextManager = new TextManager(this.game);
    currentCinderProfile = new CinderProfile(this.game, lastSwipeDirection);

    /*
    if (!this.game.device.desktop &&
       !this.game.device.iOS) this.input.onDown.add(this.goFullscreen, this);
     */

    this.header = this.add.sprite(0, 0, 'header');
    this.bad = this.game.add.audio('bad');
    this.good = this.game.add.audio('yay');
    this.wabang = this.game.add.audio('wabang');

    this.xButton = this.add.button(115, 485, 'xButton', this.nopeButtonCallback.bind(this));
    this.heartButton = this.add.button(207, 485, 'heartButton', this.yepButtonCallback.bind(this));

    this.hearts = [];

    var heartPadding = 8;
    var cinderFrameW = this.game.cache.getImage('cinderFrame').width;
    var startX = (this.game.width - cinderFrameW) / 2;
    for (var i = 0; i < window.Lives; i++) {
      var h = null;

      // lives sprite / animation
      if (i === 4) startX = startX + this.xButton.width * 2 + 14;
      if (i % 2 !== 0) {
        h = this.game.add.sprite(startX + ((i - 1) / 2) * (32 + heartPadding),
                                this.xButton.y + this.xButton.height / 2 - 16,
                                'heart');
      }
      else {
        h = this.game.add.sprite(startX + (i / 2) * (32 + heartPadding) + 8,
                                 this.xButton.y + this.xButton.height / 2 - 8,
                                 'smallheart');
      }

      this.hearts.push(h);
    }

    this.baseSwipeScore = 25;
    this.swipeScore = this.baseSwipeScore;
    this.updateTime = 0;

    this.swipeEnabled = true;

    if (window.Games === window.TOTAL_GAMES)
      this.TextManager.addFloatingText('critical omission.',
                                       'down',
                                       'something, something,',
                                       null,
                                       null,
                                       20);
  },

  goFullscreen: function() {
    if(this.game.scale.isFullScreen) return;
    this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
    this.game.scale.startFullScreen(true);
  },

  swipe: function(swipeDirection) {
    if (!this.swipeEnabled) return;
    this.swipeEnabled = false;

    window.Games += 1;

    var to = -this.game.width * 3;
    var angle = -90;

    lastSwipeDirection = swipeDirection;

    if (swipeDirection == SwipeManager.SWIPE_DIRECTIONS.RIGHT) {
      this.good.play();
      window.PlayedGames += 1;
      to = to * -1;
      angle = angle * -1;
    } else {
      this.bad.play();
      window.Lives -= 1;
      this.hearts[this.hearts.length - 1].destroy();
      this.hearts.splice(this.hearts.length - 1, 1);

      if (window.Lives <= 0)
        this.game.state.start('gameover');

      this.swipePenalty();
    }

    this.swipeTo(to, angle);
  },

  swipePenalty: function() {
    window.Score -= this.baseSwipeScore;

    this.TextManager.addFloatingText('-' + this.baseSwipeScore, "up", 'boo');
  },

  onSwipeComplete: function() {
    if (lastSwipeDirection == 1) this.reveal();
    else this.nextProfile();
  },

  reveal: function() {
    this.wabang.play();
    this.currentReveal = new ProfileReveal(this.game, 0, this.header.height, currentCinderProfile.profile);

    this.game.add.existing(this.currentReveal);

    //This timeout forces them to look at the reveal image for at least a bit
    this.game.time.events.add(300, function() {
      this.currentReveal.events.onInputDown.add(this.endReveal.bind(this), this);
    }, this);

    this.revealTimeout = this.game.time.events.add(3000, this.endReveal, this);
  },

  endReveal: function() {
    if (this.revealTimeout) this.game.time.events.remove(this.revealTimeout);

    this.currentReveal.kill();

    if (typeof currentCinderProfile.profile.minigame !== "undefined" &&
        lastSwipeDirection === currentCinderProfile.profile.minigameDirection)
      this.game.state.start(currentCinderProfile.profile.minigame);
    else
      this.nextProfile();

  },

  nextProfile: function() {
    currentCinderProfile = new CinderProfile(this.game, lastSwipeDirection);
    this.swipeScore = this.baseSwipeScore;
    this.swipeEnabled = true;

    if (window.Games === window.TOTAL_GAMES)
      this.TextManager.addFloatingText('critical omission.',
                                       'down',
                                       'something, something,',
                                       null,
                                       null,
                                       20);
  },

  update: function () {
    this.updateTime += 1;
    if (this.swipeScore > 1 && this.updateTime % 10 === 0) {
      this.swipeScore -= 1;
    }
  },

  onTimerTweenComplete: function() {
    this.bad.play();
  },

  nopeButtonCallback: function() {
    console.log('here');
    this.swipe(SwipeManager.SWIPE_DIRECTIONS.LEFT);
  },

  yepButtonCallback: function() {
    this.swipe(SwipeManager.SWIPE_DIRECTIONS.RIGHT);
  },

  swipeTo: function(to, angle) {
    var stampW = this.game.cache.getImage('nope').width;
    var frameW = this.game.cache.getImage('cinderFrame').width;
    var nopeY = currentCinderProfile.y + frameW - stampW;
    var stamp = null;

    if (to > 0)
      stamp = this.game.add.sprite(currentCinderProfile.y + 32, currentCinderProfile.x + 64, 'like');
    else
      stamp = this.game.add.sprite(nopeY, currentCinderProfile.x + 64, 'nope');

    currentCinderProfile.addChild(stamp);

    var tween = this.game.add.tween(currentCinderProfile);
    //using setTimeout to show reveal before tween completes (hack?)
    this.game.time.events.add(700, this.onSwipeComplete.bind(this), this);
    tween.to({ x: to, y: this.game.height / 3, angle: angle }, 1000, Phaser.Easing.Cubic.Out, false, 200);
    tween.start();
  }
};

module.exports = Game;

},{"../entities/CinderProfile.js":"/Users/borden/src/sagdx/src/js/entities/CinderProfile.js","../entities/ProfileReveal.js":"/Users/borden/src/sagdx/src/js/entities/ProfileReveal.js","../utilities/SwipeManager.js":"/Users/borden/src/sagdx/src/js/utilities/SwipeManager.js","../utilities/TextManager.js":"/Users/borden/src/sagdx/src/js/utilities/TextManager.js"}],"/Users/borden/src/sagdx/src/js/states/gameover.js":[function(require,module,exports){
var GameOver = function () {
};

module.exports = GameOver;

GameOver.prototype = {
  create: function () {

    this.tada = this.game.add.audio('tada');
    this.game.stage.backgroundColor = '#ffffff';
    this.emitter = null;

    var endText = "GAME OVER!";
    var textProps = { font: '24pt Arial',
                      fill: '#C24300',
                      strokeThickness: 0 };
    var textPropsScore = {
      font: '24pt Arial',
      fill: '#000000',
      strokeThickness: 0
    };
    var flavorProps = {
      font: '20px Arial',
      fill: '#000000',
      align: 'center',
      wordWrap: true,
      wordWrapWidth: this.game.width - 30
    };

    var text = this.game.add.text(0, 0, endText, textProps);
    var scoreTitle = this.game.add.text(0, 0, "Final Score:", textPropsScore);
    this.scoreText = this.game.add.text(0, 0, '1000', textPropsScore);
    this.updateCnt = 0;
    this.counter = 0;
    this.scoreDone = false;

    text.x = (this.game.width / 2) - (text.width / 2);
    text.y = (this.game.height / 2) - (text.height / 2);
    scoreTitle.x = (this.game.width / 2) - (scoreTitle.width / 2);
    scoreTitle.y = text.y + 50;
    this.scoreText.x = (this.game.width / 2) - (this.scoreText.width / 2);
    this.scoreText.y = text.y + 80;

    var flavorText = null;
    if (window.PlayedGames >= window.TOTAL_GAMES) {
      flavorText = "Wow, you played all of the games. You think that's something that" +
        " should be rewarded?";
    } else if (window.Games >= window.TOTAL_GAMES) {
      flavorText = "Wow, you couldn't even play through all of the games, and you expect" +
        " a reward or something?";
    }
    else {
      flavorText = "You're a loser.";
    }

    var flavor = this.game.add.text(0, 0, flavorText, flavorProps);
    flavor.x = (this.game.width / 2) - (flavor.width / 2);
    flavor.y = text.y - 200;

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
    if (!this.scoreDone) {
      this.updateCnt += 1;

      if (this.updateCnt % this.counter === 0)
        this.scoreText.setText(this.game.rnd.integerInRange(0, 5000));

      if (this.updateCnt % 20 === 0) this.counter++;
      if (this.counter >= 20) {
        this.scoreText.setText(0);
        this.scoreText.x = (this.game.width / 2) - (this.scoreText.width / 2);
        this.emitter = this.game.add.emitter(this.scoreText.x + (this.scoreText.width / 2),
                                             this.scoreText.y + (this.scoreText.height / 2),
                                             100);
        this.emitter.makeParticles('spark');
        this.emitter.start(false, 1500, 75);
        this.scoreDone = true;
        this.tada.play();
      }

      this.scoreText.x = (this.game.width / 2) - (this.scoreText.width / 2);
    }
  },

  reset: function() {
    window.Lives = 8;
    window.SpeedMultipler = 1;
    window.Games = 0;
    window.PlayedGames = 0;
    window.Score = 0;
  },

  onDown: function () {
    if (!this.scoreDone) return;
    this.reset();

    if (!this.game.device.desktop) {
      this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.startFullScreen(true);
    }

    this.restartGame();
  },

  restartGame: function() {
    if (this.game.device.desktop) {
      this.game.state.start('warning');
    } else {
      this.game.state.start('SAGDX');
    }
  }
};

},{}],"/Users/borden/src/sagdx/src/js/states/menu.js":[function(require,module,exports){
var Menu = function () {
};

module.exports = Menu;

Menu.prototype = {
  create: function () {
    this.game.stage.backgroundColor = '#ffffff';

    var startText = "Press to start!";
    var textProps = { font: '24pt Arial',
                      fill: '#C24300',
                      strokeThickness: 0 };

    var cinderLogoW = this.game.cache.getImage('cinderLogo').width;
    var cinderLogoH = this.game.cache.getImage('cinderLogo').height;

    var x = (this.game.width / 2) - (cinderLogoW / 2);
    var y = (this.game.height / 3) - (cinderLogoH / 2);

    this.game.add.sprite(x, y, 'cinderLogo');
    this.game.add.text(x, y + cinderLogoH * 1.5, startText, textProps);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    if (!this.game.device.desktop) {
      this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.startFullScreen(true);
    }

    this.game.state.start('Game');
  }
};

},{}],"/Users/borden/src/sagdx/src/js/states/mermaidgame.js":[function(require,module,exports){
var TextManager = require('../utilities/TextManager.js');
var Interstitial = require('../entities/Interstitial.js');
var Timer = require('../entities/Timer.js');

var MermaidGame = function () {
};

MermaidGame.prototype = {
  create: function () {

    this.bad = this.game.add.audio('bad');
    this.good = this.game.add.audio('good');
    this.wabang = this.game.add.audio('wabang');

    this.gameTime = 4000;
    this.TextManager = new TextManager(this.game);
    this.Timer = null;
    this.game.stage.backgroundColor = '#327ed0';

    this.filter = new Phaser.Filter(this.game, null, waterShader);
    this.filter.setResolution(this.game.stage.width, this.game.stage.height);

    this.ready = false;
    this.clamReady = false;
    this.vuln = !this.clamReady;
    this.lost = false;
    this.attacked = false;

    this.clam = this.game.add.sprite(this.game.width / 3, this.game.height / 3, 'clam');
    this.clam.animations.add('shut');
    this.clam.animations.add('open', [3, 2, 1, 0]);

    this.attackers = [];
    this.fish = [];

    var fishCount = Math.floor((Math.random() * 4) + 1);
    for (var i = 0; i < fishCount; i++) {
      var yOffset = Math.floor((Math.random() * 150) + 50);
      var baseX = (i == 0 || i == 2) ? 64 : this.game.width - 100;
      var baseY = (i == 3 || i == 2) ? this.game.height - 64 - yOffset : 64 + yOffset;

      var fishTmp = this.game.add.sprite(baseX, baseY, 'fish');
      fishTmp.anchor.setTo(0.5, 1);
      fishTmp.animations.add('swim');
      fishTmp.animations.play('swim', 5, true);
      fishTmp.attacker = (Math.floor((Math.random() * 10) + 1)) > 7;
      fishTmp.facingLeft = (Math.floor((Math.random() * 2) + 1)) > 1;

      if (!fishTmp.facingLeft)
        fishTmp.scale.x = -1;

      if (this.attackers.length == 0 && i == fishCount - 1)
        fishTmp.attacker = true;

      if (fishTmp.attacker) {
        var countDown = this.gameTime -
              (Math.floor((Math.random() * (this.gameTime / 2)) + 1));
        fishTmp.time = countDown;
        fishTmp.attacked = false;
        this.attackers.push(fishTmp);
      }

      this.fish.push(fishTmp);
    }

    this.input.onDown.add(this.onDown, this);
    this.clamCooldown = 2000;
    this.clamDown = 750;

    this.inter = new Interstitial(this.game, "PROTECT THE CLAM", 1500, function() {
      this.inter.destroy();
      this.ready = true;
      this.clamReady = true;
      var filterSprite = this.game.add.sprite();
      filterSprite.width = this.game.stage.width;
	    filterSprite.height = this.game.stage.height;
      filterSprite.fixedToCamera = false;
	    filterSprite.filters = [ this.filter ];
      this.Timer = new Timer(this.game, this.gameTime, this.onTimerComplete, this, true);
      this.Timer.start();
    }, this);
  },

  update: function () {
    if (!this.ready)
      return;

    this.filter.update(this.game.input.activePointer);
    for (var i = 0; i < this.attackers.length; i++) {
      if (this.Timer.timer.timer.duration <= this.attackers[i].time &&
          this.Timer.timer.timer.duration != 0 &&
          !this.attackers[i].attacked) {
        this.attackers[i].attacked = true;

        if (this.attackers[i].x < this.clam.x &&
            this.attackers[i].facingLeft)
          this.attackers[i].scale.x = -1;
        else if (this.attackers[i].x > this.clam.x &&
                 !this.attackers[i].facingLeft)
          this.attackers[i].scale.x = 1;

        var tween = this.game.add.tween(this.attackers[i])
              .to({ x: this.clam.x + (this.clam.width / 2.5),
                    y: this.clam.y + (this.clam.height / 2) },
                  760 - (window.SpeedMultiplier * 20),
                  Phaser.Easing.Linear.None,
                  false,
                  100 - (window.SpeedMultipler * 20))
              .start();
      }

      if (this.attackers[i].attacked) {
        var boundsClam = Phaser.Rectangle.inflate(this.clam.getBounds(), -70, -80);
        boundsClam.y += 20;
        boundsClam.x -= 25;
        var boundsAttacker = this.attackers[i].getBounds();

        if (Phaser.Rectangle.intersects(boundsClam, boundsAttacker)) {
          if (this.vuln) {
            this.lost = true;
          } else {
            var tmp = this.attackers[i];
            var run = this.game.add.tween(tmp)
                  .to({ x: Math.floor(Math.random() * this.game.width),
                        y: -100 },
                      850,
                      Phaser.Easing.Linear.None,
                      false,
                      0);
            run.onComplete.add(function() { tmp.destroy(); });
            run.start();
            this.attackers.splice(i, 1);
          }
        }
      }
    }

    for (var i = 0; i < this.fish.length; i++) {
      if (!this.fish[i].attacked) {
      if (this.fish[i].x > this.game.width ||
          this.fish[i].x < 0) {
        this.fish[i].facingLeft = !this.fish[i].facingLeft;
        this.fish[i].scale.x *= -1;
      }

      var dir = 0.5;
      if (this.fish[i].facingLeft)
        dir *= -1;
      this.fish[i].x += dir;
      }
    }
  },

  onTimerComplete: function () {
    if (!this.lost)
      this.win();
    else
      this.lose();
  },

  lose: function () {
    this.bad.play();
    this.ready = false;
    window.Score -= 100;
    window.Lives -= 2;
    this.TextManager.statusText("LOSE!");
    this.game.time.events.add(4000, this.end, this);
  },

  win: function () {
    this.good.play();
    this.ready = false;
    window.SpeedMultiplier += 0.5;
    window.Score += 100;
    this.TextManager.statusText("WIN!");
    this.game.time.events.add(4000, this.end, this);
  },

  onDown: function () {
    if (!this.ready || !this.clamReady)
      return;

    this.clam.animations.play('shut', 20);
    this.wabang.play();
    this.clamReady = false;
    this.vuln = false;
    this.game.time.events.add(this.clamCooldown, function() { this.clamReady = true; }.bind(this));
    this.game.time.events.add(this.clamDown,
                              function() {
                                this.clam.animations.play('open', 20);
                                this.vuln = true;
                              }.bind(this));
  },

  end: function() {
    this.game.stage.backgroundColor = '#ffffff';
    this.game.state.start('Game');
  }
};

module.exports = MermaidGame;

var waterShader = [
    "precision mediump float;",
    "uniform float     time;",
    "uniform vec2      resolution;",
    "uniform vec2      mouse;",
    "#define MAX_ITER 4",
    "void main( void )",
    "{",
        "vec2 v_texCoord = gl_FragCoord.xy / resolution;",
        "vec2 p =  v_texCoord * 8.0 - vec2(20.0);",
        "vec2 i = p;",
        "float c = 0.8;",
        "float inten = .03;",
        "for (int n = 0; n < MAX_ITER; n++)",
        "{",
            "float t = time * (1.0 - (3.0 / float(n+1)));",
            "i = p + vec2(cos(t - i.x) + sin(t + i.y),",
            "sin(t - i.y) + cos(t + i.x));",
            "c += 1.0/length(vec2(p.x / (sin(i.x+t)/inten),",
            "p.y / (cos(i.y+t)/inten)));",
        "}",
        "c /= float(MAX_ITER);",
        "c = 1.5 - sqrt(c);",
        "vec4 texColor = vec4(0.0, 0.01, 0.015, 0.2);",
        "texColor.rgb *= (1.0 / (1.0 - (c + 0.05)));",
        "gl_FragColor = texColor;",
    "}"
];

},{"../entities/Interstitial.js":"/Users/borden/src/sagdx/src/js/entities/Interstitial.js","../entities/Timer.js":"/Users/borden/src/sagdx/src/js/entities/Timer.js","../utilities/TextManager.js":"/Users/borden/src/sagdx/src/js/utilities/TextManager.js"}],"/Users/borden/src/sagdx/src/js/states/preloader.js":[function(require,module,exports){
var CinderProfiles = require('../data/CinderProfiles.js');

var Preloader = function (game) {
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

  preload: function () {
    var assetRoot = 'assets/';

    this.asset = this.add.sprite(320, 240, 'preloader');
    this.asset.anchor.setTo(0.5, 0.5);

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);
    this.load.image('SAGDX', 'assets/sagdx_logo.png');
    this.load.image('cinderLogo', 'assets/cinder-logo.png');
    this.load.image('cinderFrame', 'assets/cinder-frame.png');
    this.load.image('match', 'assets/its_a_match.jpg');
    this.load.image('nope', 'assets/NOPE.png');
    this.load.image('like', 'assets/like.png');
    this.load.image('header', 'assets/header.png');
    this.load.image('xButton', 'assets/x_button.png');
    this.load.image('heartButton', 'assets/heart_button.png');
    this.load.image('revealTextArea', 'assets/reveal_text_area.jpg');
    this.load.image('timer-animation', 'assets/timer-animation.png');
    this.load.image('foot', 'assets/foot.png');
    this.load.image('slipper', 'assets/slipper.png');
    this.load.image('spark', 'assets/particle.png');
    this.load.image('taxbg', 'assets/taxbg.png');

    this.load.image('heart', 'assets/heart.png');
    this.load.image('smallheart', 'assets/heartsmall.png');

    this.load.image('frogHaus', 'assets/froghaus_color.jpg');
    this.load.spritesheet('frogPlayer', 'assets/naked_runner.png', 160, 190, 3);
    this.load.spritesheet('frogChaser', 'assets/frogrun.png', 152, 189, 4);
    this.load.spritesheet('leftShoe', 'assets/left_shoe.png', 48, 110, 3);
    this.load.spritesheet('rightShoe', 'assets/right_shoe.png', 48, 110, 3);
    this.game.load.audio('blip', 'assets/sounds/blip.mp3');

    this.load.image('snakeBite', 'assets/snake_bite.png');
    this.load.spritesheet('snake', 'assets/snake_sprite.png', 173, 416, 2);
    this.load.spritesheet('condom', 'assets/condom_sprite.png', 208, 499, 4);
    this.game.load.audio('hiss', 'assets/sounds/hiss.mp3');

    this.load.image('cosbyBg', 'assets/cosby_bg.jpg');
    this.load.image('cup', 'assets/solo_cup.png');
    this.load.spritesheet('pill', 'assets/pill.png', 50, 50, 6);
    this.load.spritesheet('splash', 'assets/splash.png', 250, 90, 4);

    this.load.image('tchBackground', 'assets/tch_bg.jpg');
    this.load.spritesheet('vase', 'assets/vase.png', 29, 40, 2);
    this.load.spritesheet('bottle', 'assets/bottle.png', 35, 35, 2);
    this.load.spritesheet('coatRack', 'assets/coat_rack.png', 53, 176, 2);
    this.load.spritesheet('cat', 'assets/cat.png', 53, 24, 4);
    this.game.load.audio('crash', 'assets/sounds/crash.mp3');

    this.load.spritesheet('clam', 'assets/clam.png', 202, 215, 4);
    this.load.spritesheet('fish', 'assets/fish.png', 75, 50, 4);

    this.load.spritesheet('skelly', 'assets/skelly.png', 383, 500, 6);
    this.load.spritesheet('up-arrow', 'assets/up-arrow.png', 50, 90, 4);
    this.load.spritesheet('down-arrow', 'assets/down-arrow.png', 50, 90, 4);
    this.load.spritesheet('right-arrow', 'assets/right-arrow.png', 90, 50, 4);
    this.load.spritesheet('left-arrow', 'assets/left-arrow.png', 90, 50, 4);
    this.game.load.audio('yay', 'assets/sounds/yay-ding.mp3');
    this.game.load.audio('boo', 'assets/sounds/boo-ding.mp3');

    this.game.load.audio('good', 'assets/sounds/good.wav');
    this.game.load.audio('bad', 'assets/sounds/bad.wav');
    this.game.load.audio('wabang', 'assets/sounds/wa-bang.wav');
    this.game.load.audio('bgMusic', 'assets/sounds/sagdx.mp3');
    this.game.load.audio('tada', 'assets/sounds/tada.mp3');

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);

    window.CurrentProfileIdx = -1;
    window.CinderProfiles = this.shuffleProfiles();

    this.load.image('cinderLogo', assetRoot + 'cinder-logo.png');
    this.load.image('cinderFrame', assetRoot + 'cinder-frame.png');

    for (var i = 0; i < window.CinderProfiles.length; i++) {
      var profile = window.CinderProfiles[i];
      this.load.image(profile.image, assetRoot + profile.image);
      this.load.image(profile.revealImage, assetRoot + profile.revealImage);
      if(!!profile.revealImage2) this.load.image(profile.revealImage2, assetRoot + profile.revealImage2);
    }
  },

  shuffleProfiles: function() {
    var currentIdx = CinderProfiles.PROFILES.length, tmp, randomIdx;

    while (0 !== currentIdx) {
      randomIdx = Math.floor(Math.random() * currentIdx);
      currentIdx -= 1;

      tmp = CinderProfiles.PROFILES[currentIdx];
      CinderProfiles.PROFILES[currentIdx] = CinderProfiles.PROFILES[randomIdx];
      CinderProfiles.PROFILES[randomIdx] = tmp;
    }

    return CinderProfiles.PROFILES;
  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
      this.game.state.start('ClickMe');
    }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

},{"../data/CinderProfiles.js":"/Users/borden/src/sagdx/src/js/data/CinderProfiles.js"}],"/Users/borden/src/sagdx/src/js/states/sagdx.js":[function(require,module,exports){
var SAGDX = function () {
};

module.exports = SAGDX;

SAGDX.prototype = {
  create: function () {
    if(!window.bgMusic) {
      window.bgMusic = this.game.add.audio('bgMusic');
      window.bgMusic.play('', 0, 0.7, true);
    }
    this.blue = true;
    this.game.stage.backgroundColor = '#9CD4E6';

    var logoW = this.game.cache.getImage('SAGDX').width;
    var logoH = this.game.cache.getImage('SAGDX').height;

    var x = (this.game.width / 2) - (logoW / 2);
    var y = (this.game.height / 2) - (logoH / 2);

    this.game.add.sprite(x, y, 'SAGDX');

    this.input.onDown.add(this.onDown, this);
    this.timeout = this.game.time.events.add(3000, this.startGame, this);
  },

  update: function () {
    if(this.blue) {
      this.game.stage.backgroundColor = '#ACE4F6';
      this.blue = false;
    } else {
      this.game.stage.backgroundColor = '#8CC4D6';
      this.blue = true;
    }
  },

  onDown: function () {
    if (!this.game.device.desktop) {
      this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.startFullScreen(true);
    }

    this.startGame();
  },

  startGame: function() {
    this.game.state.start('Menu');
  }
};

},{}],"/Users/borden/src/sagdx/src/js/states/snakegame.js":[function(require,module,exports){
var TextManager = require('../utilities/TextManager.js');
var Interstitial = require('../entities/Interstitial.js');
var Timer = require('../entities/Timer.js');
var SwipeManager = require('../utilities/SwipeManager.js');

var SWIPES_PER_STAGE = 4;
var BASE_STAGE_TIME = 1600;

var SnakeGame = function () {
};

SnakeGame.prototype = {
  create: function () {
    this.bad = this.game.add.audio('bad');
    this.good = this.game.add.audio('good');
    this.hiss = this.game.add.audio('hiss');

    if (!this.game.device.desktop) this.input.onDown.add(this.goFullscreen, this);

    this.TextManager = new TextManager(this.game);

    this.game.stage.backgroundColor = '#2b2544';

    this.game.plugins.add(new SwipeManager(this.game, this.swipe, this, true));

    this.TimeUp = new Timer(this.game, 10000, this.onTimeUp, this);

    this.stageTime = BASE_STAGE_TIME - (window.SpeedMultiplier * 100);

    this.condomTimer = null;

    this.snake = this.game.add.sprite(0, 190, 'snake');
    this.condom = this.game.add.sprite(0, 95, 'condom');

    this.condomState = 0;
    this.swipeCount = 0;

    this.snake.x = (this.game.width / 2) - (this.snake.width / 2);
    this.condom.x = (this.game.width / 2) - (this.condom.width / 2);

    this.snake.animations.add('wriggle');
    this.snake.animations.play('wriggle', 1.2 * window.SpeedMultiplier, true);

    this.ready = false;

    this.inter = new Interstitial(this.game, "WRAP IT UP", 1500, function() {
      this.inter.destroy();
      this.ready = true;
      this.TimeUp.start();
    }, this);
  },

  goFullscreen: function() {
    if(this.game.scale.isFullScreen) return;
    this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
    this.game.scale.startFullScreen(true);
  },

  update: function() {
    if (!this.ready) return;
  },

  swipe: function(swipeDirection) {
    if(!this.ready) return;

    if (swipeDirection == SwipeManager.SWIPE_DIRECTIONS.DOWN) {
      this.onSwipeDown();
    }
  },

  onSwipeDown: function() {
    this.swipeCount++;
    if(this.swipeCount >= SWIPES_PER_STAGE) this.changeCondomState(1);
  },

  restartCondomTimer: function() {
    var timeEvents = this.game.time.events;
    if(this.condomTimer) timeEvents.remove(this.condomTimer);

    this.condomTimer = timeEvents.add(this.stageTime, this.retreatCondom, this);
  },

  retreatCondom: function() {
    this.changeCondomState(-1);
  },

  changeCondomState: function(change) {
    if (!this.ready) return;

    this.restartCondomTimer();

    this.swipeCount = 0;

    this.condomState += change;

    if(this.condomState < 0) {
      this.condomState = 0;
      return;
    };

    this.condom.frame = this.condomState;

    if(this.condomState > 2) {
      this.win();
      return;
    };
  },

  onTimeUp: function () {
    this.snakeBite();
    this.lose();
  },

  snakeBite: function () {
    this.game.add.image(80, 45, 'snakeBite');
    this.condom.angle += 35;
  },

  lose: function () {
    this.bad.play();
    this.hiss.play();
    this.ready = false;
    window.Score -= 100;
    window.Lives -= 2;
    this.TextManager.statusText("LOSE!");
    this.game.time.events.add(2000, this.end, this);
  },

  win: function () {
    this.good.play();
    this.ready = false;
    window.SpeedMultiplier += 0.5;
    window.Score += 100;
    this.TextManager.statusText("WIN!");
    this.TimeUp.end();
    this.game.time.events.add(2000, this.end, this);
  },

  end: function() {
    this.game.state.start('Game');
    this.game.stage.backgroundColor = '#FFFFFF';
  }
};

module.exports = SnakeGame;

},{"../entities/Interstitial.js":"/Users/borden/src/sagdx/src/js/entities/Interstitial.js","../entities/Timer.js":"/Users/borden/src/sagdx/src/js/entities/Timer.js","../utilities/SwipeManager.js":"/Users/borden/src/sagdx/src/js/utilities/SwipeManager.js","../utilities/TextManager.js":"/Users/borden/src/sagdx/src/js/utilities/TextManager.js"}],"/Users/borden/src/sagdx/src/js/states/splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],"/Users/borden/src/sagdx/src/js/states/thiscatishorseshit.js":[function(require,module,exports){
var TextManager = require('../utilities/TextManager.js');
var Interstitial = require('../entities/Interstitial.js');
var Timer = require('../entities/Timer.js');
var BASE_CAT_X_VEL = 200;
var BASE_CAT_Y_VEL = 100;

var Collidable = function(game, x, y, sprite, broken) {
  Phaser.Sprite.call(this, game, x, y, sprite);

  this.name = sprite;
  this.broken = broken;
}
Collidable.prototype = Object.create(Phaser.Sprite.prototype);
Collidable.prototype.constructor = Collidable;

var ThisCatIsHorseShit = function () {
};

ThisCatIsHorseShit.prototype = {
  create: function () {
    var self = this;

    this.crash = this.game.add.audio('crash');
    this.ding = this.game.add.audio('yay');

    this.bad = this.game.add.audio('bad');
    this.good = this.game.add.audio('good');

    if (!this.game.device.desktop) this.input.onDown.add(this.goFullscreen, this);

    this.background = this.game.add.image(0, 0, 'tchBackground');

    this.TextManager = new TextManager(this.game);
    this.Timer = null;

    this.game.physics.startSystem(Phaser.Physics.ARCADE);

    this.cat = this.game.add.sprite(192, 330, 'cat');

    this.coatRack = this.game.add.existing(new Collidable(this.game, 53, 205, 'coatRack', false));
    this.bottle = this.game.add.existing(new Collidable(this.game, 255, 320, 'bottle', false));
    this.vase = this.game.add.existing(new Collidable(this.game, 361, 279, 'vase', false));

    this.collidables = [this.coatRack, this.vase, this.bottle];

    this.cat.animations.add('run');
    this.cat.animations.play('run', 10, true);

    this.ready = false;

    this.inter = new Interstitial(this.game, "THIS CAT IS HORSESHIT", 2000, function() {
      this.inter.destroy();
      this.ready = true;
      this.initGame();
      this.Timer = new Timer(this.game, 4500, this.onTimeUp, this);
      this.Timer.start();
    }, this);
  },

  initGame: function() {
    this.game.physics.arcade.setBounds(0, 154, 414, 222);

    this.game.physics.enable(this.cat, Phaser.Physics.ARCADE);

    this.initCollidables();
    this.initCat();

  },

  initCollidables: function() {
    for (i in this.collidables) {
      var collidable = this.collidables[i];

      this.game.physics.enable(collidable, Phaser.Physics.ARCADE);
      collidable.body.immovable = true;

      collidable.events.onInputDown.add(this.onClickCollidable , this);
      collidable.inputEnabled = true;
    }
  },

  initCat: function() {
    var randX = Math.floor(Math.random() * 50);
    var randY = Math.floor(Math.random() * 50);
    var randXSign = (Math.random() > .5) ? 1 : -1;
    var randYSign = (Math.random() > .5) ? 1 : -1;

    var speedModifier = ((window.SpeedMultiplier - 1) / 2) + 1;

    var velX = (BASE_CAT_X_VEL + randX * speedModifier) * randXSign;
    var velY = (BASE_CAT_Y_VEL + randY * speedModifier) * randYSign;

    this.cat.body.velocity.setTo(velX, velY);

    this.cat.body.collideWorldBounds = true;

    this.cat.body.bounce.set(1.0);
  },

  onClickCollidable: function(collidable) {
    if (this.ready) {
      collidable.broken = false;
      collidable.frame = 0;
      this.ding.play();
    }
  },

  goFullscreen: function() {
    if(this.game.scale.isFullScreen) return;
    this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
    this.game.scale.startFullScreen(true);
  },

  update: function() {
    if (!this.ready) return;

    for(i in this.collidables) {
      var collidable = this.collidables[i];
      this.game.physics.arcade.overlap(this.cat, collidable, function() {
        this.crash.play('', 0, 0.2, false);
        collidable.broken = true;
        collidable.frame = 1;
      }, null, this);
    }
  },

  onTimeUp: function() {
    var brokenItems = 0;

    this.cat.body.velocity.setTo(0,0);

    for (i in this.collidables) {
      if(this.collidables[i].broken) return this.lose();
    }

    this.win();
  },

  lose: function() {
    this.bad.play();
    this.ready = false;
    window.Score -= 100;
    window.Lives -= 2;
    this.TextManager.statusText("LOSE!");
    this.game.time.events.add(2000, this.end, this);
  },

  win: function() {
    this.good.play();
    this.ready = false;
    window.SpeedMultiplier += 0.5;
    window.Score += 100;
    this.TextManager.statusText("WIN!");
    this.game.time.events.add(2000, this.end, this);
  },

  end: function() {
    this.game.state.start('Game');
  }
};

module.exports = ThisCatIsHorseShit;

},{"../entities/Interstitial.js":"/Users/borden/src/sagdx/src/js/entities/Interstitial.js","../entities/Timer.js":"/Users/borden/src/sagdx/src/js/entities/Timer.js","../utilities/TextManager.js":"/Users/borden/src/sagdx/src/js/utilities/TextManager.js"}],"/Users/borden/src/sagdx/src/js/states/warning.js":[function(require,module,exports){
var ClickMe = function () {
};

module.exports = ClickMe;

ClickMe.prototype = {
  create: function () {
    this.game.stage.backgroundColor = '#000000';

    var warning = "Warning";
    var warningProps = { font: '48pt Arial',
                      fill: '#C24300',
                      strokeThickness: 0 };

    var info = "this game is best enjoyed";
    var info2 = "on a smart phone";
    var infoProps = { font: '22pt Arial', fill: '#C24300', strokeThickness: 0 };

    var warningText = this.game.add.text(0, 0, warning, warningProps);
    var infoText = this.game.add.text(0, 0, info, infoProps);
    var info2Text = this.game.add.text(0, 0, info2, infoProps);

    warningText.x = (this.game.width / 2) - (warningText.width / 2);
    warningText.y = (this.game.height / 4) - (warningText.height / 2);

    infoText.x = (this.game.width / 2) - (infoText.width / 2);
    infoText.y = (this.game.height / 2) - (infoText.height / 2);

    info2Text.x = (this.game.width / 2) - (info2Text.width / 2);
    info2Text.y = (this.game.height / 1.8) - (info2Text.height / 2);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    if (!this.game.device.desktop) {
      this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.startFullScreen(true);
    }

    this.startGame();
  },

  startGame: function() {
    this.game.state.start('SAGDX');
  }
};

},{}],"/Users/borden/src/sagdx/src/js/utilities/SwipeManager.js":[function(require,module,exports){
var SwipeManager = function(game, callback, receiver, verticalIncluded) {
  Phaser.Plugin.call(this, game);
  this.game = game;
  this.onCooldown = false;
  this.cooldown = 0;
  this.checkVert = verticalIncluded || false;
  this.onSwipe = callback.bind(receiver);
  this.swipeDirection = SwipeManager.SWIPE_DIRECTIONS.LEFT;
};

SwipeManager.prototype = Object.create(Phaser.Plugin.prototype);
SwipeManager.prototype.constructor = SwipeManager;

SwipeManager.prototype.update = function() {
  var start = this.game.input.activePointer.positionDown;
  var end = this.game.input.activePointer.position;

  var distance = Phaser.Point.distance(start, end);
  var duration = this.game.input.activePointer.duration;

  if (duration > 0 && !this.onCooldown) {
    if (distance > SwipeManager.SWIPE_DIST && duration < SwipeManager.SWIPE_TIME) {
      swipeDirection = end.x > start.x ? SwipeManager.SWIPE_DIRECTIONS.RIGHT :
        SwipeManager.SWIPE_DIRECTIONS.LEFT;

      if (this.checkVert) {
        var xDist = start.x - end.x;
        var yDist = start.y - end.y;
        if (Math.abs(yDist) > Math.abs(xDist))
          swipeDirection = end.y > start.y ? SwipeManager.SWIPE_DIRECTIONS.DOWN :
            SwipeManager.SWIPE_DIRECTIONS.UP;
      }

      this.onSwipe(swipeDirection, start, end);
      this.onCooldown = true;
    }
  }

  if (this.onCooldown) {
    this.cooldown += 1;

    if (this.cooldown >= SwipeManager.SWIPE_COOLDOWN) {
      this.cooldown = 0;
      this.onCooldown = false;
    }
  }
};

SwipeManager.SWIPE_TIME = 250;
SwipeManager.SWIPE_DIST = 100;
SwipeManager.SWIPE_COOLDOWN = 10;
SwipeManager.SWIPE_DIRECTIONS = {
  LEFT: 0,
  RIGHT: 1,
  UP: 2,
  DOWN: 3
};

module.exports = SwipeManager;

},{}],"/Users/borden/src/sagdx/src/js/utilities/TextManager.js":[function(require,module,exports){
var TextManager = function(game) {
  this.game = game;
  this.bonusTexts = [];
  this.floatingTexts = [];
};

TextManager.prototype.addFloatingText = function(text, dir, reason, x, y, size) {
  var startX = x || this.game.width / 2;
  var startY = y || this.game.height / 2;
  var txtSize = size || 40;
  var direct = dir || "up";
  var target = 64;
  var textReason = null;

  if (direct === "down")
    target = this.game.height - 64;

  var textObj = this.game.add.text(startX, startY, text, { font: txtSize + 'px Arial' });
  console.log(textObj);
  textObj.x -= (textObj.width / 2) + 16;

  if (typeof reason !== "undefined") {
    textReason = this.game.add.text(0, -16, reason, { font: '16px Arial' });
    textObj.addChild(textReason);
  }

  var tween = this.game.add.tween(textObj.scale)
        .to({ y: 1.2, x: 1.2 }, 200, Phaser.Easing.Linear.None, false, 200);
  tween.onComplete.add(function() {
    var tween2 = this.game.add.tween(textObj)
          .to({ y: target , alpha: 0 }, 1000, Phaser.Easing.Linear.None, false, 700);
    tween2.onComplete.add(function() {
      textObj.destroy();
    });
    tween2.start();
  }, this);
  tween.start();
};

TextManager.prototype.statusText = function(text) {
  var x = this.game.camera.x + this.game.width / 2;
  var y =  this.game.camera.y + this.game.height / 2;

  var bg = this.game.add.graphics(0, y - 36);
  bg.beginFill(0x000000, 1);
  bg.boundsPadding = 0;
  bg.drawRect(this.game.camera.x, 0, this.game.camera.x + this.game.width, 64);

  var textObj = this.game.add.text(x, y, text, { font: '40px Arial', fill: '#ffffff' });
  textObj.x -= (textObj.width / 2);
  textObj.y -= (textObj.height / 2);

  var flashTween = this.game.add.tween(textObj);
  flashTween.to({ visible: !textObj.visible }, 20, Phaser.Easing.Linear.None, true, 20, -1, true);
  flashTween.start();
}

module.exports = TextManager;

},{}],"/Users/borden/src/sagdx/src/js/utils.js":[function(require,module,exports){
var Utils = {
  containsObject: function(obj, list) {
    var i;
    for (i = 0; i < list.length; i++) {
      if (list[i] === obj) {
        return true;
      }
    }

    return false;
  }
};

module.exports = Utils;

},{}]},{},["/Users/borden/src/sagdx/src/js/main.js"])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZGF0YS9DaW5kZXJQcm9maWxlcy5qcyIsInNyYy9qcy9lbnRpdGllcy9DaW5kZXJQcm9maWxlLmpzIiwic3JjL2pzL2VudGl0aWVzL0ludGVyc3RpdGlhbC5qcyIsInNyYy9qcy9lbnRpdGllcy9Qcm9maWxlUmV2ZWFsLmpzIiwic3JjL2pzL2VudGl0aWVzL1RpbWVyLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvc3RhdGVzL2Jvb3QuanMiLCJzcmMvanMvc3RhdGVzL2NpbmRlcmVsbGFnYW1lLmpzIiwic3JjL2pzL3N0YXRlcy9jbGlja21lLmpzIiwic3JjL2pzL3N0YXRlcy9jdXBnYW1lLmpzIiwic3JjL2pzL3N0YXRlcy9kZHJnYW1lLmpzIiwic3JjL2pzL3N0YXRlcy9mbGF0dGF4Z2FtZS5qcyIsInNyYy9qcy9zdGF0ZXMvZnJvZ2dhbWUuanMiLCJzcmMvanMvc3RhdGVzL2dhbWUuanMiLCJzcmMvanMvc3RhdGVzL2dhbWVvdmVyLmpzIiwic3JjL2pzL3N0YXRlcy9tZW51LmpzIiwic3JjL2pzL3N0YXRlcy9tZXJtYWlkZ2FtZS5qcyIsInNyYy9qcy9zdGF0ZXMvcHJlbG9hZGVyLmpzIiwic3JjL2pzL3N0YXRlcy9zYWdkeC5qcyIsInNyYy9qcy9zdGF0ZXMvc25ha2VnYW1lLmpzIiwic3JjL2pzL3N0YXRlcy9zcGxhc2guanMiLCJzcmMvanMvc3RhdGVzL3RoaXNjYXRpc2hvcnNlc2hpdC5qcyIsInNyYy9qcy9zdGF0ZXMvd2FybmluZy5qcyIsInNyYy9qcy91dGlsaXRpZXMvU3dpcGVNYW5hZ2VyLmpzIiwic3JjL2pzL3V0aWxpdGllcy9UZXh0TWFuYWdlci5qcyIsInNyYy9qcy91dGlscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdE9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBDaW5kZXJQcm9maWxlcyA9IGZ1bmN0aW9uKCkge1xufTtcblxuQ2luZGVyUHJvZmlsZXMuUFJPRklMRVMgPSBbXG4gIHtcbiAgICBuYW1lOiAnR2lybCBOZXh0IERvb3InLFxuICAgIGltYWdlOiAnZnJvZ19wcm9maWxlLnBuZycsXG4gICAgY29ycmVjdERpcmVjdGlvbjogMSxcbiAgICByZXZlYWxJbWFnZTogJ2Zyb2dfcmV2ZWFsLnBuZycsXG4gICAgcmV2ZWFsSW1hZ2UyOiAnZnJvZ19yZXZlYWwyLnBuZycsXG4gICAgcmV2ZWFsVGV4dDogJ0dFVCBPVVQnLFxuICAgIG1pbmlnYW1lOiAnRnJvZ0dhbWUnLFxuICAgIG1pbmlnYW1lRGlyZWN0aW9uOiAxXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAnRWxsYScsXG4gICAgaW1hZ2U6ICdjaW5kZXJlbGxhX3Byb2ZpbGUuanBnJyxcbiAgICBjb3JyZWN0RGlyZWN0aW9uOiAxLFxuICAgIHJldmVhbEltYWdlOiAnY2luZGVyZWxsYV9yZXZlYWwuanBnJyxcbiAgICByZXZlYWxUZXh0OiAnVGVIIEIxZyBSM1YzNGwhISExJyxcbiAgICBtaW5pZ2FtZTogJ0NpbmRlcmVsbGFHYW1lJyxcbiAgICBtaW5pZ2FtZURpcmVjdGlvbjogMVxuICB9LFxuICB7XG4gICAgbmFtZTogJ2JlYWNoZ3JsJyxcbiAgICBpbWFnZTogJ21lcm1haWRfcHJvZmlsZS5qcGcnLFxuICAgIGNvcnJlY3REaXJlY3Rpb246IDEsXG4gICAgcmV2ZWFsSW1hZ2U6ICdtZXJtYWlkMS5wbmcnLFxuICAgIHJldmVhbFRleHQ6ICdPSCBPSCBIT1cgRE9FUyBUSElTIFdPUks/JyxcbiAgICBtaW5pZ2FtZTogJ01lcm1haWRHYW1lJyxcbiAgICBtaW5pZ2FtZURpcmVjdGlvbjogMVxuICB9LFxuICB7XG4gICAgbmFtZTogJ2xvbGl0ZXJhbGx5ZGVhZCcsXG4gICAgaW1hZ2U6ICdkYW5jZV9wcm9maWxlLmpwZycsXG4gICAgY29ycmVjdERpcmVjdGlvbjogMSxcbiAgICByZXZlYWxJbWFnZTogJ2RhbmNpbmdfcmV2ZWFsLmpwZycsXG4gICAgcmV2ZWFsVGV4dDogJ1dBTk5BIERBTkNFPycsXG4gICAgbWluaWdhbWU6ICdERFJHYW1lJyxcbiAgICBtaW5pZ2FtZURpcmVjdGlvbjogMVxuICB9LFxuICB7XG4gICAgbmFtZTogJ0dvcmdvbiBHaXJsJyxcbiAgICBpbWFnZTogJ21lZHVzYV9iZWZvcmUucG5nJyxcbiAgICBjb3JyZWN0RGlyZWN0aW9uOiAxLFxuICAgIHJldmVhbEltYWdlOiAnbWVkdXNhX2FmdGVyLnBuZycsXG4gICAgcmV2ZWFsVGV4dDogXCJPSCBOTyBJVCdTIEEgR09SR09OXCIsXG4gICAgbWluaWdhbWU6ICdTbmFrZUdhbWUnLFxuICAgIG1pbmlnYW1lRGlyZWN0aW9uOiAxXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAnRHIuIEh1eHRhYmxlJyxcbiAgICBpbWFnZTogJ2Nvc2J5X2JlZm9yZS5qcGcnLFxuICAgIGNvcnJlY3REaXJlY3Rpb246IDEsXG4gICAgcmV2ZWFsSW1hZ2U6ICdjb3NieV9hZnRlci5qcGcnLFxuICAgIHJldmVhbFRleHQ6IFwiWmlwIFpvcCBab29iaXR5IEJvcCFcIixcbiAgICBtaW5pZ2FtZTogJ0N1cEdhbWUnLFxuICAgIG1pbmlnYW1lRGlyZWN0aW9uOiAxXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAnTGliZXJ0eSBBYnMnLFxuICAgIGltYWdlOiAnbGliX3Byb2ZpbGUuanBnJyxcbiAgICBjb3JyZWN0RGlyZWN0aW9uOiAxLFxuICAgIHJldmVhbEltYWdlOiAnbGliX3JldmVhbC5qcGcnLFxuICAgIHJldmVhbFRleHQ6ICdMSUJFUlRBUklBTlMnLFxuICAgIG1pbmlnYW1lOiAnRmxhdFRheEdhbWUnLFxuICAgIG1pbmlnYW1lRGlyZWN0aW9uOiAxXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAnVGF6d2VsbCcsXG4gICAgaW1hZ2U6ICd0Y2hfcHJvZmlsZS5wbmcnLFxuICAgIGNvcnJlY3REaXJlY3Rpb246IDEsXG4gICAgcmV2ZWFsSW1hZ2U6ICd0Y2hfcmV2ZWFsLnBuZycsXG4gICAgcmV2ZWFsVGV4dDogJ1RISVMgQ0FUIElTIEhPUlNFU0hJVCcsXG4gICAgbWluaWdhbWU6ICdUaGlzQ2F0SXNIb3JzZVNoaXQnLFxuICAgIG1pbmlnYW1lRGlyZWN0aW9uOiAxXG4gIH1cbl07XG5cbm1vZHVsZS5leHBvcnRzID0gQ2luZGVyUHJvZmlsZXM7XG4iLCJ2YXIgQ2luZGVyUHJvZmlsZSA9IGZ1bmN0aW9uKGdhbWUsIGRpcmVjdGlvbikge1xuICBQaGFzZXIuR3JvdXAuY2FsbCh0aGlzLCBnYW1lKTtcbiAgdGhpcy5nYW1lID0gZ2FtZTtcbiAgdGhpcy5wcm9maWxlID0gbnVsbDtcbiAgdGhpcy5zZWxlY3Rpb25SZXN1bHQgPSBudWxsO1xuICB0aGlzLmdlbmVyYXRlUHJvZmlsZShkaXJlY3Rpb24pO1xufTtcblxuQ2luZGVyUHJvZmlsZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5Hcm91cC5wcm90b3R5cGUpO1xuQ2luZGVyUHJvZmlsZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDaW5kZXJQcm9maWxlO1xuXG5DaW5kZXJQcm9maWxlLnByb3RvdHlwZS5nZW5lcmF0ZVByb2ZpbGUgPSBmdW5jdGlvbihkaXJlY3Rpb24pIHtcbiAgLy8gR2VuZXJhdGUgb3IgcmFuZG9tbHkgcGljayBhbHJlYWR5IGdlbmVyYXRlZCBpbWFnZVxuICAvLyBHZW5lcmF0ZSBvciByYW5kb21seSBwaWNrIGFscmVhZHkgZ2VuZXJhdGVkIHByb2ZpbGUgdGV4dFxuICAvLyBHZW5lcmF0ZSByZXN1bHQgb2YgUi9MIHN3aXBlcyBmb3IgdGhpcyBwcm9maWxlXG5cbiAgd2luZG93LkN1cnJlbnRQcm9maWxlSWR4ICs9IDE7XG4gIGlmICh3aW5kb3cuQ3VycmVudFByb2ZpbGVJZHggPT09IHdpbmRvdy5DaW5kZXJQcm9maWxlcy5sZW5ndGgpXG4gICAgd2luZG93LkN1cnJlbnRQcm9maWxlSWR4ID0gMDtcblxuICB0aGlzLnByb2ZpbGUgPSB3aW5kb3cuQ2luZGVyUHJvZmlsZXNbd2luZG93LkN1cnJlbnRQcm9maWxlSWR4XTtcblxuICB2YXIgd2lkdGggPSB0aGlzLmdhbWUud2lkdGg7XG4gIHZhciBjaW5kZXJGcmFtZVcgPSB0aGlzLmdhbWUuY2FjaGUuZ2V0SW1hZ2UoJ2NpbmRlckZyYW1lJykud2lkdGg7XG4gIHZhciBjaW5kZXJGcmFtZUggPSB0aGlzLmdhbWUuY2FjaGUuZ2V0SW1hZ2UoJ2NpbmRlckZyYW1lJykuaGVpZ2h0O1xuICB2YXIgaGVhZGVySCA9IHRoaXMuZ2FtZS5jYWNoZS5nZXRJbWFnZSgnaGVhZGVyJykuaGVpZ2h0O1xuICB2YXIgb2Zmc2V0WCA9ICh3aWR0aCAtIGNpbmRlckZyYW1lVykgLyAyO1xuICB2YXIgb2Zmc2V0WSA9IG9mZnNldFggLyAyO1xuICB2YXIgdGV4dE1hcmdpbiA9IDI1O1xuXG4gIGlmIChkaXJlY3Rpb24gPT09IDEpXG4gICAgdGhpcy54ID0gLXdpZHRoO1xuICBlbHNlXG4gICAgdGhpcy54ID0gd2lkdGggKiAyO1xuXG4gIHRoaXMuaW1hZ2UgPSB0aGlzLmNyZWF0ZShvZmZzZXRYLCBoZWFkZXJIICsgb2Zmc2V0WSwgdGhpcy5wcm9maWxlLmltYWdlKTtcbiAgdGhpcy5mcmFtZSA9IG5ldyBQaGFzZXIuU3ByaXRlKHRoaXMuZ2FtZSwgMCwgMCwgJ2NpbmRlckZyYW1lJyk7XG4gIHRoaXMubmFtZSA9IG5ldyBQaGFzZXIuVGV4dCh0aGlzLmdhbWUsIHRleHRNYXJnaW4sIGNpbmRlckZyYW1lSCAtIHRleHRNYXJnaW4gKiAyLCB0aGlzLnByb2ZpbGUubmFtZSk7XG5cbiAgdGhpcy5pbWFnZS5hZGRDaGlsZCh0aGlzLmZyYW1lKTtcbiAgdGhpcy5pbWFnZS5hZGRDaGlsZCh0aGlzLm5hbWUpO1xuXG4gIHZhciB0d2VlbiA9IHRoaXMuZ2FtZS5hZGQudHdlZW4odGhpcyk7XG4gIHR3ZWVuLnRvKHsgeDogMCB9LCA1MDAsIFBoYXNlci5FYXNpbmcuQ3ViaWMuT3V0LCB0cnVlKTtcbiAgdHdlZW4uc3RhcnQoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ2luZGVyUHJvZmlsZTtcbiIsInZhciBJbnRlcnN0aXRpYWwgPSBmdW5jdGlvbihnYW1lLCBpbnN0cnVjdHMsIHRpbWVvdXQsIGNhbGxiYWNrLCBjdHgpIHtcbiAgUGhhc2VyLkdyb3VwLmNhbGwodGhpcywgZ2FtZSk7XG4gIHRoaXMuZ2FtZSA9IGdhbWU7XG4gIHRoaXMuY3R4ID0gY3R4O1xuICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG5cbiAgdGhpcy51cGRhdGVUaW1lID0gMDtcblxuICB2YXIgeCA9IHRoaXMuZ2FtZS53aWR0aCAvIDI7XG4gIHZhciB5ID0gdGhpcy5nYW1lLmhlaWdodCAvIDI7XG5cbiAgdGhpcy5ibGFja291dCA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICB0aGlzLmN1cnJlbnRGaWxsID0gMHgwMDAwMDA7XG4gIHRoaXMuYmxhY2tvdXQuYmVnaW5GaWxsKHRoaXMuY3VycmVudEZpbGwsIDEpO1xuICB0aGlzLmJsYWNrb3V0LmJvdW5kc1BhZGRpbmcgPSAwO1xuICB0aGlzLmJsYWNrb3V0LmRyYXdSZWN0KDAsIDAsIHRoaXMuZ2FtZS53aWR0aCwgdGhpcy5nYW1lLmhlaWdodCk7XG5cbiAgdGhpcy5tYXRjaCA9IHRoaXMuZ2FtZS5hZGQuaW1hZ2UoMCwgMCwgJ21hdGNoJyk7XG4gIHRoaXMubWF0Y2gueCA9ICh0aGlzLmdhbWUud2lkdGggLyAyKSAtICh0aGlzLm1hdGNoLndpZHRoIC8gMilcbiAgdGhpcy5tYXRjaC55ID0gKHRoaXMuZ2FtZS5oZWlnaHQgLyA0KSAtICh0aGlzLm1hdGNoLmhlaWdodCAvIDIpXG5cbiAgdGhpcy5pbnN0cnVjdCA9IHRoaXMuZ2FtZS5hZGQudGV4dCh4LCB5LCBpbnN0cnVjdHMsIHsgZmlsbDogJyNmZmZmZmYnIH0pO1xuICB0aGlzLmluc3RydWN0LnggLT0gKHRoaXMuaW5zdHJ1Y3Qud2lkdGggLyAyKTtcbiAgdGhpcy5pbnN0cnVjdC55IC09ICh0aGlzLmluc3RydWN0LmhlaWdodCAvIDIpO1xuXG4gIHRoaXMuYWRkKHRoaXMuYmxhY2tvdXQpO1xuICB0aGlzLmFkZCh0aGlzLmluc3RydWN0KTtcblxuICB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKHRpbWVvdXQsIHRoaXMudGVhckRvd24sIHRoaXMpO1xufTtcblxuSW50ZXJzdGl0aWFsLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLkdyb3VwLnByb3RvdHlwZSk7XG5JbnRlcnN0aXRpYWwucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSW50ZXJzdGl0aWFsO1xuXG5JbnRlcnN0aXRpYWwucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnVwZGF0ZVRpbWUgKz0gMTtcblxuICBpZiAodGhpcy51cGRhdGVUaW1lICUgMyA9PT0gMCkge1xuICAgIC8vIG5vIFhPUiBpbiBKUy4uLlxuICAgIHRoaXMuY3VycmVudEZpbGwgPSAhdGhpcy5jdXJyZW50RmlsbCA/IDB4RkZGRkZGIDogMDtcbiAgICB2YXIgdGV4dEZpbGwgPSAhdGhpcy5jdXJyZW50RmlsbCA/ICcjRkZGRkZGJyA6ICcjMDAwMDAwJztcbiAgICB0aGlzLmluc3RydWN0LnNldFN0eWxlKHsnZmlsbCc6IHRleHRGaWxsfSk7XG4gIH1cbn07XG5cbkludGVyc3RpdGlhbC5wcm90b3R5cGUudGVhckRvd24gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5tYXRjaC5raWxsKCk7XG4gIHRoaXMuY2FsbGJhY2suY2FsbCh0aGlzLmN0eCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEludGVyc3RpdGlhbDtcbiIsIi8vVGhpcyBpcyBhIHNwcml0ZSB0aGF0IGlzIGRpc3BsYXllZCBhZnRlciB0aGUgcGxheWVyIGNob29zZXMvcmVqZWN0cyBhIHByb2ZpbGVcbnZhciBQcm9maWxlUmV2ZWFsID0gZnVuY3Rpb24oZ2FtZSwgeCwgeSwgcHJvZmlsZSkge1xuICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgcHJvZmlsZS5yZXZlYWxJbWFnZSk7XG5cbiAgdGhpcy5wcm9maWxlID0gcHJvZmlsZTtcblxuICB2YXIgdGV4dEFyZWEgPSBuZXcgUGhhc2VyLlNwcml0ZShnYW1lLCAwLCB0aGlzLmhlaWdodCwgJ3JldmVhbFRleHRBcmVhJyk7XG5cbiAgdmFyIHRleHQgPSBuZXcgUGhhc2VyLlRleHQoZ2FtZSwgMjUsIHRoaXMuaGVpZ2h0ICsgMjUsIHByb2ZpbGUucmV2ZWFsVGV4dCk7XG5cbiAgdGV4dC54ID0gKHRleHRBcmVhLndpZHRoIC8gMikgLSAodGV4dC53aWR0aCAvIDIpO1xuICB0ZXh0LnkgPSB0ZXh0QXJlYS55ICsgKHRleHRBcmVhLmhlaWdodCAvIDIpIC0gKHRleHQuaGVpZ2h0IC8gMik7XG5cbiAgdGhpcy5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuXG4gIGlmKCEhcHJvZmlsZS5yZXZlYWxJbWFnZTIpIHtcbiAgICBzZXRUaW1lb3V0KGxvYWRTZWNvbmRJbWFnZS5iaW5kKHRoaXMpLCA3MDApO1xuICB9XG5cbiAgdGhpcy5hZGRDaGlsZCh0ZXh0QXJlYSk7XG4gIHRoaXMuYWRkQ2hpbGQodGV4dCk7XG59O1xuXG52YXIgbG9hZFNlY29uZEltYWdlID0gZnVuY3Rpb24oKSB7XG4gIGlmKHRoaXMuZ2FtZSkgdGhpcy5sb2FkVGV4dHVyZSh0aGlzLnByb2ZpbGUucmV2ZWFsSW1hZ2UyKTtcbn07XG5cblByb2ZpbGVSZXZlYWwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XG5Qcm9maWxlUmV2ZWFsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFByb2ZpbGVSZXZlYWw7XG5cbm1vZHVsZS5leHBvcnRzID0gUHJvZmlsZVJldmVhbDtcbiIsInZhciBUaW1lciA9IGZ1bmN0aW9uKGdhbWUsIGJhc2VUaW1lLCBlbmRDYWxsYmFjaywgY3R4LCByZXZlcnNlKSB7XG4gIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCAtNiwgZ2FtZS5oZWlnaHQgLSA4LCAndGltZXItYW5pbWF0aW9uJyk7XG4gIHRoaXMuZ2FtZSA9IGdhbWU7XG5cbiAgdGhpcy5sb25nZXIgPSByZXZlcnNlIHx8IGZhbHNlO1xuXG4gIHRoaXMuYmFzZVRpbWUgPSBiYXNlVGltZTtcbiAgdGhpcy50aW1lciA9IG51bGw7XG4gIHRoaXMudGltZXJUaW1lID0gYmFzZVRpbWUgLSAod2luZG93LlNwZWVkTXVsdGlwbGllciAqIDEwKTtcblxuICBpZiAodGhpcy5sb25nZXIpXG4gICAgdGhpcy50aW1lclRpbWUgKz0gKHdpbmRvdy5TcGVlZE11bHRpcGxpZXIgKiAxMCkgKiAyO1xuXG4gIHRoaXMudGltZURlc3Ryb3llZCA9IGZhbHNlO1xuICB0aGlzLnRpbWVyVHdlZW4gPSBudWxsO1xuXG4gIHRoaXMub25UaW1lclR3ZWVuQ29tcGxldGUgPSBlbmRDYWxsYmFjaztcbiAgdGhpcy5jb250ZXh0ID0gY3R4O1xuXG4gIHRoaXMuc2V0dXAoKTtcbiAgdGhpcy5nYW1lLmFkZC5leGlzdGluZyh0aGlzKTtcbn07XG5cblRpbWVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xuVGltZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVGltZXI7XG5cblRpbWVyLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnRpbWVyRGVzdHJveWVkID0gZmFsc2U7XG4gIHRoaXMudGltZXJUd2Vlbi5zdGFydCgpO1xuICB0aGlzLnRpbWVyID0gdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCh0aGlzLnRpbWVyVGltZSwgZnVuY3Rpb24oKSB7fSk7XG59O1xuXG5UaW1lci5wcm90b3R5cGUuc2V0dXAgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy54ID0gLTY7XG4gIHRoaXMudGltZXJUaW1lID0gdGhpcy5iYXNlVGltZSAtICh3aW5kb3cuU3BlZWRNdWx0aXBsaWVyICogMTApO1xuICBpZiAodGhpcy5sb25nZXIpXG4gICAgdGhpcy50aW1lclRpbWUgKz0gKHdpbmRvdy5TcGVlZE11bHRpcGxpZXIgKiAxMCkgKiAyO1xuXG4gIHRoaXMudGltZURlc3Ryb3llZCA9IGZhbHNlO1xuICB0aGlzLnRpbWVyVHdlZW4gPSB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRoaXMpLnRvKHsgeDogdGhpcy5nYW1lLndpZHRoIH0sIHRoaXMudGltZXJUaW1lKTtcbiAgaWYgKHR5cGVvZiB0aGlzLm9uVGltZXJUd2VlbkNvbXBsZXRlICE9PSBcInVuZGVmaW5lZFwiKVxuICAgIHRoaXMudGltZXJUd2Vlbi5vbkNvbXBsZXRlLmFkZCh0aGlzLm9uVGltZXJUd2VlbkNvbXBsZXRlLmJpbmQodGhpcy5jb250ZXh0KSwgdGhpcyk7XG59O1xuXG5UaW1lci5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24oKSB7XG4gIGlmKCF0aGlzLmdhbWUpIHJldHVybjtcbiAgdGhpcy50aW1lckRlc3Ryb3llZCA9IHRydWU7XG4gIHRoaXMuZ2FtZS50d2VlbnMucmVtb3ZlKHRoaXMudGltZXJUd2Vlbik7XG4gIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5yZW1vdmUodGhpcy50aW1lcik7XG5cbiAgdGhpcy5zZXR1cCgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUaW1lcjtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoNDE0LCA2MDYsIFBoYXNlci5BVVRPLCAnYm9keScpO1xuXG53aW5kb3cuVE9UQUxfR0FNRVMgPSA4O1xuXG53aW5kb3cuVXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG53aW5kb3cuU2NvcmUgPSAwO1xud2luZG93LkxpdmVzID0gODtcbndpbmRvdy5TcGVlZE11bHRpcGxpZXIgPSAxLjA7XG53aW5kb3cuR2FtZXMgPSAwO1xud2luZG93LlBsYXllZEdhbWVzID0gMDtcblxuZ2FtZS5zdGF0ZS5hZGQoJ0Jvb3QnLCByZXF1aXJlKCcuL3N0YXRlcy9ib290JykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ1ByZWxvYWRlcicsIHJlcXVpcmUoJy4vc3RhdGVzL3ByZWxvYWRlcicpKTtcbmdhbWUuc3RhdGUuYWRkKCdTcGxhc2gnLCByZXF1aXJlKCcuL3N0YXRlcy9zcGxhc2gnKSk7XG5nYW1lLnN0YXRlLmFkZCgnQ2xpY2tNZScsIHJlcXVpcmUoJy4vc3RhdGVzL2NsaWNrbWUnKSk7XG5nYW1lLnN0YXRlLmFkZCgnd2FybmluZycsIHJlcXVpcmUoJy4vc3RhdGVzL3dhcm5pbmcnKSk7XG5nYW1lLnN0YXRlLmFkZCgnU0FHRFgnLCByZXF1aXJlKCcuL3N0YXRlcy9zYWdkeCcpKTtcbmdhbWUuc3RhdGUuYWRkKCdNZW51JywgcmVxdWlyZSgnLi9zdGF0ZXMvbWVudScpKTtcbmdhbWUuc3RhdGUuYWRkKCdHYW1lJywgcmVxdWlyZSgnLi9zdGF0ZXMvZ2FtZScpKTtcbmdhbWUuc3RhdGUuYWRkKCdnYW1lb3ZlcicsIHJlcXVpcmUoJy4vc3RhdGVzL2dhbWVvdmVyJykpO1xuXG5nYW1lLnN0YXRlLmFkZCgnQ2luZGVyZWxsYUdhbWUnLCByZXF1aXJlKCcuL3N0YXRlcy9jaW5kZXJlbGxhZ2FtZScpKTtcbmdhbWUuc3RhdGUuYWRkKCdGcm9nR2FtZScsIHJlcXVpcmUoJy4vc3RhdGVzL2Zyb2dnYW1lJykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ01lcm1haWRHYW1lJywgcmVxdWlyZSgnLi9zdGF0ZXMvbWVybWFpZGdhbWUnKSk7XG5nYW1lLnN0YXRlLmFkZCgnRERSR2FtZScsIHJlcXVpcmUoJy4vc3RhdGVzL2RkcmdhbWUnKSk7XG5nYW1lLnN0YXRlLmFkZCgnU25ha2VHYW1lJywgcmVxdWlyZSgnLi9zdGF0ZXMvc25ha2VnYW1lJykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ0N1cEdhbWUnLCByZXF1aXJlKCcuL3N0YXRlcy9jdXBnYW1lJykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ0ZsYXRUYXhHYW1lJywgcmVxdWlyZSgnLi9zdGF0ZXMvZmxhdHRheGdhbWUnKSk7XG5nYW1lLnN0YXRlLmFkZCgnVGhpc0NhdElzSG9yc2VTaGl0JywgcmVxdWlyZSgnLi9zdGF0ZXMvdGhpc2NhdGlzaG9yc2VzaGl0JykpO1xuXG5nYW1lLnN0YXRlLnN0YXJ0KCdCb290Jyk7XG4iLCJ2YXIgQm9vdCA9IGZ1bmN0aW9uICgpIHt9O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEJvb3Q7XG5cbkJvb3QucHJvdG90eXBlID0ge1xuXG4gIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3ByZWxvYWRlcicsICdhc3NldHMvcHJlbG9hZGVyLmdpZicpO1xuICB9LFxuXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZ2FtZS5pbnB1dC5tYXhQb2ludGVycyA9IDE7XG4gICAgdGhpcy5nYW1lLnN0YWdlLmJhY2tncm91bmRDb2xvciA9IDB4ZmZmZmZmO1xuXG4gICAgaWYgKCF0aGlzLmdhbWUuZGV2aWNlLmlQaG9uZSkge1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLnBhZ2VBbGlnbkhvcml6b250YWxseSA9IHRydWU7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUucGFnZUFsaWduVmVydGljYWxseSA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmdhbWUuZGV2aWNlLmRlc2t0b3ApIHtcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluV2lkdGggPSAgMjYwO1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1pbkhlaWdodCA9IDQ4MDtcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5tYXhXaWR0aCA9IDQxNDtcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5tYXhIZWlnaHQgPSA3MzY7XG4gICAgfVxuXG4gICAgdGhpcy5nYW1lLnNjYWxlLnJlZnJlc2goKTtcblxuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnUHJlbG9hZGVyJyk7XG4gIH1cbn07XG4iLCJ2YXIgVGV4dE1hbmFnZXIgPSByZXF1aXJlKCcuLi91dGlsaXRpZXMvVGV4dE1hbmFnZXIuanMnKTtcbnZhciBJbnRlcnN0aXRpYWwgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9JbnRlcnN0aXRpYWwuanMnKTtcbnZhciBUaW1lciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL1RpbWVyLmpzJyk7XG5cbnZhciBDaW5kZXJlbGxhR2FtZSA9IGZ1bmN0aW9uICgpIHtcbn07XG5cbkNpbmRlcmVsbGFHYW1lLnByb3RvdHlwZSA9IHtcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNsaXBwZXJXID0gdGhpcy5nYW1lLmNhY2hlLmdldEltYWdlKCdzbGlwcGVyJykud2lkdGg7XG4gICAgdmFyIHNsaXBwZXJIID0gdGhpcy5nYW1lLmNhY2hlLmdldEltYWdlKCdzbGlwcGVyJykuaGVpZ2h0O1xuXG4gICAgdGhpcy5iYWQgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdiYWQnKTtcbiAgICB0aGlzLmdvb2QgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdnb29kJyk7XG5cbiAgICB0aGlzLlRleHRNYW5hZ2VyID0gbmV3IFRleHRNYW5hZ2VyKHRoaXMuZ2FtZSk7XG4gICAgdGhpcy5UaW1lciA9IG51bGw7XG5cbiAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5vbkRvd24sIHRoaXMpO1xuICAgIHRoaXMuZ2FtZS5hZGQuc3ByaXRlKDAsIDEyMCwgJ2Zvb3QnKTtcbiAgICB0aGlzLnNsaXBwZXIgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSh0aGlzLmdhbWUud2lkdGggLSBzbGlwcGVyVyArIDIwLCBzbGlwcGVySCwgJ3NsaXBwZXInKTtcbiAgICB0aGlzLm1vdmVtZW50ID0gMi4zICogd2luZG93LlNwZWVkTXVsdGlwbGllcjtcbiAgICB0aGlzLnJlYWR5ID0gZmFsc2U7XG5cbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgdGhpcy5pbnRlciA9IG5ldyBJbnRlcnN0aXRpYWwodGhpcy5nYW1lLCBcIkdFVCBUSEUgRk9PVFwiLCAxNTAwLCBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuaW50ZXIuZGVzdHJveSgpO1xuICAgICAgdGhpcy5yZWFkeSA9IHRydWU7XG4gICAgICB0aGlzLlRpbWVyID0gbmV3IFRpbWVyKHRoaXMuZ2FtZSwgMjUwMCwgdGhpcy5vblRpbWVyQ29tcGxldGUsIHRoaXMpO1xuICAgICAgdGhpcy5UaW1lci5zdGFydCgpO1xuICAgIH0sIHRoaXMpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5yZWFkeSlcbiAgICAgIHJldHVybjtcblxuICAgIHRoaXMuc2xpcHBlci55ICs9IHRoaXMubW92ZW1lbnQ7XG5cbiAgICBpZiAodGhpcy5zbGlwcGVyLnkgPiB0aGlzLmdhbWUuaGVpZ2h0IC0gdGhpcy5zbGlwcGVyLmhlaWdodClcbiAgICAgIHRoaXMubW92ZW1lbnQgKj0gLTE7XG4gICAgaWYgKHRoaXMuc2xpcHBlci55IDwgdGhpcy5zbGlwcGVyLmhlaWdodClcbiAgICAgIHRoaXMubW92ZW1lbnQgKj0gLTE7XG4gIH0sXG5cbiAgb25UaW1lckNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5sb3NlKCk7XG4gIH0sXG5cbiAgbG9zZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYmFkLnBsYXkoKTtcbiAgICB0aGlzLnJlYWR5ID0gZmFsc2U7XG4gICAgd2luZG93LlNjb3JlIC09IDEwMDtcbiAgICB3aW5kb3cuTGl2ZXMgLT0gMjtcbiAgICB0aGlzLlRleHRNYW5hZ2VyLnN0YXR1c1RleHQoXCJMT1NFIVwiKTtcbiAgICB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKDQwMDAsIHRoaXMuZW5kLCB0aGlzKTtcbiAgfSxcblxuICB3aW46IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmdvb2QucGxheSgpO1xuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICB3aW5kb3cuU3BlZWRNdWx0aXBsaWVyICs9IDAuNTtcbiAgICB3aW5kb3cuU2NvcmUgKz0gMTAwO1xuICAgIHRoaXMuVGV4dE1hbmFnZXIuc3RhdHVzVGV4dChcIldJTiFcIik7XG4gICAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCg0MDAwLCB0aGlzLmVuZCwgdGhpcyk7XG4gIH0sXG5cbiAgb25Eb3duOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnJlYWR5KVxuICAgICAgcmV0dXJuO1xuXG4gICAgdGhpcy5UaW1lci5lbmQoKTtcblxuICAgIHRoaXMuc2xpcHBlci54IC09IDIwO1xuICAgIGlmICh0aGlzLnNsaXBwZXIueSA+IDI2MCAmJiB0aGlzLnNsaXBwZXIueSA8IDMwNSkge1xuICAgICAgdGhpcy53aW4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5sb3NlKCk7XG4gICAgfVxuICB9LFxuXG4gIGVuZDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ2luZGVyZWxsYUdhbWU7XG4iLCJ2YXIgQ2xpY2tNZSA9IGZ1bmN0aW9uICgpIHtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ2xpY2tNZTtcblxuQ2xpY2tNZS5wcm90b3R5cGUgPSB7XG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZ2FtZS5zdGFnZS5iYWNrZ3JvdW5kQ29sb3IgPSAnI2ZmZmZmZic7XG5cbiAgICB2YXIgc3RhcnRUZXh0ID0gXCJQcmVzcyB0byBzdGFydCFcIjtcbiAgICB2YXIgdGV4dFByb3BzID0geyBmb250OiAnMjRwdCBBcmlhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgZmlsbDogJyNDMjQzMDAnLFxuICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVRoaWNrbmVzczogMCB9O1xuXG4gICAgdmFyIHRleHQgPSB0aGlzLmdhbWUuYWRkLnRleHQoMCwgMCwgc3RhcnRUZXh0LCB0ZXh0UHJvcHMpO1xuXG4gICAgdGV4dC54ID0gKHRoaXMuZ2FtZS53aWR0aCAvIDIpIC0gKHRleHQud2lkdGggLyAyKTtcbiAgICB0ZXh0LnkgPSAodGhpcy5nYW1lLmhlaWdodCAvIDIpIC0gKHRleHQuaGVpZ2h0IC8gMik7XG5cbiAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5vbkRvd24sIHRoaXMpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICB9LFxuXG4gIG9uRG93bjogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUuZnVsbFNjcmVlblNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc3RhcnRGdWxsU2NyZWVuKHRydWUpO1xuICAgIH1cblxuICAgIHRoaXMuc3RhcnRHYW1lKCk7XG4gIH0sXG5cbiAgc3RhcnRHYW1lOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB7XG4gICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ3dhcm5pbmcnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdTQUdEWCcpO1xuICAgIH1cbiAgfVxufTtcbiIsInZhciBUZXh0TWFuYWdlciA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9UZXh0TWFuYWdlci5qcycpO1xudmFyIEludGVyc3RpdGlhbCA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL0ludGVyc3RpdGlhbC5qcycpO1xudmFyIFRpbWVyID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvVGltZXIuanMnKTtcblxudmFyIEJBU0VfQ1VQX1NXQVBTID0gNDtcbnZhciBDVVBfWCA9IDEwMDtcblxudmFyIEN1cCA9IGZ1bmN0aW9uKGdhbWUsIHgsIHksIGRydWdnZWQpIHtcbiAgUGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWUsIHgsIHksICdjdXAnKTtcblxuICB0aGlzLmRydWdnZWQgPSBkcnVnZ2VkO1xufVxuXG5DdXAucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XG5DdXAucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ3VwO1xuXG52YXIgQ3VwR2FtZSA9IGZ1bmN0aW9uICgpIHtcbn07XG5cbkN1cEdhbWUucHJvdG90eXBlID0ge1xuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuYm9vID0gdGhpcy5nYW1lLmFkZC5hdWRpbygnYm9vJyk7XG5cbiAgICB2YXIgc3RhdGUgPSB0aGlzO1xuICAgIGlmICghdGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5nb0Z1bGxzY3JlZW4sIHRoaXMpO1xuXG4gICAgdGhpcy5UZXh0TWFuYWdlciA9IG5ldyBUZXh0TWFuYWdlcih0aGlzLmdhbWUpO1xuXG4gICAgdGhpcy5iYWQgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdiYWQnKTtcbiAgICB0aGlzLmdvb2QgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdnb29kJyk7XG5cbiAgICB0aGlzLnJlYWR5ID0gZmFsc2U7XG5cbiAgICB0aGlzLmJhY2tncm91bmQgPSB0aGlzLmdhbWUuYWRkLmltYWdlKDAsIDAsICdjb3NieUJnJyk7XG5cbiAgICB0aGlzLmN1cHMgPSB0aGlzLmdhbWUuYWRkLmdyb3VwKCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgIHZhciBjdXAgPSB0aGlzLmdhbWUuYWRkLmV4aXN0aW5nKG5ldyBDdXAodGhpcy5nYW1lLCBDVVBfWCwgMjAgKyBpICogMTIwLCBmYWxzZSkpO1xuICAgICAgdGhpcy5jdXBzLmFkZChjdXApO1xuICAgIH1cblxuICAgIHRoaXMuY3VwU3dhcHMgPSBCQVNFX0NVUF9TV0FQUyAqIE1hdGguZmxvb3Iod2luZG93LlNwZWVkTXVsdGlwbGllcik7XG5cbiAgICB0aGlzLlRpbWVVcCA9IG5ldyBUaW1lcih0aGlzLmdhbWUsIDEwMDAwLCB0aGlzLm9uVGltZVVwLCB0aGlzKTtcblxuICAgIHRoaXMuaW50ZXIgPSBuZXcgSW50ZXJzdGl0aWFsKHRoaXMuZ2FtZSwgXCJaSVAgWk9QIFpPT0JJVFkgQk9QXCIsIDE1MDAsIGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5pbnRlci5kZXN0cm95KCk7XG5cbiAgICAgIHRoaXMuZHJ1Z0N1cHMoZnVuY3Rpb24oKSB7XG4gICAgICAgIHN0YXRlLnNjcmFtYmxlQ3VwcyhzdGF0ZS5jdXBTd2FwcywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgc3RhdGUucmVhZHkgPSB0cnVlO1xuICAgICAgICAgIHN0YXRlLlRpbWVVcC5zdGFydCgpO1xuICAgICAgICAgIHN0YXRlLmN1cFNlbGVjdGlvbigpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgfSwgdGhpcyk7XG5cbiAgfSxcblxuICBnb0Z1bGxzY3JlZW46IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmdhbWUuc2NhbGUuaXNGdWxsU2NyZWVuKSByZXR1cm47XG4gICAgdGhpcy5nYW1lLnNjYWxlLmZ1bGxTY3JlZW5TY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuICAgIHRoaXMuZ2FtZS5zY2FsZS5zdGFydEZ1bGxTY3JlZW4odHJ1ZSk7XG4gIH0sXG5cbiAgb25UaW1lVXA6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmxvc2UoKTtcbiAgfSxcblxuICBsb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5iYWQucGxheSgpO1xuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICB3aW5kb3cuU2NvcmUgLT0gMTAwO1xuICAgIHdpbmRvdy5MaXZlcyAtPSAyO1xuICAgIHRoaXMuVGV4dE1hbmFnZXIuc3RhdHVzVGV4dChcIkxPU0UhXCIpO1xuICAgIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoMjAwMCwgdGhpcy5lbmQsIHRoaXMpO1xuICB9LFxuXG4gIHdpbjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZ29vZC5wbGF5KCk7XG4gICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuICAgIHdpbmRvdy5TcGVlZE11bHRpcGxpZXIgKz0gMC41O1xuICAgIHdpbmRvdy5TY29yZSArPSAxMDA7XG4gICAgdGhpcy5UZXh0TWFuYWdlci5zdGF0dXNUZXh0KFwiV0lOIVwiKTtcbiAgICB0aGlzLlRpbWVVcC5lbmQoKTtcbiAgICB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKDIwMDAsIHRoaXMuZW5kLCB0aGlzKTtcbiAgfSxcblxuICBlbmQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnR2FtZScpO1xuICAgIHRoaXMuZ2FtZS5zdGFnZS5iYWNrZ3JvdW5kQ29sb3IgPSAnI0ZGRkZGRic7XG4gIH0sXG5cbiAgc2NyYW1ibGVDdXBzOiBmdW5jdGlvbihzd2Fwc1JlbWFpbmluZywgY2FsbGJhY2spIHtcbiAgICB2YXIgY3VwSW5kZXhlcyA9IHRoaXMudHdvUmFuZG9tQ3VwSW5kZXhlcygpO1xuICAgIFxuICAgIHRoaXMuc3dhcEN1cHMoY3VwSW5kZXhlc1swXSwgY3VwSW5kZXhlc1sxXSwgKGZ1bmN0aW9uKCkge1xuICAgICAgaWYoIXN3YXBzUmVtYWluaW5nKSB7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzd2Fwc1JlbWFpbmluZyAtPSAxO1xuICAgICAgICB0aGlzLnNjcmFtYmxlQ3Vwcyhzd2Fwc1JlbWFpbmluZywgY2FsbGJhY2spO1xuICAgICAgfVxuICAgIH0pLmJpbmQodGhpcykpO1xuICB9LFxuXG4gIHN3YXBDdXBzOiBmdW5jdGlvbihpbmRleDEsIGluZGV4MiwgY2FsbGJhY2spIHtcbiAgICB2YXIgY3VwMSA9IHRoaXMuY3Vwcy5jaGlsZHJlbltpbmRleDFdO1xuICAgIHZhciBjdXAyID0gdGhpcy5jdXBzLmNoaWxkcmVuW2luZGV4Ml07XG5cbiAgICB2YXIgeUNvb3JkID0gY3VwMS55ICsgKGN1cDIueSAtIGN1cDEueSlcbiAgICB2YXIgbGVmdFggPSAwIC0gdGhpcy5nYW1lLndpZHRoIC8gMztcbiAgICB2YXIgcmlnaHRYID0gdGhpcy5nYW1lLndpZHRoIC0gY3VwMS53aWR0aCArIHRoaXMuZ2FtZS53aWR0aCAvIDM7XG5cbiAgICB2YXIgdGltZSA9IDIwMCArICg1MDAgLyB3aW5kb3cuU3BlZWRNdWx0aXBsaWVyKTtcblxuICAgIC8vIHR3ZWVuIHRoZSBvYmplY3QgZG93biBpbiBhIGxpbmVhciBmYXNoaW9uXG4gICAgdGhpcy5nYW1lLmFkZC50d2VlbihjdXAxKS50byh7eTogY3VwMi55IH0sIHRpbWUpLnN0YXJ0KCk7XG4gICAgdGhpcy5nYW1lLmFkZC50d2VlbihjdXAyKS50byh7eTogY3VwMS55IH0sIHRpbWUpLnN0YXJ0KCk7XG5cbiAgICB2YXIgY3VwMVR3ZWVuID0gdGhpcy5nYW1lLmFkZC50d2VlbihjdXAxKVxuICAgICAgLnRvKHt4OiBsZWZ0WH0sIHRpbWUgKiAwLjUsIFBoYXNlci5FYXNpbmcuU2ludXNvaWRhbC5PdXQpLnN0YXJ0KCk7XG5cbiAgICBjdXAxVHdlZW4ub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLnN3YXBDdXBEaXNwbGF5T3JkZXIoaW5kZXgxLCBpbmRleDIpO1xuICAgICAgdGhpcy5nYW1lLmFkZC50d2VlbihjdXAxKVxuICAgICAgICAudG8oe3g6IENVUF9YfSwgdGltZSAqIDAuNSwgUGhhc2VyLkVhc2luZy5TaW51c29pZGFsLkluKS5zdGFydCgpO1xuICAgIH0sIHRoaXMpO1xuXG4gICAgdmFyIGN1cDJUd2VlbiA9IHRoaXMuZ2FtZS5hZGQudHdlZW4oY3VwMilcbiAgICAgIC50byh7eDogcmlnaHRYfSwgdGltZSAvIDIsIFBoYXNlci5FYXNpbmcuU2ludXNvaWRhbC5PdXQpXG4gICAgICAudG8oe3g6IENVUF9YfSwgdGltZSAvIDIsIFBoYXNlci5FYXNpbmcuU2ludXNvaWRhbC5JbilcbiAgICAgIC5zdGFydCgpO1xuXG4gICAgY3VwMlR3ZWVuLm9uQ29tcGxldGUuYWRkKGNhbGxiYWNrLCB0aGlzKTtcbiAgfSxcblxuICB0d29SYW5kb21DdXBJbmRleGVzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgcmFuZHMgPSBbMCwgMF07XG5cbiAgICB3aGlsZShyYW5kc1swXSA9PSByYW5kc1sxXSkge1xuICAgICAgcmFuZHNbMF0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKTtcbiAgICAgIHJhbmRzWzFdID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyk7XG4gICAgfVxuXG4gICAgcmFuZHMuc29ydCgpO1xuXG4gICAgcmV0dXJuIFtyYW5kc1swXSwgcmFuZHNbMV1dO1xuICB9LFxuXG4gIHN3YXBDdXBEaXNwbGF5T3JkZXI6IGZ1bmN0aW9uKGluZGV4MSwgaW5kZXgyKSB7XG4gICAgdmFyIHRtcCA9IHRoaXMuY3Vwcy5jaGlsZHJlbltpbmRleDFdO1xuICAgIHRoaXMuY3Vwcy5jaGlsZHJlbltpbmRleDFdID0gdGhpcy5jdXBzLmNoaWxkcmVuW2luZGV4Ml07XG4gICAgdGhpcy5jdXBzLmNoaWxkcmVuW2luZGV4Ml0gPSB0bXA7XG4gIH0sXG5cbiAgZHJ1Z0N1cHM6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgdmFyIHN0YXRlID0gdGhpcztcbiAgICB2YXIgaW5kZXhlcyA9IHRoaXMudHdvUmFuZG9tQ3VwSW5kZXhlcygpO1xuICAgIHZhciBjdXAxID0gdGhpcy5jdXBzLmNoaWxkcmVuW2luZGV4ZXNbMF1dO1xuICAgIHZhciBjdXAyID0gdGhpcy5jdXBzLmNoaWxkcmVuW2luZGV4ZXNbMV1dO1xuXG4gICAgdGhpcy5kcnVnQW5pbWF0aW9uKGN1cDEsIGZ1bmN0aW9uKCkge1xuICAgICAgc3RhdGUuZHJ1Z0FuaW1hdGlvbihjdXAyLCBmdW5jdGlvbigpIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LFxuXG4gIGRydWdBbmltYXRpb246IGZ1bmN0aW9uKGN1cCwgY2FsbGJhY2spIHtcbiAgICB2YXIgc3RhdGUgPSB0aGlzO1xuXG4gICAgdmFyIHBpbGwgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSh0aGlzLmdhbWUud2lkdGggLyAyLCAtNTAsICdwaWxsJyk7XG4gICAgcGlsbC5hbmltYXRpb25zLmFkZCgnZmxpcCcpO1xuICAgIHBpbGwuYW5pbWF0aW9ucy5wbGF5KCdmbGlwJywgMTAsIHRydWUpO1xuXG4gICAgdmFyIHBpbGxUd2VlbiA9IHRoaXMuZ2FtZS5hZGQudHdlZW4ocGlsbCkudG8oe3k6IGN1cC55ICsgMjUgfSwgNTAwKS5zdGFydCgpO1xuICAgIHBpbGxUd2Vlbi5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbigpIHtcbiAgICAgIGN1cC5kcnVnZ2VkID0gdHJ1ZTtcbiAgICAgIHRoaXMuYm9vLnBsYXkoKTtcbiAgICAgIHRoaXMuc3BsYXNoQW5pbWF0aW9uKHBpbGwsIGNhbGxiYWNrKTtcbiAgICB9LCB0aGlzKTtcbiAgfSxcblxuICBzcGxhc2hBbmltYXRpb246IGZ1bmN0aW9uKHBpbGwsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgc3BsYXNoID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUoMCwgMCwgJ3NwbGFzaCcpO1xuXG4gICAgICBzcGxhc2gueCA9IChwaWxsLnggKyBwaWxsLndpZHRoIC8gMikgLSBzcGxhc2gud2lkdGggLyAyXG4gICAgICBzcGxhc2gueSA9IChwaWxsLnkgKyBwaWxsLmhlaWdodCAvIDIpIC0gc3BsYXNoLmhlaWdodCAvIDJcblxuICAgICAgdmFyIGFuaW0gPSBzcGxhc2guYW5pbWF0aW9ucy5hZGQoJ3NwbGFzaCcpO1xuXG4gICAgICBhbmltLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uKCkge1xuICAgICAgICBzcGxhc2gua2lsbCgpO1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfSk7XG5cbiAgICAgIGFuaW0ucGxheSgxMCk7XG4gICAgICBwaWxsLmtpbGwoKTtcbiAgfSxcblxuICBjdXBTZWxlY3Rpb246IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHN0YXRlID0gdGhpcztcbiAgICB2YXIgY3VwcyA9IHRoaXMuY3Vwcy5jaGlsZHJlbjtcblxuICAgIGZvcihpIGluIGN1cHMpIHtcbiAgICAgIChmdW5jdGlvbihjdXApIHtcbiAgICAgICAgY3VwLmV2ZW50cy5vbklucHV0RG93bi5hZGQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYoIXN0YXRlLnJlYWR5KSByZXR1cm47XG4gICAgICAgICAgaWYoY3VwLmRydWdnZWQpIHJldHVybiBzdGF0ZS5sb3NlKCk7XG4gICAgICAgICAgcmV0dXJuIHN0YXRlLndpbigpO1xuICAgICAgICB9LCBzdGF0ZSk7XG5cbiAgICAgICAgY3VwLmlucHV0RW5hYmxlZCA9IHRydWU7XG4gICAgICB9KShjdXBzW2ldKTtcbiAgICB9XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ3VwR2FtZTtcbiIsInZhciBUZXh0TWFuYWdlciA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9UZXh0TWFuYWdlci5qcycpO1xudmFyIFN3aXBlTWFuYWdlciA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9Td2lwZU1hbmFnZXIuanMnKTtcbnZhciBJbnRlcnN0aXRpYWwgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9JbnRlcnN0aXRpYWwuanMnKTtcbnZhciBUaW1lciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL1RpbWVyLmpzJyk7XG5cbnZhciBERFJHYW1lID0gZnVuY3Rpb24gKCkge1xufTtcblxudmFyIFJFUVVJUkVEX0hJVF9QRVJDRU5UQUdFID0gLjc1O1xuXG5ERFJHYW1lLnByb3RvdHlwZSA9IHtcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5iYWQgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdiYWQnKTtcbiAgICB0aGlzLmdvb2QgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdnb29kJyk7XG5cbiAgICB0aGlzLnlheSA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ3lheScpO1xuICAgIHRoaXMuYm9vID0gdGhpcy5nYW1lLmFkZC5hdWRpbygnYm9vJyk7XG5cbiAgICB0aGlzLnJlYWR5ID0gZmFsc2U7XG4gICAgdGhpcy5UaW1lciA9IG51bGw7XG4gICAgdGhpcy5UZXh0TWFuYWdlciA9IG5ldyBUZXh0TWFuYWdlcih0aGlzLmdhbWUpO1xuXG4gICAgdGhpcy5nYW1lLnN0YWdlLmJhY2tncm91bmRDb2xvciA9IFwiIzAwMDAwMFwiO1xuXG4gICAgdGhpcy5za2VsbHkgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSg1MCwgMTAwLCAnc2tlbGx5Jyk7XG4gICAgdGhpcy5za2VsbHkuYW5pbWF0aW9ucy5hZGQoJ2RhbmNlJyk7XG4gICAgdGhpcy5za2VsbHkuYW5pbWF0aW9ucy5wbGF5KCdkYW5jZScsIDEuMiAqIHdpbmRvdy5TcGVlZE11bHRpcGxpZXIsIHRydWUpO1xuXG4gICAgdGhpcy5nYW1lLnBsdWdpbnMuYWRkKG5ldyBTd2lwZU1hbmFnZXIodGhpcy5nYW1lLCB0aGlzLnN3aXBlLCB0aGlzLCB0cnVlKSk7XG5cbiAgICB2YXIgd2lkdGggPSB0aGlzLmdhbWUuY2FjaGUuZ2V0SW1hZ2UoJ3VwLWFycm93Jykud2lkdGggLyA0O1xuICAgIHZhciBoZWlnaHQgPSB0aGlzLmdhbWUuY2FjaGUuZ2V0SW1hZ2UoJ3VwLWFycm93JykuaGVpZ2h0O1xuICAgIHZhciBwYWRkaW5nID0gTWF0aC5mbG9vcigodGhpcy5nYW1lLnN0YWdlLndpZHRoIC0gKHdpZHRoICogMiArIGhlaWdodCAqIDIpKSAvIDUpO1xuXG4gICAgdGhpcy51cCA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKHBhZGRpbmcsIHRoaXMudG9wUGFkZGluZywgJ3VwLWFycm93Jyk7XG4gICAgdGhpcy51cC5hbmltYXRpb25zLmFkZCgnYmx1ZXMnKTtcbiAgICB0aGlzLnVwLmFuaW1hdGlvbnMucGxheSgnYmx1ZXMnLCAxMCwgdHJ1ZSk7XG4gICAgdGhpcy5kb3duID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUocGFkZGluZyAqIDIgKyB3aWR0aCwgdGhpcy50b3BQYWRkaW5nLCAnZG93bi1hcnJvdycpO1xuICAgIHRoaXMuZG93bi5hbmltYXRpb25zLmFkZCgncmVkcycpO1xuICAgIHRoaXMuZG93bi5hbmltYXRpb25zLnBsYXkoJ3JlZHMnLCAxMCwgdHJ1ZSk7XG5cbiAgICB0aGlzLmxlZnQgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZShwYWRkaW5nICogMyArIHdpZHRoICogMiwgaGVpZ2h0IC8gMiAtIDIwLCAnbGVmdC1hcnJvdycpO1xuICAgIHRoaXMubGVmdC5hbmltYXRpb25zLmFkZCgnZ3JlZW5zJyk7XG4gICAgdGhpcy5sZWZ0LmFuaW1hdGlvbnMucGxheSgnZ3JlZW5zJywgMTAsIHRydWUpO1xuICAgIHRoaXMucmlnaHQgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZShwYWRkaW5nICogNCArIHdpZHRoICogMiArIGhlaWdodCwgaGVpZ2h0IC8gMiAtIDIwLCAncmlnaHQtYXJyb3cnKTtcbiAgICB0aGlzLnJpZ2h0LmFuaW1hdGlvbnMuYWRkKCdvcmFuZ2VzJyk7XG4gICAgdGhpcy5yaWdodC5hbmltYXRpb25zLnBsYXkoJ29yYW5nZXMnLCAxMCwgdHJ1ZSk7XG5cbiAgICB0aGlzLmFycm93U3BlZWQgPSAzICogd2luZG93LlNwZWVkTXVsdGlwbGllcjtcbiAgICB0aGlzLmFycm93cyA9IFtdO1xuICAgIHRoaXMuYXJyb3dDb29sZG93biA9IDU1O1xuICAgIHRoaXMuY29vbGRvd24gPSAwO1xuICAgIHRoaXMub25Db29sZG93biA9IGZhbHNlO1xuXG4gICAgdGhpcy5oaXRzID0gMDtcbiAgICB0aGlzLmFycm93Q291bnQgPSAwO1xuXG4gICAgdGhpcy5lbWl0dGVyID0gdGhpcy5nYW1lLmFkZC5lbWl0dGVyKDAsIDAsIDEwMCk7XG4gICAgdGhpcy5lbWl0dGVyLm1ha2VQYXJ0aWNsZXMoJ3NwYXJrJyk7XG5cbiAgICB0aGlzLmludGVyID0gbmV3IEludGVyc3RpdGlhbCh0aGlzLmdhbWUsIFwiREFOQ0UgT0ZGXCIsIDE1MDAsIGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5pbnRlci5kZXN0cm95KCk7XG4gICAgICB0aGlzLlRpbWVyID0gbmV3IFRpbWVyKHRoaXMuZ2FtZSwgNjUwMCwgdGhpcy5vblRpbWVyQ29tcGxldGUsIHRoaXMsIHRydWUpO1xuICAgICAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCgxNTAwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5UaW1lci5zdGFydCgpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcbiAgICB9LCB0aGlzKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMucmVhZHkpXG4gICAgICByZXR1cm47XG5cbiAgICB2YXIgcmVtb3ZlSWR4ID0gLTE7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYXJyb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgYXJyb3cgPSB0aGlzLmFycm93c1tpXTtcblxuICAgICAgaWYgKCgoYXJyb3cuZGlyID09PSAzIHx8IGFycm93LmRpciA9PT0gMikgJiYgYXJyb3cueSA8PSB0aGlzLnVwLnkpIHx8XG4gICAgICAgICAgKChhcnJvdy5kaXIgPT09IDEgfHwgYXJyb3cuZGlyID09IDApICYmIGFycm93LnkgPD0gdGhpcy5yaWdodC55KSkge1xuICAgICAgICByZW1vdmVJZHggPSBpO1xuICAgICAgICB0aGlzLmFycm93Q291bnQgKz0gMTtcbiAgICAgICAgYXJyb3cuZGVzdHJveSgpO1xuICAgICAgfVxuICAgICAgZWxzZVxuICAgICAgICBhcnJvdy55IC09IHRoaXMuYXJyb3dTcGVlZDtcbiAgICB9XG5cbiAgICBpZiAocmVtb3ZlSWR4ID49IDApIHRoaXMuYXJyb3dzLnNwbGljZShyZW1vdmVJZHgsIDEpO1xuXG4gICAgaWYgKHRoaXMuYXJyb3dDb29sZG93biA9PT0gdGhpcy5jb29sZG93bikge1xuICAgICAgdGhpcy5vbkNvb2xkb3duID0gZmFsc2U7XG4gICAgICB0aGlzLmNvb2xkb3duID0gMDtcbiAgICB9XG4gICAgaWYgKHRoaXMub25Db29sZG93bilcbiAgICAgIHRoaXMuY29vbGRvd24gKz0gMTtcblxuICAgIGlmICghdGhpcy5vbkNvb2xkb3duKSB7XG4gICAgICB2YXIgc3Bhd24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCkgKyAxID4gNjtcbiAgICAgIGlmIChzcGF3bikge1xuICAgICAgICB2YXIgZGlyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNCk7XG4gICAgICAgIHZhciBhcnJvdyA9IG51bGw7XG5cbiAgICAgICAgc3dpdGNoKGRpcikge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgYXJyb3cgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSh0aGlzLmxlZnQueCwgdGhpcy5nYW1lLmhlaWdodCArIHRoaXMubGVmdC5oZWlnaHQsICdsZWZ0LWFycm93Jyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBhcnJvdyA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKHRoaXMucmlnaHQueCwgdGhpcy5nYW1lLmhlaWdodCArIHRoaXMubGVmdC5oZWlnaHQsICdyaWdodC1hcnJvdycpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgYXJyb3cgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSh0aGlzLnVwLngsIHRoaXMuZ2FtZS5oZWlnaHQgKyB0aGlzLnVwLmhlaWdodCwgJ3VwLWFycm93Jyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBhcnJvdyA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKHRoaXMuZG93bi54LCB0aGlzLmdhbWUuaGVpZ2h0ICsgdGhpcy5kb3duLmhlaWdodCwgJ2Rvd24tYXJyb3cnKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGFycm93LmFuaW1hdGlvbnMuYWRkKCdhbmltJyk7XG4gICAgICAgIGFycm93LmFuaW1hdGlvbnMucGxheSgnYW5pbScsIDEwLCB0cnVlKTtcbiAgICAgICAgYXJyb3cuZGlyID0gZGlyO1xuICAgICAgICB0aGlzLmFycm93cy5wdXNoKGFycm93KTtcbiAgICAgICAgdGhpcy5vbkNvb2xkb3duID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgb25UaW1lckNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuaGl0cyA+IHRoaXMuYXJyb3dDb3VudCAqIFJFUVVJUkVEX0hJVF9QRVJDRU5UQUdFKVxuICAgICAgdGhpcy53aW4oKTtcbiAgICBlbHNlXG4gICAgICB0aGlzLmxvc2UoKTtcbiAgfSxcblxuICBsb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5iYWQucGxheSgpO1xuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICB3aW5kb3cuU2NvcmUgLT0gMTAwO1xuICAgIHdpbmRvdy5MaXZlcyAtPSAyO1xuICAgIHRoaXMuVGV4dE1hbmFnZXIuc3RhdHVzVGV4dChcIkxPU0UhXCIpO1xuICAgIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoNDAwMCwgdGhpcy5lbmQsIHRoaXMpO1xuICB9LFxuXG4gIHdpbjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZ29vZC5wbGF5KCk7XG4gICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuICAgIHdpbmRvdy5TcGVlZE11bHRpcGxpZXIgKz0gMC41O1xuICAgIHdpbmRvdy5TY29yZSArPSAxMDA7XG4gICAgdGhpcy5UZXh0TWFuYWdlci5zdGF0dXNUZXh0KFwiV0lOIVwiKTtcbiAgICB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKDQwMDAsIHRoaXMuZW5kLCB0aGlzKTtcbiAgfSxcblxuICBzd2lwZTogZnVuY3Rpb24gKGRpcikge1xuICAgIHZhciBoaXQgPSBmYWxzZTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5hcnJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBhcnJvdyA9IHRoaXMuYXJyb3dzW2ldO1xuICAgICAgaWYgKGFycm93LnkgPD0gdGhpcy51cC55ICsgdGhpcy51cC5oZWlnaHQpIHtcbiAgICAgICAgaWYgKGFycm93LmRpciA9PT0gZGlyKSB7XG4gICAgICAgICAgaGl0ID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLmhpdHMgKz0gMTtcbiAgICAgICAgICB0aGlzLnlheS5wbGF5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaGl0ID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5oaXRzIC09IDE7XG4gICAgICAgICAgdGhpcy5ib28ucGxheSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGhpdCkge1xuICAgICAgICAgIHN3aXRjaCAoZGlyKSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgdGhpcy5lbWl0dGVyLnggPSB0aGlzLmxlZnQueCArIHRoaXMubGVmdC53aWR0aCAvIDI7XG4gICAgICAgICAgICB0aGlzLmVtaXR0ZXIueSA9IHRoaXMubGVmdC55ICsgdGhpcy5sZWZ0LmhlaWdodCAvIDI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICB0aGlzLmVtaXR0ZXIueCA9IHRoaXMucmlnaHQueCArIHRoaXMucmlnaHQud2lkdGggLyAyO1xuICAgICAgICAgICAgdGhpcy5lbWl0dGVyLnkgPSB0aGlzLnJpZ2h0LnkgKyB0aGlzLnJpZ2h0LmhlaWdodCAvIDI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICB0aGlzLmVtaXR0ZXIueCA9IHRoaXMudXAueCArIHRoaXMudXAud2lkdGggLyAyO1xuICAgICAgICAgICAgdGhpcy5lbWl0dGVyLnkgPSB0aGlzLnVwLnkgKyB0aGlzLnVwLmhlaWdodCAvIDI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICB0aGlzLmVtaXR0ZXIueCA9IHRoaXMuZG93bi54ICsgdGhpcy5kb3duLndpZHRoIC8gMjtcbiAgICAgICAgICAgIHRoaXMuZW1pdHRlci55ID0gdGhpcy5kb3duLnkgKyB0aGlzLmRvd24uaGVpZ2h0IC8gMjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmVtaXR0ZXIuc3RhcnQodHJ1ZSwgMTAwMCwgbnVsbCwgMTApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgc3dpdGNoIChkaXIpIHtcbiAgICBjYXNlIDA6XG4gICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0aGlzLmxlZnQuc2NhbGUpXG4gICAgICAgIC50byh7IHg6IDEuMiwgeTogMS4yIH0sIDEwMCwgUGhhc2VyLkVhc2luZy5MaW5lYXIuTm9uZSwgdHJ1ZSwgMCwgMCwgdHJ1ZSk7XG4gICAgYnJlYWs7XG4gICAgY2FzZSAxOlxuICAgIHRoaXMuZ2FtZS5hZGQudHdlZW4odGhpcy5yaWdodC5zY2FsZSlcbiAgICAgICAgLnRvKHsgeDogMS4yLCB5OiAxLjIgfSwgMTAwLCBQaGFzZXIuRWFzaW5nLkxpbmVhci5Ob25lLCB0cnVlLCAwLCAwLCB0cnVlKTtcbiAgICBicmVhaztcbiAgICBjYXNlIDI6XG4gICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0aGlzLnVwLnNjYWxlKVxuICAgICAgICAudG8oeyB4OiAxLjIsIHk6IDEuMiB9LCAxMDAsIFBoYXNlci5FYXNpbmcuTGluZWFyLk5vbmUsIHRydWUsIDAsIDAsIHRydWUpO1xuICAgIGJyZWFrO1xuICAgIGNhc2UgMzpcbiAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRoaXMuZG93bi5zY2FsZSlcbiAgICAgICAgLnRvKHsgeDogMS4yLCB5OiAxLjIgfSwgMTAwLCBQaGFzZXIuRWFzaW5nLkxpbmVhci5Ob25lLCB0cnVlLCAwLCAwLCB0cnVlKTtcbiAgICBicmVhaztcbiAgICB9XG4gIH0sXG5cbiAgZW5kOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gXCIjZmZmZmZmXCI7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRERSR2FtZTtcbiIsInZhciBUZXh0TWFuYWdlciA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9UZXh0TWFuYWdlci5qcycpO1xudmFyIFN3aXBlTWFuYWdlciA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9Td2lwZU1hbmFnZXIuanMnKTtcbnZhciBJbnRlcnN0aXRpYWwgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9JbnRlcnN0aXRpYWwuanMnKTtcbnZhciBUaW1lciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL1RpbWVyLmpzJyk7XG5cbnZhciBGbGF0VGF4R2FtZSA9IGZ1bmN0aW9uICgpIHtcbn07XG5cbk5VTV9TRUdNRU5UUyA9IDU7XG5cbkZsYXRUYXhHYW1lLnByb3RvdHlwZSA9IHtcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuXG4gICAgdGhpcy5iYWQgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdiYWQnKTtcbiAgICB0aGlzLmdvb2QgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdnb29kJyk7XG5cbiAgICB0aGlzLlRpbWVyID0gbmV3IFRpbWVyKHRoaXMuZ2FtZSwgNjUwMCwgdGhpcy5vblRpbWVyQ29tcGxldGUsIHRoaXMsIHRydWUpO1xuICAgIHRoaXMuVGV4dE1hbmFnZXIgPSBuZXcgVGV4dE1hbmFnZXIodGhpcy5nYW1lKTtcbiAgICB0aGlzLmdhbWUucGx1Z2lucy5hZGQobmV3IFN3aXBlTWFuYWdlcih0aGlzLmdhbWUsIHRoaXMuc3dpcGUsIHRoaXMsIHRydWUpKTtcbiAgICB0aGlzLnNlZ21lbnRzID0gW107XG4gICAgdGhpcy5ncmFwaGljcyA9IHRoaXMuZ2FtZS5hZGQuZ3JhcGhpY3MoMCwgMCk7XG4gICAgdGhpcy5ncmFwaGljcy5saW5lU3R5bGUoMywgMHgwMDAwMDApO1xuXG4gICAgdGhpcy5nYW1lLmFkZC5zcHJpdGUoMCwgMCwgJ3RheGJnJyk7XG4gICAgdmFyIGhlYWRlciA9IHRoaXMuZ2FtZS5hZGQudGV4dCh0aGlzLmdhbWUud29ybGQuY2VudGVyWCwgMjAsIFwiVS5TLiBUYXggQ29kZVwiLCB7XG4gICAgICBmb250OiAnNDVweCBzZXJpZicsXG4gICAgICBmaWxsOiAnIzAwMDAwMCcsXG4gICAgICBhbGlnbjogJ2NlbnRlcidcbiAgICB9KTtcbiAgICBoZWFkZXIueCAtPSAoaGVhZGVyLndpZHRoIC8gMik7XG4gICAgdmFyIHN1YiA9IHRoaXMuZ2FtZS5hZGQudGV4dCh0aGlzLmdhbWUud29ybGQuY2VudGVyWCwgMjQgKyBoZWFkZXIuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJGaWcgMi4wLjEsIE1hcmdpbmFsIFRheCBSYXRlXCIsIHtcbiAgICAgIGZvbnQ6ICcyNHB4IHNlcmlmJyxcbiAgICAgIGZpbGw6ICcjMDAwMDAwJyxcbiAgICAgIGFsaWduOiAnY2VudGVyJ1xuICAgIH0pO1xuICAgIHN1Yi54IC09IChzdWIud2lkdGggLyAyKTtcblxuICAgIHZhciBzZWdtZW50TGVuZ3RoID0gdGhpcy5nYW1lLndpZHRoIC8gTlVNX1NFR01FTlRTO1xuICAgIHZhciB0b3AgPSB0aGlzLmdhbWUuaGVpZ2h0IC8gMS41O1xuICAgIHZhciBib3QgPSB0aGlzLmdhbWUuaGVpZ2h0IC8gMztcbiAgICB2YXIgbGV2ZWwgPSAodGhpcy5nYW1lLmhlaWdodCAvIDIpO1xuICAgIHZhciB3aGVyZVRvR28gPSB7XG4gICAgICAwOiB0b3AsXG4gICAgICAxOiBsZXZlbCxcbiAgICAgIDI6IGJvdFxuICAgIH07XG4gICAgdmFyIHN0YXJ0ID0geyB4OiAwLCB5OiB3aGVyZVRvR29bTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyldIH07XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBOVU1fU0VHTUVOVFM7IGkrKykge1xuICAgICAgdmFyIGVuZFkgPSAoc3RhcnQueSA9PT0gdG9wKSA/IGxldmVsIDpcbiAgICAgICAgICAgIChzdGFydC55ID09PSBib3QpID8gbGV2ZWwgOiB3aGVyZVRvR29bTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyldO1xuICAgICAgdmFyIGVuZCA9IHtcbiAgICAgICAgeDogc3RhcnQueCArIHNlZ21lbnRMZW5ndGgsXG4gICAgICAgIHk6IGVuZFlcbiAgICAgIH07XG4gICAgICB2YXIgbGluZSA9IG5ldyBQaGFzZXIuTGluZShzdGFydC54LCBzdGFydC55LCBlbmQueCwgZW5kLnkpO1xuICAgICAgbGluZS5sZXZlbGVkID0gZmFsc2U7XG4gICAgICB0aGlzLnNlZ21lbnRzLnB1c2gobGluZSk7XG4gICAgICBpZiAobGluZS5zdGFydC55ID09PSBsaW5lLmVuZC55KSBsaW5lLmxldmVsZWQgPSB0cnVlO1xuICAgICAgc3RhcnQgPSB7IHg6IGVuZC54LCB5OiBlbmQueSB9O1xuICAgIH1cblxuICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHRoaXMuc2VnbWVudHNbMF0uc3RhcnQueCwgdGhpcy5zZWdtZW50c1swXS5zdGFydC55KTtcblxuICAgIHRoaXMuaW50ZXIgPSBuZXcgSW50ZXJzdGl0aWFsKHRoaXMuZ2FtZSwgXCJGTEFUVEVOIFRIRSBUQVhcIiwgMTUwMCwgZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmludGVyLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMuVGltZXIuc3RhcnQoKTtcbiAgICAgIHRoaXMucmVhZHkgPSB0cnVlO1xuICAgIH0sIHRoaXMpO1xuICB9LFxuXG4gIGZpbmRTbG9wZURpcmVjdGlvbjogZnVuY3Rpb24obGluZSkge1xuICAgIHJldHVybiAobGluZS5zdGFydC55IDwgbGluZS5lbmQueSkgPyAtMSA6XG4gICAgICAobGluZS5zdGFydC55ID09PSBsaW5lLmVuZC55KSA/IDAgOiAxO1xuICB9LFxuXG4gIGZsYXR0ZW5MaW5lOiBmdW5jdGlvbihsaW5lKSB7XG4gICAgdmFyIHNsb3BlRGlyID0gdGhpcy5maW5kU2xvcGVEaXJlY3Rpb24obGluZSk7XG4gICAgc3dpdGNoIChzbG9wZURpcikge1xuICAgIGNhc2UgMTpcbiAgICAgIGlmIChsaW5lLmVuZC55ID49ICh0aGlzLmdhbWUuaGVpZ2h0IC8gMikpIGxpbmUuc3RhcnQueSA9IGxpbmUuZW5kLnk7XG4gICAgICBlbHNlIGxpbmUuZW5kLnkgPSBsaW5lLnN0YXJ0Lnk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIC0xOlxuICAgICAgaWYgKGxpbmUuZW5kLnkgPiAodGhpcy5nYW1lLmhlaWdodCAvIDIpKSBsaW5lLmVuZC55ID0gbGluZS5zdGFydC55O1xuICAgICAgZWxzZSBsaW5lLnN0YXJ0LnkgPSBsaW5lLmVuZC55O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAwOlxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfSxcblxuICBzd2lwZTogZnVuY3Rpb24gKGRpciwgc3RhcnQsIGVuZCkge1xuICAgIHZhciBzd2lwZUxpbmUgPSBuZXcgUGhhc2VyLkxpbmUoc3RhcnQueCwgc3RhcnQueSwgZW5kLngsIGVuZC55KTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc2VnbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBzZWcgPSB0aGlzLnNlZ21lbnRzW2ldO1xuICAgICAgdmFyIGZsYXR0ZW4gPSBmYWxzZTtcblxuICAgICAgaWYgKHNlZy5sZXZlbGVkKSBjb250aW51ZTtcblxuICAgICAgdmFyIGludCA9IHN3aXBlTGluZS5pbnRlcnNlY3RzKHNlZywgdHJ1ZSk7XG5cbiAgICAgIGlmIChpbnQpIHtcbiAgICAgICAgaWYgKGludC55ID4gKHRoaXMuZ2FtZS5oZWlnaHQgLyAyKSkge1xuICAgICAgICAgIGlmIChkaXIgIT09IDIpIGNvbnRpbnVlO1xuICAgICAgICAgIGZsYXR0ZW4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGludC55IDwgKHRoaXMuZ2FtZS5oZWlnaHQgLyAyKSkge1xuICAgICAgICAgIGlmIChkaXIgIT09IDMpIGNvbnRpbnVlO1xuICAgICAgICAgIGZsYXR0ZW4gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZsYXR0ZW4pIHtcbiAgICAgICAgICB2YXIgc2xvcGVEaXIgPSB0aGlzLmZpbmRTbG9wZURpcmVjdGlvbihzZWcpO1xuICAgICAgICAgIHZhciBuZXh0U2xvcGUgPSAwO1xuICAgICAgICAgIHZhciBwcmV2U2xvcGUgPSAwO1xuICAgICAgICAgIHZhciBwcmV2SSA9IChzbG9wZURpciA9PT0gMSkgPyAtMSA6IDE7XG4gICAgICAgICAgdmFyIG5leHRJID0gKHNsb3BlRGlyID09PSAxKSA/IDEgOiAtMTtcblxuICAgICAgICAgIHZhciBwcmV2ID0gdGhpcy5zZWdtZW50c1tpICsgcHJldkldO1xuICAgICAgICAgIGlmIChwcmV2KVxuICAgICAgICAgICAgcHJldlNsb3BlID0gdGhpcy5maW5kU2xvcGVEaXJlY3Rpb24ocHJldik7XG4gICAgICAgICAgdmFyIG5leHQgPSB0aGlzLnNlZ21lbnRzW2kgKyBuZXh0SV07XG4gICAgICAgICAgaWYgKG5leHQpXG4gICAgICAgICAgICBuZXh0U2xvcGUgPSB0aGlzLmZpbmRTbG9wZURpcmVjdGlvbihuZXh0KTtcblxuICAgICAgICAgIGlmIChuZXh0U2xvcGUgIT0gc2xvcGVEaXIgJiYgbmV4dFNsb3BlICE9IDApIHtcbiAgICAgICAgICAgIHRoaXMuZmxhdHRlbkxpbmUobmV4dCk7XG4gICAgICAgICAgICBuZXh0LmxldmVsZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChwcmV2U2xvcGUgIT0gc2xvcGVEaXIgJiYgcHJldlNsb3BlICE9IDApIHtcbiAgICAgICAgICAgIHRoaXMuZmxhdHRlbkxpbmUocHJldik7XG4gICAgICAgICAgICBwcmV2LmxldmVsZWQgPSB0cnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMuZmxhdHRlbkxpbmUoc2VnKTtcbiAgICAgICAgICBzZWcubGV2ZWxlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnJlYWR5KVxuICAgICAgcmV0dXJuO1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5ncmFwaGljcy5jbGVhcigpO1xuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnNlZ21lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLmdyYXBoaWNzLmxpbmVTdHlsZSgzLCAweDAwMDAwMCk7XG4gICAgICB2YXIgc2VnID0gdGhpcy5zZWdtZW50c1tpXTtcbiAgICAgIHZhciBzbG9wZSA9IHRoaXMuZmluZFNsb3BlRGlyZWN0aW9uKHNlZyk7XG4gICAgICB2YXIgY3B4MSA9IDA7XG4gICAgICB2YXIgY3B4MiA9IDA7XG4gICAgICB2YXIgY3B5MSA9IDA7XG4gICAgICB2YXIgY3B5MiA9IDA7XG4gICAgICB2YXIgd0RpZmYgPSBzZWcuc3RhcnQueCAtIHNlZy5lbmQueDtcbiAgICAgIHZhciBoRGlmZiA9IE1hdGguYWJzKHNlZy5zdGFydC55IC0gc2VnLmVuZC55KTtcbiAgICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHNlZy5zdGFydC54LCBzZWcuc3RhcnQueSk7XG5cbiAgICAgIHN3aXRjaCAoc2xvcGUpIHtcbiAgICAgIGNhc2UgMDpcbiAgICAgICAgY3B4MSA9IHNlZy5zdGFydC54ICsgKHdEaWZmIC8gMyk7XG4gICAgICAgIGNweDIgPSBzZWcuc3RhcnQueCArICh3RGlmZiAvIDMpICogMjtcbiAgICAgICAgY3B5MSA9IHNlZy5zdGFydC55O1xuICAgICAgICBjcHkyID0gc2VnLnN0YXJ0Lnk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAxOlxuICAgICAgY2FzZSAtMTpcbiAgICAgICAgY3B4MSA9IHNlZy5lbmQueDtcbiAgICAgICAgY3B5MSA9IHNlZy5zdGFydC55O1xuICAgICAgICBjcHgyID0gc2VnLnN0YXJ0Lng7XG4gICAgICAgIGNweTIgPSBzZWcuZW5kLnk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmdyYXBoaWNzLmJlemllckN1cnZlVG8oY3B4MSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcHkxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNweDIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3B5MixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWcuZW5kLngsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnLmVuZC55KTtcbiAgICB9XG4gIH0sXG5cbiAgb25UaW1lckNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxvc2UgPSBmYWxzZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc2VnbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghdGhpcy5zZWdtZW50c1tpXS5sZXZlbGVkIHx8IHRoaXMuc2VnbWVudHNbaV0ubGV2ZWxlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGxvc2UgPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobG9zZSkgdGhpcy5sb3NlKCk7XG4gICAgZWxzZSB0aGlzLndpbigpO1xuICB9LFxuXG4gIGxvc2U6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmJhZC5wbGF5KCk7XG4gICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuICAgIHdpbmRvdy5TY29yZSAtPSAxMDA7XG4gICAgd2luZG93LkxpdmUgLT0gMjtcbiAgICB0aGlzLlRleHRNYW5hZ2VyLnN0YXR1c1RleHQoXCJMT1NFIVwiKTtcbiAgICB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKDQwMDAsIHRoaXMuZW5kLCB0aGlzKTtcbiAgfSxcblxuICB3aW46IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmdvb2QucGxheSgpO1xuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICB3aW5kb3cuU3BlZWRNdWx0aXBsaWVyICs9IDAuNTtcbiAgICB3aW5kb3cuU2NvcmUgKz0gMTAwO1xuICAgIHRoaXMuVGV4dE1hbmFnZXIuc3RhdHVzVGV4dChcIldJTiFcIik7XG4gICAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCg0MDAwLCB0aGlzLmVuZCwgdGhpcyk7XG4gIH0sXG5cbiAgZW5kOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gXCIjZmZmZmZmXCI7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRmxhdFRheEdhbWU7XG4iLCJ2YXIgVGV4dE1hbmFnZXIgPSByZXF1aXJlKCcuLi91dGlsaXRpZXMvVGV4dE1hbmFnZXIuanMnKTtcbnZhciBJbnRlcnN0aXRpYWwgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9JbnRlcnN0aXRpYWwuanMnKTtcbnZhciBUaW1lciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL1RpbWVyLmpzJyk7XG52YXIgV0lOX1ggPSAxMDgwO1xudmFyIFBMQVlFUl9ZID0gMjkwO1xudmFyIFNIT0VfWSA9IDQ3MDtcblxudmFyIEZyb2dHYW1lID0gZnVuY3Rpb24gKCkge1xufTtcblxuRnJvZ0dhbWUucHJvdG90eXBlID0ge1xuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICB0aGlzLmJhZCA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ2JhZCcpO1xuICAgIHRoaXMuYmxpcCA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ2JsaXAnKTtcbiAgICB0aGlzLmdvb2QgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdnb29kJyk7XG5cbiAgICBpZiAoIXRoaXMuZ2FtZS5kZXZpY2UuZGVza3RvcCkgdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMuZ29GdWxsc2NyZWVuLCB0aGlzKTtcblxuICAgIHRoaXMuZ2FtZS53b3JsZC53aWR0aCA9IDEyMDA7XG4gICAgdGhpcy5nYW1lLmNhbWVyYS5zZXRCb3VuZHNUb1dvcmxkKCk7XG5cbiAgICB0aGlzLlRleHRNYW5hZ2VyID0gbmV3IFRleHRNYW5hZ2VyKHRoaXMuZ2FtZSk7XG4gICAgdGhpcy5UaW1lciA9IG51bGw7XG5cbiAgICB0aGlzLmJhY2tncm91bmQgPSB0aGlzLmdhbWUuYWRkLmltYWdlKDAsIDAsICdmcm9nSGF1cycpO1xuICAgIHRoaXMucGxheWVyID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUodGhpcy5nYW1lLndpZHRoIC8gMiwgMjkwLCAnZnJvZ1BsYXllcicpO1xuICAgIHRoaXMucGxheWVyLmFuaW1hdGlvbnMuYWRkKCdpZGxlJywgWzBdKTtcbiAgICB0aGlzLnBsYXllci5hbmltYXRpb25zLmFkZCgnbGVmdCcsIFsxXSk7XG4gICAgdGhpcy5wbGF5ZXIuYW5pbWF0aW9ucy5hZGQoJ3JpZ2h0JywgWzJdKTtcbiAgICB0aGlzLnBsYXllci5hbmltYXRpb25zLnBsYXkoJ2lkbGUnLCAwLCB0cnVlKTtcblxuICAgIHRoaXMuZnJvZyA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKHRoaXMucGxheWVyLnggLSAzNTAsIFBMQVlFUl9ZLCAnZnJvZ0NoYXNlcicpO1xuICAgIHRoaXMuZnJvZy5hbmltYXRpb25zLmFkZCgncnVuJyk7XG4gICAgdGhpcy5mcm9nLmFuaW1hdGlvbnMucGxheSgncnVuJywgMTAsIHRydWUpO1xuXG4gICAgdGhpcy5zZXR1cFNob2VzKCk7XG5cbiAgICB0aGlzLmZyb2dTcGVlZCA9IDEuNSArIHdpbmRvdy5TcGVlZE11bHRpcGxpZXI7XG4gICAgdGhpcy5wbGF5ZXJTcGVlZCA9IDI1ICsgd2luZG93LlNwZWVkTXVsdGlwbGllcjtcblxuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcblxuICAgIHRoaXMuZ2FtZS5jYW1lcmEuZm9sbG93KHRoaXMucGxheWVyKTtcblxuICAgIHRoaXMuaW50ZXIgPSBuZXcgSW50ZXJzdGl0aWFsKHRoaXMuZ2FtZSwgXCJHRVQgT1VUXCIsIDE1MDAsIGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5pbnRlci5kZXN0cm95KCk7XG4gICAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcbiAgICB9LCB0aGlzKTtcbiAgfSxcblxuICBnb0Z1bGxzY3JlZW46IGZ1bmN0aW9uKCkge1xuICAgIGlmKHRoaXMuZ2FtZS5zY2FsZS5pc0Z1bGxTY3JlZW4pIHJldHVybjtcbiAgICB0aGlzLmdhbWUuc2NhbGUuZnVsbFNjcmVlblNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XG4gICAgdGhpcy5nYW1lLnNjYWxlLnN0YXJ0RnVsbFNjcmVlbih0cnVlKTtcbiAgfSxcblxuICBzZXR1cFNob2VzOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmxlZnRTaG9lID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUoNjUsIFNIT0VfWSwgJ2xlZnRTaG9lJyk7XG4gICAgdGhpcy5yaWdodFNob2UgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSgyOTUsIFNIT0VfWSwgJ3JpZ2h0U2hvZScpO1xuXG4gICAgdGhpcy5sZWZ0U2hvZS5hbmltYXRpb25zLmFkZCgnaWRsZScsIFswXSk7XG4gICAgdGhpcy5yaWdodFNob2UuYW5pbWF0aW9ucy5hZGQoJ2lkbGUnLCBbMF0pO1xuICAgIHRoaXMubGVmdFNob2UuYW5pbWF0aW9ucy5hZGQoJ2ZsYXNoJywgWzEsMl0pO1xuICAgIHRoaXMucmlnaHRTaG9lLmFuaW1hdGlvbnMuYWRkKCdmbGFzaCcsIFsxLDJdKTtcblxuICAgIHRoaXMubGVmdFNob2UuZml4ZWRUb0NhbWVyYSA9IHRydWU7XG4gICAgdGhpcy5yaWdodFNob2UuZml4ZWRUb0NhbWVyYSA9IHRydWU7XG5cbiAgICB0aGlzLmxlZnRTaG9lLmlucHV0RW5hYmxlZCA9IGZhbHNlO1xuICAgIHRoaXMucmlnaHRTaG9lLmlucHV0RW5hYmxlZCA9IGZhbHNlO1xuXG4gICAgdGhpcy5sZWZ0U2hvZS5ldmVudHMub25JbnB1dERvd24uYWRkKGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5wbGF5ZXIuYW5pbWF0aW9ucy5wbGF5KCdsZWZ0JywgMTAsIGZhbHNlKTtcbiAgICAgIHRoaXMucGxheWVyLmV2ZW50cy5vbkFuaW1hdGlvbkNvbXBsZXRlLmFkZCh0aGlzLmlkbGVQbGF5ZXIsIHRoaXMpO1xuICAgICAgdGhpcy5tb3ZlUGxheWVyKCk7XG4gICAgICB0aGlzLmFjdGl2YXRlU2hvZSh0aGlzLnJpZ2h0U2hvZSwgdGhpcy5sZWZ0U2hvZSk7XG4gICAgfSwgdGhpcyk7XG5cbiAgICB0aGlzLnJpZ2h0U2hvZS5ldmVudHMub25JbnB1dERvd24uYWRkKGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5wbGF5ZXIuYW5pbWF0aW9ucy5wbGF5KCdyaWdodCcsIDEwLCBmYWxzZSk7XG4gICAgICB0aGlzLnBsYXllci5ldmVudHMub25BbmltYXRpb25Db21wbGV0ZS5hZGQodGhpcy5pZGxlUGxheWVyLCB0aGlzKTtcbiAgICAgIHRoaXMubW92ZVBsYXllcigpO1xuICAgICAgdGhpcy5hY3RpdmF0ZVNob2UodGhpcy5sZWZ0U2hvZSwgdGhpcy5yaWdodFNob2UpO1xuICAgIH0sIHRoaXMpO1xuXG4gICAgdGhpcy5hY3RpdmF0ZVNob2UodGhpcy5sZWZ0U2hvZSwgdGhpcy5yaWdodFNob2UpO1xuICB9LFxuXG4gIGFjdGl2YXRlU2hvZTogZnVuY3Rpb24oYWN0aXZlU2hvZSwgdW5hY3RpdmVTaG9lKSB7XG4gICAgYWN0aXZlU2hvZS5hbmltYXRpb25zLnBsYXkoJ2ZsYXNoJywgNTAsIHRydWUpO1xuICAgIGFjdGl2ZVNob2UuaW5wdXRFbmFibGVkID0gdHJ1ZTtcblxuICAgIHVuYWN0aXZlU2hvZS5hbmltYXRpb25zLnBsYXkoJ2lkbGUnLCA1MCwgdHJ1ZSk7XG4gICAgdW5hY3RpdmVTaG9lLmlucHV0RW5hYmxlZCA9IGZhbHNlO1xuICB9LFxuXG4gIGlkbGVQbGF5ZXI6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucGxheWVyLmFuaW1hdGlvbnMucGxheSgnaWRsZScsIDUsIHRydWUpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLnJlYWR5KSByZXR1cm47XG5cbiAgICBpZih0aGlzLmZyb2cueCArICh0aGlzLmZyb2cud2lkdGggKiAwLjY2NikgPiB0aGlzLnBsYXllci54KSB0aGlzLmxvc2UoKTtcblxuICAgIGlmKHRoaXMucGxheWVyLnggPiBXSU5fWCkgdGhpcy53aW4oKTtcblxuICAgIHRoaXMubW92ZUZyb2dUb3dhcmRQbGF5ZXIoKTtcbiAgfSxcblxuICBtb3ZlUGxheWVyOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmJsaXAucGxheSgnJywgMCwgMC42KTtcbiAgICBpZiAoIXRoaXMucmVhZHkpIHJldHVybjtcbiAgICB0aGlzLnBsYXllci54ICs9IHRoaXMucGxheWVyU3BlZWQ7XG4gIH0sXG5cbiAgbW92ZUZyb2dUb3dhcmRQbGF5ZXI6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmZyb2cueCA8IHRoaXMucGxheWVyLngpIHRoaXMuZnJvZy54ICs9IHRoaXMuZnJvZ1NwZWVkO1xuICB9LFxuXG4gIGxvc2U6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmJhZC5wbGF5KCk7XG4gICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuICAgIHdpbmRvdy5TY29yZSAtPSAxMDA7XG4gICAgd2luZG93LkxpdmVzIC09IDI7XG4gICAgdGhpcy5UZXh0TWFuYWdlci5zdGF0dXNUZXh0KFwiTE9TRSFcIik7XG4gICAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCgyMDAwLCB0aGlzLmVuZCwgdGhpcyk7XG4gIH0sXG5cbiAgd2luOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5nb29kLnBsYXkoKTtcbiAgICB0aGlzLnJlYWR5ID0gZmFsc2U7XG4gICAgd2luZG93LlNwZWVkTXVsdGlwbGllciArPSAwLjU7XG4gICAgd2luZG93LlNjb3JlICs9IDEwMDtcbiAgICB0aGlzLlRleHRNYW5hZ2VyLnN0YXR1c1RleHQoXCJXSU4hXCIpO1xuICAgIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoMjAwMCwgdGhpcy5lbmQsIHRoaXMpO1xuICB9LFxuXG4gIGVuZDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRnJvZ0dhbWU7XG4iLCJ2YXIgU3dpcGVNYW5hZ2VyID0gcmVxdWlyZSgnLi4vdXRpbGl0aWVzL1N3aXBlTWFuYWdlci5qcycpO1xudmFyIENpbmRlclByb2ZpbGUgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9DaW5kZXJQcm9maWxlLmpzJyk7XG52YXIgUHJvZmlsZVJldmVhbCA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL1Byb2ZpbGVSZXZlYWwuanMnKTtcbnZhciBUZXh0TWFuYWdlciA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9UZXh0TWFuYWdlci5qcycpO1xuXG52YXIgR2FtZSA9IGZ1bmN0aW9uICgpIHtcbiAgY3VycmVudENpbmRlclByb2ZpbGUgPSBudWxsO1xuICBsYXN0U3dpcGVEaXJlY3Rpb24gPSBTd2lwZU1hbmFnZXIuU1dJUEVfRElSRUNUSU9OUy5SSUdIVDtcbiAgc3dpcGVTY29yZSA9IDIwO1xufTtcblxuR2FtZS5wcm90b3R5cGUgPSB7XG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIGlmICh3aW5kb3cuTGl2ZXMgPD0gMClcbiAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnZ2FtZW92ZXInKTtcblxuICAgIHRoaXMuZ2FtZS5zdGFnZS5iYWNrZ3JvdW5kQ29sb3IgPSAnI2ZmZmZmZic7XG4gICAgdGhpcy5nYW1lLndvcmxkLndpZHRoID0gNDE0O1xuICAgIHRoaXMuZ2FtZS5wbHVnaW5zLmFkZChuZXcgU3dpcGVNYW5hZ2VyKHRoaXMuZ2FtZSwgdGhpcy5zd2lwZSwgdGhpcykpO1xuICAgIHRoaXMuVGV4dE1hbmFnZXIgPSBuZXcgVGV4dE1hbmFnZXIodGhpcy5nYW1lKTtcbiAgICBjdXJyZW50Q2luZGVyUHJvZmlsZSA9IG5ldyBDaW5kZXJQcm9maWxlKHRoaXMuZ2FtZSwgbGFzdFN3aXBlRGlyZWN0aW9uKTtcblxuICAgIC8qXG4gICAgaWYgKCF0aGlzLmdhbWUuZGV2aWNlLmRlc2t0b3AgJiZcbiAgICAgICAhdGhpcy5nYW1lLmRldmljZS5pT1MpIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLmdvRnVsbHNjcmVlbiwgdGhpcyk7XG4gICAgICovXG5cbiAgICB0aGlzLmhlYWRlciA9IHRoaXMuYWRkLnNwcml0ZSgwLCAwLCAnaGVhZGVyJyk7XG4gICAgdGhpcy5iYWQgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdiYWQnKTtcbiAgICB0aGlzLmdvb2QgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCd5YXknKTtcbiAgICB0aGlzLndhYmFuZyA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ3dhYmFuZycpO1xuXG4gICAgdGhpcy54QnV0dG9uID0gdGhpcy5hZGQuYnV0dG9uKDExNSwgNDg1LCAneEJ1dHRvbicsIHRoaXMubm9wZUJ1dHRvbkNhbGxiYWNrLmJpbmQodGhpcykpO1xuICAgIHRoaXMuaGVhcnRCdXR0b24gPSB0aGlzLmFkZC5idXR0b24oMjA3LCA0ODUsICdoZWFydEJ1dHRvbicsIHRoaXMueWVwQnV0dG9uQ2FsbGJhY2suYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLmhlYXJ0cyA9IFtdO1xuXG4gICAgdmFyIGhlYXJ0UGFkZGluZyA9IDg7XG4gICAgdmFyIGNpbmRlckZyYW1lVyA9IHRoaXMuZ2FtZS5jYWNoZS5nZXRJbWFnZSgnY2luZGVyRnJhbWUnKS53aWR0aDtcbiAgICB2YXIgc3RhcnRYID0gKHRoaXMuZ2FtZS53aWR0aCAtIGNpbmRlckZyYW1lVykgLyAyO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd2luZG93LkxpdmVzOyBpKyspIHtcbiAgICAgIHZhciBoID0gbnVsbDtcblxuICAgICAgLy8gbGl2ZXMgc3ByaXRlIC8gYW5pbWF0aW9uXG4gICAgICBpZiAoaSA9PT0gNCkgc3RhcnRYID0gc3RhcnRYICsgdGhpcy54QnV0dG9uLndpZHRoICogMiArIDE0O1xuICAgICAgaWYgKGkgJSAyICE9PSAwKSB7XG4gICAgICAgIGggPSB0aGlzLmdhbWUuYWRkLnNwcml0ZShzdGFydFggKyAoKGkgLSAxKSAvIDIpICogKDMyICsgaGVhcnRQYWRkaW5nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy54QnV0dG9uLnkgKyB0aGlzLnhCdXR0b24uaGVpZ2h0IC8gMiAtIDE2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaGVhcnQnKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBoID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUoc3RhcnRYICsgKGkgLyAyKSAqICgzMiArIGhlYXJ0UGFkZGluZykgKyA4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy54QnV0dG9uLnkgKyB0aGlzLnhCdXR0b24uaGVpZ2h0IC8gMiAtIDgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc21hbGxoZWFydCcpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmhlYXJ0cy5wdXNoKGgpO1xuICAgIH1cblxuICAgIHRoaXMuYmFzZVN3aXBlU2NvcmUgPSAyNTtcbiAgICB0aGlzLnN3aXBlU2NvcmUgPSB0aGlzLmJhc2VTd2lwZVNjb3JlO1xuICAgIHRoaXMudXBkYXRlVGltZSA9IDA7XG5cbiAgICB0aGlzLnN3aXBlRW5hYmxlZCA9IHRydWU7XG5cbiAgICBpZiAod2luZG93LkdhbWVzID09PSB3aW5kb3cuVE9UQUxfR0FNRVMpXG4gICAgICB0aGlzLlRleHRNYW5hZ2VyLmFkZEZsb2F0aW5nVGV4dCgnY3JpdGljYWwgb21pc3Npb24uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkb3duJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzb21ldGhpbmcsIHNvbWV0aGluZywnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMCk7XG4gIH0sXG5cbiAgZ29GdWxsc2NyZWVuOiBmdW5jdGlvbigpIHtcbiAgICBpZih0aGlzLmdhbWUuc2NhbGUuaXNGdWxsU2NyZWVuKSByZXR1cm47XG4gICAgdGhpcy5nYW1lLnNjYWxlLmZ1bGxTY3JlZW5TY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuICAgIHRoaXMuZ2FtZS5zY2FsZS5zdGFydEZ1bGxTY3JlZW4odHJ1ZSk7XG4gIH0sXG5cbiAgc3dpcGU6IGZ1bmN0aW9uKHN3aXBlRGlyZWN0aW9uKSB7XG4gICAgaWYgKCF0aGlzLnN3aXBlRW5hYmxlZCkgcmV0dXJuO1xuICAgIHRoaXMuc3dpcGVFbmFibGVkID0gZmFsc2U7XG5cbiAgICB3aW5kb3cuR2FtZXMgKz0gMTtcblxuICAgIHZhciB0byA9IC10aGlzLmdhbWUud2lkdGggKiAzO1xuICAgIHZhciBhbmdsZSA9IC05MDtcblxuICAgIGxhc3RTd2lwZURpcmVjdGlvbiA9IHN3aXBlRGlyZWN0aW9uO1xuXG4gICAgaWYgKHN3aXBlRGlyZWN0aW9uID09IFN3aXBlTWFuYWdlci5TV0lQRV9ESVJFQ1RJT05TLlJJR0hUKSB7XG4gICAgICB0aGlzLmdvb2QucGxheSgpO1xuICAgICAgd2luZG93LlBsYXllZEdhbWVzICs9IDE7XG4gICAgICB0byA9IHRvICogLTE7XG4gICAgICBhbmdsZSA9IGFuZ2xlICogLTE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYmFkLnBsYXkoKTtcbiAgICAgIHdpbmRvdy5MaXZlcyAtPSAxO1xuICAgICAgdGhpcy5oZWFydHNbdGhpcy5oZWFydHMubGVuZ3RoIC0gMV0uZGVzdHJveSgpO1xuICAgICAgdGhpcy5oZWFydHMuc3BsaWNlKHRoaXMuaGVhcnRzLmxlbmd0aCAtIDEsIDEpO1xuXG4gICAgICBpZiAod2luZG93LkxpdmVzIDw9IDApXG4gICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnZ2FtZW92ZXInKTtcblxuICAgICAgdGhpcy5zd2lwZVBlbmFsdHkoKTtcbiAgICB9XG5cbiAgICB0aGlzLnN3aXBlVG8odG8sIGFuZ2xlKTtcbiAgfSxcblxuICBzd2lwZVBlbmFsdHk6IGZ1bmN0aW9uKCkge1xuICAgIHdpbmRvdy5TY29yZSAtPSB0aGlzLmJhc2VTd2lwZVNjb3JlO1xuXG4gICAgdGhpcy5UZXh0TWFuYWdlci5hZGRGbG9hdGluZ1RleHQoJy0nICsgdGhpcy5iYXNlU3dpcGVTY29yZSwgXCJ1cFwiLCAnYm9vJyk7XG4gIH0sXG5cbiAgb25Td2lwZUNvbXBsZXRlOiBmdW5jdGlvbigpIHtcbiAgICBpZiAobGFzdFN3aXBlRGlyZWN0aW9uID09IDEpIHRoaXMucmV2ZWFsKCk7XG4gICAgZWxzZSB0aGlzLm5leHRQcm9maWxlKCk7XG4gIH0sXG5cbiAgcmV2ZWFsOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLndhYmFuZy5wbGF5KCk7XG4gICAgdGhpcy5jdXJyZW50UmV2ZWFsID0gbmV3IFByb2ZpbGVSZXZlYWwodGhpcy5nYW1lLCAwLCB0aGlzLmhlYWRlci5oZWlnaHQsIGN1cnJlbnRDaW5kZXJQcm9maWxlLnByb2ZpbGUpO1xuXG4gICAgdGhpcy5nYW1lLmFkZC5leGlzdGluZyh0aGlzLmN1cnJlbnRSZXZlYWwpO1xuXG4gICAgLy9UaGlzIHRpbWVvdXQgZm9yY2VzIHRoZW0gdG8gbG9vayBhdCB0aGUgcmV2ZWFsIGltYWdlIGZvciBhdCBsZWFzdCBhIGJpdFxuICAgIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoMzAwLCBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuY3VycmVudFJldmVhbC5ldmVudHMub25JbnB1dERvd24uYWRkKHRoaXMuZW5kUmV2ZWFsLmJpbmQodGhpcyksIHRoaXMpO1xuICAgIH0sIHRoaXMpO1xuXG4gICAgdGhpcy5yZXZlYWxUaW1lb3V0ID0gdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCgzMDAwLCB0aGlzLmVuZFJldmVhbCwgdGhpcyk7XG4gIH0sXG5cbiAgZW5kUmV2ZWFsOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5yZXZlYWxUaW1lb3V0KSB0aGlzLmdhbWUudGltZS5ldmVudHMucmVtb3ZlKHRoaXMucmV2ZWFsVGltZW91dCk7XG5cbiAgICB0aGlzLmN1cnJlbnRSZXZlYWwua2lsbCgpO1xuXG4gICAgaWYgKHR5cGVvZiBjdXJyZW50Q2luZGVyUHJvZmlsZS5wcm9maWxlLm1pbmlnYW1lICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgICAgIGxhc3RTd2lwZURpcmVjdGlvbiA9PT0gY3VycmVudENpbmRlclByb2ZpbGUucHJvZmlsZS5taW5pZ2FtZURpcmVjdGlvbilcbiAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydChjdXJyZW50Q2luZGVyUHJvZmlsZS5wcm9maWxlLm1pbmlnYW1lKTtcbiAgICBlbHNlXG4gICAgICB0aGlzLm5leHRQcm9maWxlKCk7XG5cbiAgfSxcblxuICBuZXh0UHJvZmlsZTogZnVuY3Rpb24oKSB7XG4gICAgY3VycmVudENpbmRlclByb2ZpbGUgPSBuZXcgQ2luZGVyUHJvZmlsZSh0aGlzLmdhbWUsIGxhc3RTd2lwZURpcmVjdGlvbik7XG4gICAgdGhpcy5zd2lwZVNjb3JlID0gdGhpcy5iYXNlU3dpcGVTY29yZTtcbiAgICB0aGlzLnN3aXBlRW5hYmxlZCA9IHRydWU7XG5cbiAgICBpZiAod2luZG93LkdhbWVzID09PSB3aW5kb3cuVE9UQUxfR0FNRVMpXG4gICAgICB0aGlzLlRleHRNYW5hZ2VyLmFkZEZsb2F0aW5nVGV4dCgnY3JpdGljYWwgb21pc3Npb24uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkb3duJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzb21ldGhpbmcsIHNvbWV0aGluZywnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMCk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy51cGRhdGVUaW1lICs9IDE7XG4gICAgaWYgKHRoaXMuc3dpcGVTY29yZSA+IDEgJiYgdGhpcy51cGRhdGVUaW1lICUgMTAgPT09IDApIHtcbiAgICAgIHRoaXMuc3dpcGVTY29yZSAtPSAxO1xuICAgIH1cbiAgfSxcblxuICBvblRpbWVyVHdlZW5Db21wbGV0ZTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5iYWQucGxheSgpO1xuICB9LFxuXG4gIG5vcGVCdXR0b25DYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgY29uc29sZS5sb2coJ2hlcmUnKTtcbiAgICB0aGlzLnN3aXBlKFN3aXBlTWFuYWdlci5TV0lQRV9ESVJFQ1RJT05TLkxFRlQpO1xuICB9LFxuXG4gIHllcEJ1dHRvbkNhbGxiYWNrOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnN3aXBlKFN3aXBlTWFuYWdlci5TV0lQRV9ESVJFQ1RJT05TLlJJR0hUKTtcbiAgfSxcblxuICBzd2lwZVRvOiBmdW5jdGlvbih0bywgYW5nbGUpIHtcbiAgICB2YXIgc3RhbXBXID0gdGhpcy5nYW1lLmNhY2hlLmdldEltYWdlKCdub3BlJykud2lkdGg7XG4gICAgdmFyIGZyYW1lVyA9IHRoaXMuZ2FtZS5jYWNoZS5nZXRJbWFnZSgnY2luZGVyRnJhbWUnKS53aWR0aDtcbiAgICB2YXIgbm9wZVkgPSBjdXJyZW50Q2luZGVyUHJvZmlsZS55ICsgZnJhbWVXIC0gc3RhbXBXO1xuICAgIHZhciBzdGFtcCA9IG51bGw7XG5cbiAgICBpZiAodG8gPiAwKVxuICAgICAgc3RhbXAgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZShjdXJyZW50Q2luZGVyUHJvZmlsZS55ICsgMzIsIGN1cnJlbnRDaW5kZXJQcm9maWxlLnggKyA2NCwgJ2xpa2UnKTtcbiAgICBlbHNlXG4gICAgICBzdGFtcCA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKG5vcGVZLCBjdXJyZW50Q2luZGVyUHJvZmlsZS54ICsgNjQsICdub3BlJyk7XG5cbiAgICBjdXJyZW50Q2luZGVyUHJvZmlsZS5hZGRDaGlsZChzdGFtcCk7XG5cbiAgICB2YXIgdHdlZW4gPSB0aGlzLmdhbWUuYWRkLnR3ZWVuKGN1cnJlbnRDaW5kZXJQcm9maWxlKTtcbiAgICAvL3VzaW5nIHNldFRpbWVvdXQgdG8gc2hvdyByZXZlYWwgYmVmb3JlIHR3ZWVuIGNvbXBsZXRlcyAoaGFjaz8pXG4gICAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCg3MDAsIHRoaXMub25Td2lwZUNvbXBsZXRlLmJpbmQodGhpcyksIHRoaXMpO1xuICAgIHR3ZWVuLnRvKHsgeDogdG8sIHk6IHRoaXMuZ2FtZS5oZWlnaHQgLyAzLCBhbmdsZTogYW5nbGUgfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5DdWJpYy5PdXQsIGZhbHNlLCAyMDApO1xuICAgIHR3ZWVuLnN0YXJ0KCk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZTtcbiIsInZhciBHYW1lT3ZlciA9IGZ1bmN0aW9uICgpIHtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZU92ZXI7XG5cbkdhbWVPdmVyLnByb3RvdHlwZSA9IHtcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLnRhZGEgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCd0YWRhJyk7XG4gICAgdGhpcy5nYW1lLnN0YWdlLmJhY2tncm91bmRDb2xvciA9ICcjZmZmZmZmJztcbiAgICB0aGlzLmVtaXR0ZXIgPSBudWxsO1xuXG4gICAgdmFyIGVuZFRleHQgPSBcIkdBTUUgT1ZFUiFcIjtcbiAgICB2YXIgdGV4dFByb3BzID0geyBmb250OiAnMjRwdCBBcmlhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgZmlsbDogJyNDMjQzMDAnLFxuICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVRoaWNrbmVzczogMCB9O1xuICAgIHZhciB0ZXh0UHJvcHNTY29yZSA9IHtcbiAgICAgIGZvbnQ6ICcyNHB0IEFyaWFsJyxcbiAgICAgIGZpbGw6ICcjMDAwMDAwJyxcbiAgICAgIHN0cm9rZVRoaWNrbmVzczogMFxuICAgIH07XG4gICAgdmFyIGZsYXZvclByb3BzID0ge1xuICAgICAgZm9udDogJzIwcHggQXJpYWwnLFxuICAgICAgZmlsbDogJyMwMDAwMDAnLFxuICAgICAgYWxpZ246ICdjZW50ZXInLFxuICAgICAgd29yZFdyYXA6IHRydWUsXG4gICAgICB3b3JkV3JhcFdpZHRoOiB0aGlzLmdhbWUud2lkdGggLSAzMFxuICAgIH07XG5cbiAgICB2YXIgdGV4dCA9IHRoaXMuZ2FtZS5hZGQudGV4dCgwLCAwLCBlbmRUZXh0LCB0ZXh0UHJvcHMpO1xuICAgIHZhciBzY29yZVRpdGxlID0gdGhpcy5nYW1lLmFkZC50ZXh0KDAsIDAsIFwiRmluYWwgU2NvcmU6XCIsIHRleHRQcm9wc1Njb3JlKTtcbiAgICB0aGlzLnNjb3JlVGV4dCA9IHRoaXMuZ2FtZS5hZGQudGV4dCgwLCAwLCAnMTAwMCcsIHRleHRQcm9wc1Njb3JlKTtcbiAgICB0aGlzLnVwZGF0ZUNudCA9IDA7XG4gICAgdGhpcy5jb3VudGVyID0gMDtcbiAgICB0aGlzLnNjb3JlRG9uZSA9IGZhbHNlO1xuXG4gICAgdGV4dC54ID0gKHRoaXMuZ2FtZS53aWR0aCAvIDIpIC0gKHRleHQud2lkdGggLyAyKTtcbiAgICB0ZXh0LnkgPSAodGhpcy5nYW1lLmhlaWdodCAvIDIpIC0gKHRleHQuaGVpZ2h0IC8gMik7XG4gICAgc2NvcmVUaXRsZS54ID0gKHRoaXMuZ2FtZS53aWR0aCAvIDIpIC0gKHNjb3JlVGl0bGUud2lkdGggLyAyKTtcbiAgICBzY29yZVRpdGxlLnkgPSB0ZXh0LnkgKyA1MDtcbiAgICB0aGlzLnNjb3JlVGV4dC54ID0gKHRoaXMuZ2FtZS53aWR0aCAvIDIpIC0gKHRoaXMuc2NvcmVUZXh0LndpZHRoIC8gMik7XG4gICAgdGhpcy5zY29yZVRleHQueSA9IHRleHQueSArIDgwO1xuXG4gICAgdmFyIGZsYXZvclRleHQgPSBudWxsO1xuICAgIGlmICh3aW5kb3cuUGxheWVkR2FtZXMgPj0gd2luZG93LlRPVEFMX0dBTUVTKSB7XG4gICAgICBmbGF2b3JUZXh0ID0gXCJXb3csIHlvdSBwbGF5ZWQgYWxsIG9mIHRoZSBnYW1lcy4gWW91IHRoaW5rIHRoYXQncyBzb21ldGhpbmcgdGhhdFwiICtcbiAgICAgICAgXCIgc2hvdWxkIGJlIHJld2FyZGVkP1wiO1xuICAgIH0gZWxzZSBpZiAod2luZG93LkdhbWVzID49IHdpbmRvdy5UT1RBTF9HQU1FUykge1xuICAgICAgZmxhdm9yVGV4dCA9IFwiV293LCB5b3UgY291bGRuJ3QgZXZlbiBwbGF5IHRocm91Z2ggYWxsIG9mIHRoZSBnYW1lcywgYW5kIHlvdSBleHBlY3RcIiArXG4gICAgICAgIFwiIGEgcmV3YXJkIG9yIHNvbWV0aGluZz9cIjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBmbGF2b3JUZXh0ID0gXCJZb3UncmUgYSBsb3Nlci5cIjtcbiAgICB9XG5cbiAgICB2YXIgZmxhdm9yID0gdGhpcy5nYW1lLmFkZC50ZXh0KDAsIDAsIGZsYXZvclRleHQsIGZsYXZvclByb3BzKTtcbiAgICBmbGF2b3IueCA9ICh0aGlzLmdhbWUud2lkdGggLyAyKSAtIChmbGF2b3Iud2lkdGggLyAyKTtcbiAgICBmbGF2b3IueSA9IHRleHQueSAtIDIwMDtcblxuICAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uRG93biwgdGhpcyk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnNjb3JlRG9uZSkge1xuICAgICAgdGhpcy51cGRhdGVDbnQgKz0gMTtcblxuICAgICAgaWYgKHRoaXMudXBkYXRlQ250ICUgdGhpcy5jb3VudGVyID09PSAwKVxuICAgICAgICB0aGlzLnNjb3JlVGV4dC5zZXRUZXh0KHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgNTAwMCkpO1xuXG4gICAgICBpZiAodGhpcy51cGRhdGVDbnQgJSAyMCA9PT0gMCkgdGhpcy5jb3VudGVyKys7XG4gICAgICBpZiAodGhpcy5jb3VudGVyID49IDIwKSB7XG4gICAgICAgIHRoaXMuc2NvcmVUZXh0LnNldFRleHQoMCk7XG4gICAgICAgIHRoaXMuc2NvcmVUZXh0LnggPSAodGhpcy5nYW1lLndpZHRoIC8gMikgLSAodGhpcy5zY29yZVRleHQud2lkdGggLyAyKTtcbiAgICAgICAgdGhpcy5lbWl0dGVyID0gdGhpcy5nYW1lLmFkZC5lbWl0dGVyKHRoaXMuc2NvcmVUZXh0LnggKyAodGhpcy5zY29yZVRleHQud2lkdGggLyAyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2NvcmVUZXh0LnkgKyAodGhpcy5zY29yZVRleHQuaGVpZ2h0IC8gMiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMDApO1xuICAgICAgICB0aGlzLmVtaXR0ZXIubWFrZVBhcnRpY2xlcygnc3BhcmsnKTtcbiAgICAgICAgdGhpcy5lbWl0dGVyLnN0YXJ0KGZhbHNlLCAxNTAwLCA3NSk7XG4gICAgICAgIHRoaXMuc2NvcmVEb25lID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50YWRhLnBsYXkoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5zY29yZVRleHQueCA9ICh0aGlzLmdhbWUud2lkdGggLyAyKSAtICh0aGlzLnNjb3JlVGV4dC53aWR0aCAvIDIpO1xuICAgIH1cbiAgfSxcblxuICByZXNldDogZnVuY3Rpb24oKSB7XG4gICAgd2luZG93LkxpdmVzID0gODtcbiAgICB3aW5kb3cuU3BlZWRNdWx0aXBsZXIgPSAxO1xuICAgIHdpbmRvdy5HYW1lcyA9IDA7XG4gICAgd2luZG93LlBsYXllZEdhbWVzID0gMDtcbiAgICB3aW5kb3cuU2NvcmUgPSAwO1xuICB9LFxuXG4gIG9uRG93bjogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5zY29yZURvbmUpIHJldHVybjtcbiAgICB0aGlzLnJlc2V0KCk7XG5cbiAgICBpZiAoIXRoaXMuZ2FtZS5kZXZpY2UuZGVza3RvcCkge1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLmZ1bGxTY3JlZW5TY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLnN0YXJ0RnVsbFNjcmVlbih0cnVlKTtcbiAgICB9XG5cbiAgICB0aGlzLnJlc3RhcnRHYW1lKCk7XG4gIH0sXG5cbiAgcmVzdGFydEdhbWU6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmdhbWUuZGV2aWNlLmRlc2t0b3ApIHtcbiAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnd2FybmluZycpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ1NBR0RYJyk7XG4gICAgfVxuICB9XG59O1xuIiwidmFyIE1lbnUgPSBmdW5jdGlvbiAoKSB7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1lbnU7XG5cbk1lbnUucHJvdG90eXBlID0ge1xuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gJyNmZmZmZmYnO1xuXG4gICAgdmFyIHN0YXJ0VGV4dCA9IFwiUHJlc3MgdG8gc3RhcnQhXCI7XG4gICAgdmFyIHRleHRQcm9wcyA9IHsgZm9udDogJzI0cHQgQXJpYWwnLFxuICAgICAgICAgICAgICAgICAgICAgIGZpbGw6ICcjQzI0MzAwJyxcbiAgICAgICAgICAgICAgICAgICAgICBzdHJva2VUaGlja25lc3M6IDAgfTtcblxuICAgIHZhciBjaW5kZXJMb2dvVyA9IHRoaXMuZ2FtZS5jYWNoZS5nZXRJbWFnZSgnY2luZGVyTG9nbycpLndpZHRoO1xuICAgIHZhciBjaW5kZXJMb2dvSCA9IHRoaXMuZ2FtZS5jYWNoZS5nZXRJbWFnZSgnY2luZGVyTG9nbycpLmhlaWdodDtcblxuICAgIHZhciB4ID0gKHRoaXMuZ2FtZS53aWR0aCAvIDIpIC0gKGNpbmRlckxvZ29XIC8gMik7XG4gICAgdmFyIHkgPSAodGhpcy5nYW1lLmhlaWdodCAvIDMpIC0gKGNpbmRlckxvZ29IIC8gMik7XG5cbiAgICB0aGlzLmdhbWUuYWRkLnNwcml0ZSh4LCB5LCAnY2luZGVyTG9nbycpO1xuICAgIHRoaXMuZ2FtZS5hZGQudGV4dCh4LCB5ICsgY2luZGVyTG9nb0ggKiAxLjUsIHN0YXJ0VGV4dCwgdGV4dFByb3BzKTtcblxuICAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uRG93biwgdGhpcyk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gIH0sXG5cbiAgb25Eb3duOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmdhbWUuZGV2aWNlLmRlc2t0b3ApIHtcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5mdWxsU2NyZWVuU2NhbGVNb2RlID0gUGhhc2VyLlNjYWxlTWFuYWdlci5TSE9XX0FMTDtcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5zdGFydEZ1bGxTY3JlZW4odHJ1ZSk7XG4gICAgfVxuXG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gIH1cbn07XG4iLCJ2YXIgVGV4dE1hbmFnZXIgPSByZXF1aXJlKCcuLi91dGlsaXRpZXMvVGV4dE1hbmFnZXIuanMnKTtcbnZhciBJbnRlcnN0aXRpYWwgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9JbnRlcnN0aXRpYWwuanMnKTtcbnZhciBUaW1lciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL1RpbWVyLmpzJyk7XG5cbnZhciBNZXJtYWlkR2FtZSA9IGZ1bmN0aW9uICgpIHtcbn07XG5cbk1lcm1haWRHYW1lLnByb3RvdHlwZSA9IHtcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLmJhZCA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ2JhZCcpO1xuICAgIHRoaXMuZ29vZCA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ2dvb2QnKTtcbiAgICB0aGlzLndhYmFuZyA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ3dhYmFuZycpO1xuXG4gICAgdGhpcy5nYW1lVGltZSA9IDQwMDA7XG4gICAgdGhpcy5UZXh0TWFuYWdlciA9IG5ldyBUZXh0TWFuYWdlcih0aGlzLmdhbWUpO1xuICAgIHRoaXMuVGltZXIgPSBudWxsO1xuICAgIHRoaXMuZ2FtZS5zdGFnZS5iYWNrZ3JvdW5kQ29sb3IgPSAnIzMyN2VkMCc7XG5cbiAgICB0aGlzLmZpbHRlciA9IG5ldyBQaGFzZXIuRmlsdGVyKHRoaXMuZ2FtZSwgbnVsbCwgd2F0ZXJTaGFkZXIpO1xuICAgIHRoaXMuZmlsdGVyLnNldFJlc29sdXRpb24odGhpcy5nYW1lLnN0YWdlLndpZHRoLCB0aGlzLmdhbWUuc3RhZ2UuaGVpZ2h0KTtcblxuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICB0aGlzLmNsYW1SZWFkeSA9IGZhbHNlO1xuICAgIHRoaXMudnVsbiA9ICF0aGlzLmNsYW1SZWFkeTtcbiAgICB0aGlzLmxvc3QgPSBmYWxzZTtcbiAgICB0aGlzLmF0dGFja2VkID0gZmFsc2U7XG5cbiAgICB0aGlzLmNsYW0gPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSh0aGlzLmdhbWUud2lkdGggLyAzLCB0aGlzLmdhbWUuaGVpZ2h0IC8gMywgJ2NsYW0nKTtcbiAgICB0aGlzLmNsYW0uYW5pbWF0aW9ucy5hZGQoJ3NodXQnKTtcbiAgICB0aGlzLmNsYW0uYW5pbWF0aW9ucy5hZGQoJ29wZW4nLCBbMywgMiwgMSwgMF0pO1xuXG4gICAgdGhpcy5hdHRhY2tlcnMgPSBbXTtcbiAgICB0aGlzLmZpc2ggPSBbXTtcblxuICAgIHZhciBmaXNoQ291bnQgPSBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogNCkgKyAxKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpc2hDb3VudDsgaSsrKSB7XG4gICAgICB2YXIgeU9mZnNldCA9IE1hdGguZmxvb3IoKE1hdGgucmFuZG9tKCkgKiAxNTApICsgNTApO1xuICAgICAgdmFyIGJhc2VYID0gKGkgPT0gMCB8fCBpID09IDIpID8gNjQgOiB0aGlzLmdhbWUud2lkdGggLSAxMDA7XG4gICAgICB2YXIgYmFzZVkgPSAoaSA9PSAzIHx8IGkgPT0gMikgPyB0aGlzLmdhbWUuaGVpZ2h0IC0gNjQgLSB5T2Zmc2V0IDogNjQgKyB5T2Zmc2V0O1xuXG4gICAgICB2YXIgZmlzaFRtcCA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKGJhc2VYLCBiYXNlWSwgJ2Zpc2gnKTtcbiAgICAgIGZpc2hUbXAuYW5jaG9yLnNldFRvKDAuNSwgMSk7XG4gICAgICBmaXNoVG1wLmFuaW1hdGlvbnMuYWRkKCdzd2ltJyk7XG4gICAgICBmaXNoVG1wLmFuaW1hdGlvbnMucGxheSgnc3dpbScsIDUsIHRydWUpO1xuICAgICAgZmlzaFRtcC5hdHRhY2tlciA9IChNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogMTApICsgMSkpID4gNztcbiAgICAgIGZpc2hUbXAuZmFjaW5nTGVmdCA9IChNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogMikgKyAxKSkgPiAxO1xuXG4gICAgICBpZiAoIWZpc2hUbXAuZmFjaW5nTGVmdClcbiAgICAgICAgZmlzaFRtcC5zY2FsZS54ID0gLTE7XG5cbiAgICAgIGlmICh0aGlzLmF0dGFja2Vycy5sZW5ndGggPT0gMCAmJiBpID09IGZpc2hDb3VudCAtIDEpXG4gICAgICAgIGZpc2hUbXAuYXR0YWNrZXIgPSB0cnVlO1xuXG4gICAgICBpZiAoZmlzaFRtcC5hdHRhY2tlcikge1xuICAgICAgICB2YXIgY291bnREb3duID0gdGhpcy5nYW1lVGltZSAtXG4gICAgICAgICAgICAgIChNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogKHRoaXMuZ2FtZVRpbWUgLyAyKSkgKyAxKSk7XG4gICAgICAgIGZpc2hUbXAudGltZSA9IGNvdW50RG93bjtcbiAgICAgICAgZmlzaFRtcC5hdHRhY2tlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmF0dGFja2Vycy5wdXNoKGZpc2hUbXApO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmZpc2gucHVzaChmaXNoVG1wKTtcbiAgICB9XG5cbiAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5vbkRvd24sIHRoaXMpO1xuICAgIHRoaXMuY2xhbUNvb2xkb3duID0gMjAwMDtcbiAgICB0aGlzLmNsYW1Eb3duID0gNzUwO1xuXG4gICAgdGhpcy5pbnRlciA9IG5ldyBJbnRlcnN0aXRpYWwodGhpcy5nYW1lLCBcIlBST1RFQ1QgVEhFIENMQU1cIiwgMTUwMCwgZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmludGVyLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMucmVhZHkgPSB0cnVlO1xuICAgICAgdGhpcy5jbGFtUmVhZHkgPSB0cnVlO1xuICAgICAgdmFyIGZpbHRlclNwcml0ZSA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKCk7XG4gICAgICBmaWx0ZXJTcHJpdGUud2lkdGggPSB0aGlzLmdhbWUuc3RhZ2Uud2lkdGg7XG5cdCAgICBmaWx0ZXJTcHJpdGUuaGVpZ2h0ID0gdGhpcy5nYW1lLnN0YWdlLmhlaWdodDtcbiAgICAgIGZpbHRlclNwcml0ZS5maXhlZFRvQ2FtZXJhID0gZmFsc2U7XG5cdCAgICBmaWx0ZXJTcHJpdGUuZmlsdGVycyA9IFsgdGhpcy5maWx0ZXIgXTtcbiAgICAgIHRoaXMuVGltZXIgPSBuZXcgVGltZXIodGhpcy5nYW1lLCB0aGlzLmdhbWVUaW1lLCB0aGlzLm9uVGltZXJDb21wbGV0ZSwgdGhpcywgdHJ1ZSk7XG4gICAgICB0aGlzLlRpbWVyLnN0YXJ0KCk7XG4gICAgfSwgdGhpcyk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnJlYWR5KVxuICAgICAgcmV0dXJuO1xuXG4gICAgdGhpcy5maWx0ZXIudXBkYXRlKHRoaXMuZ2FtZS5pbnB1dC5hY3RpdmVQb2ludGVyKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYXR0YWNrZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5UaW1lci50aW1lci50aW1lci5kdXJhdGlvbiA8PSB0aGlzLmF0dGFja2Vyc1tpXS50aW1lICYmXG4gICAgICAgICAgdGhpcy5UaW1lci50aW1lci50aW1lci5kdXJhdGlvbiAhPSAwICYmXG4gICAgICAgICAgIXRoaXMuYXR0YWNrZXJzW2ldLmF0dGFja2VkKSB7XG4gICAgICAgIHRoaXMuYXR0YWNrZXJzW2ldLmF0dGFja2VkID0gdHJ1ZTtcblxuICAgICAgICBpZiAodGhpcy5hdHRhY2tlcnNbaV0ueCA8IHRoaXMuY2xhbS54ICYmXG4gICAgICAgICAgICB0aGlzLmF0dGFja2Vyc1tpXS5mYWNpbmdMZWZ0KVxuICAgICAgICAgIHRoaXMuYXR0YWNrZXJzW2ldLnNjYWxlLnggPSAtMTtcbiAgICAgICAgZWxzZSBpZiAodGhpcy5hdHRhY2tlcnNbaV0ueCA+IHRoaXMuY2xhbS54ICYmXG4gICAgICAgICAgICAgICAgICF0aGlzLmF0dGFja2Vyc1tpXS5mYWNpbmdMZWZ0KVxuICAgICAgICAgIHRoaXMuYXR0YWNrZXJzW2ldLnNjYWxlLnggPSAxO1xuXG4gICAgICAgIHZhciB0d2VlbiA9IHRoaXMuZ2FtZS5hZGQudHdlZW4odGhpcy5hdHRhY2tlcnNbaV0pXG4gICAgICAgICAgICAgIC50byh7IHg6IHRoaXMuY2xhbS54ICsgKHRoaXMuY2xhbS53aWR0aCAvIDIuNSksXG4gICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuY2xhbS55ICsgKHRoaXMuY2xhbS5oZWlnaHQgLyAyKSB9LFxuICAgICAgICAgICAgICAgICAgNzYwIC0gKHdpbmRvdy5TcGVlZE11bHRpcGxpZXIgKiAyMCksXG4gICAgICAgICAgICAgICAgICBQaGFzZXIuRWFzaW5nLkxpbmVhci5Ob25lLFxuICAgICAgICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICAgICAgICAxMDAgLSAod2luZG93LlNwZWVkTXVsdGlwbGVyICogMjApKVxuICAgICAgICAgICAgICAuc3RhcnQoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuYXR0YWNrZXJzW2ldLmF0dGFja2VkKSB7XG4gICAgICAgIHZhciBib3VuZHNDbGFtID0gUGhhc2VyLlJlY3RhbmdsZS5pbmZsYXRlKHRoaXMuY2xhbS5nZXRCb3VuZHMoKSwgLTcwLCAtODApO1xuICAgICAgICBib3VuZHNDbGFtLnkgKz0gMjA7XG4gICAgICAgIGJvdW5kc0NsYW0ueCAtPSAyNTtcbiAgICAgICAgdmFyIGJvdW5kc0F0dGFja2VyID0gdGhpcy5hdHRhY2tlcnNbaV0uZ2V0Qm91bmRzKCk7XG5cbiAgICAgICAgaWYgKFBoYXNlci5SZWN0YW5nbGUuaW50ZXJzZWN0cyhib3VuZHNDbGFtLCBib3VuZHNBdHRhY2tlcikpIHtcbiAgICAgICAgICBpZiAodGhpcy52dWxuKSB7XG4gICAgICAgICAgICB0aGlzLmxvc3QgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdG1wID0gdGhpcy5hdHRhY2tlcnNbaV07XG4gICAgICAgICAgICB2YXIgcnVuID0gdGhpcy5nYW1lLmFkZC50d2Vlbih0bXApXG4gICAgICAgICAgICAgICAgICAudG8oeyB4OiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLmdhbWUud2lkdGgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgeTogLTEwMCB9LFxuICAgICAgICAgICAgICAgICAgICAgIDg1MCxcbiAgICAgICAgICAgICAgICAgICAgICBQaGFzZXIuRWFzaW5nLkxpbmVhci5Ob25lLFxuICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgIDApO1xuICAgICAgICAgICAgcnVuLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uKCkgeyB0bXAuZGVzdHJveSgpOyB9KTtcbiAgICAgICAgICAgIHJ1bi5zdGFydCgpO1xuICAgICAgICAgICAgdGhpcy5hdHRhY2tlcnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5maXNoLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIXRoaXMuZmlzaFtpXS5hdHRhY2tlZCkge1xuICAgICAgaWYgKHRoaXMuZmlzaFtpXS54ID4gdGhpcy5nYW1lLndpZHRoIHx8XG4gICAgICAgICAgdGhpcy5maXNoW2ldLnggPCAwKSB7XG4gICAgICAgIHRoaXMuZmlzaFtpXS5mYWNpbmdMZWZ0ID0gIXRoaXMuZmlzaFtpXS5mYWNpbmdMZWZ0O1xuICAgICAgICB0aGlzLmZpc2hbaV0uc2NhbGUueCAqPSAtMTtcbiAgICAgIH1cblxuICAgICAgdmFyIGRpciA9IDAuNTtcbiAgICAgIGlmICh0aGlzLmZpc2hbaV0uZmFjaW5nTGVmdClcbiAgICAgICAgZGlyICo9IC0xO1xuICAgICAgdGhpcy5maXNoW2ldLnggKz0gZGlyO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBvblRpbWVyQ29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMubG9zdClcbiAgICAgIHRoaXMud2luKCk7XG4gICAgZWxzZVxuICAgICAgdGhpcy5sb3NlKCk7XG4gIH0sXG5cbiAgbG9zZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYmFkLnBsYXkoKTtcbiAgICB0aGlzLnJlYWR5ID0gZmFsc2U7XG4gICAgd2luZG93LlNjb3JlIC09IDEwMDtcbiAgICB3aW5kb3cuTGl2ZXMgLT0gMjtcbiAgICB0aGlzLlRleHRNYW5hZ2VyLnN0YXR1c1RleHQoXCJMT1NFIVwiKTtcbiAgICB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKDQwMDAsIHRoaXMuZW5kLCB0aGlzKTtcbiAgfSxcblxuICB3aW46IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmdvb2QucGxheSgpO1xuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICB3aW5kb3cuU3BlZWRNdWx0aXBsaWVyICs9IDAuNTtcbiAgICB3aW5kb3cuU2NvcmUgKz0gMTAwO1xuICAgIHRoaXMuVGV4dE1hbmFnZXIuc3RhdHVzVGV4dChcIldJTiFcIik7XG4gICAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCg0MDAwLCB0aGlzLmVuZCwgdGhpcyk7XG4gIH0sXG5cbiAgb25Eb3duOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnJlYWR5IHx8ICF0aGlzLmNsYW1SZWFkeSlcbiAgICAgIHJldHVybjtcblxuICAgIHRoaXMuY2xhbS5hbmltYXRpb25zLnBsYXkoJ3NodXQnLCAyMCk7XG4gICAgdGhpcy53YWJhbmcucGxheSgpO1xuICAgIHRoaXMuY2xhbVJlYWR5ID0gZmFsc2U7XG4gICAgdGhpcy52dWxuID0gZmFsc2U7XG4gICAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCh0aGlzLmNsYW1Db29sZG93biwgZnVuY3Rpb24oKSB7IHRoaXMuY2xhbVJlYWR5ID0gdHJ1ZTsgfS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKHRoaXMuY2xhbURvd24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGFtLmFuaW1hdGlvbnMucGxheSgnb3BlbicsIDIwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52dWxuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgZW5kOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gJyNmZmZmZmYnO1xuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnR2FtZScpO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1lcm1haWRHYW1lO1xuXG52YXIgd2F0ZXJTaGFkZXIgPSBbXG4gICAgXCJwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDtcIixcbiAgICBcInVuaWZvcm0gZmxvYXQgICAgIHRpbWU7XCIsXG4gICAgXCJ1bmlmb3JtIHZlYzIgICAgICByZXNvbHV0aW9uO1wiLFxuICAgIFwidW5pZm9ybSB2ZWMyICAgICAgbW91c2U7XCIsXG4gICAgXCIjZGVmaW5lIE1BWF9JVEVSIDRcIixcbiAgICBcInZvaWQgbWFpbiggdm9pZCApXCIsXG4gICAgXCJ7XCIsXG4gICAgICAgIFwidmVjMiB2X3RleENvb3JkID0gZ2xfRnJhZ0Nvb3JkLnh5IC8gcmVzb2x1dGlvbjtcIixcbiAgICAgICAgXCJ2ZWMyIHAgPSAgdl90ZXhDb29yZCAqIDguMCAtIHZlYzIoMjAuMCk7XCIsXG4gICAgICAgIFwidmVjMiBpID0gcDtcIixcbiAgICAgICAgXCJmbG9hdCBjID0gMC44O1wiLFxuICAgICAgICBcImZsb2F0IGludGVuID0gLjAzO1wiLFxuICAgICAgICBcImZvciAoaW50IG4gPSAwOyBuIDwgTUFYX0lURVI7IG4rKylcIixcbiAgICAgICAgXCJ7XCIsXG4gICAgICAgICAgICBcImZsb2F0IHQgPSB0aW1lICogKDEuMCAtICgzLjAgLyBmbG9hdChuKzEpKSk7XCIsXG4gICAgICAgICAgICBcImkgPSBwICsgdmVjMihjb3ModCAtIGkueCkgKyBzaW4odCArIGkueSksXCIsXG4gICAgICAgICAgICBcInNpbih0IC0gaS55KSArIGNvcyh0ICsgaS54KSk7XCIsXG4gICAgICAgICAgICBcImMgKz0gMS4wL2xlbmd0aCh2ZWMyKHAueCAvIChzaW4oaS54K3QpL2ludGVuKSxcIixcbiAgICAgICAgICAgIFwicC55IC8gKGNvcyhpLnkrdCkvaW50ZW4pKSk7XCIsXG4gICAgICAgIFwifVwiLFxuICAgICAgICBcImMgLz0gZmxvYXQoTUFYX0lURVIpO1wiLFxuICAgICAgICBcImMgPSAxLjUgLSBzcXJ0KGMpO1wiLFxuICAgICAgICBcInZlYzQgdGV4Q29sb3IgPSB2ZWM0KDAuMCwgMC4wMSwgMC4wMTUsIDAuMik7XCIsXG4gICAgICAgIFwidGV4Q29sb3IucmdiICo9ICgxLjAgLyAoMS4wIC0gKGMgKyAwLjA1KSkpO1wiLFxuICAgICAgICBcImdsX0ZyYWdDb2xvciA9IHRleENvbG9yO1wiLFxuICAgIFwifVwiXG5dO1xuIiwidmFyIENpbmRlclByb2ZpbGVzID0gcmVxdWlyZSgnLi4vZGF0YS9DaW5kZXJQcm9maWxlcy5qcycpO1xuXG52YXIgUHJlbG9hZGVyID0gZnVuY3Rpb24gKGdhbWUpIHtcbiAgdGhpcy5hc3NldCA9IG51bGw7XG4gIHRoaXMucmVhZHkgPSBmYWxzZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUHJlbG9hZGVyO1xuXG5QcmVsb2FkZXIucHJvdG90eXBlID0ge1xuXG4gIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXNzZXRSb290ID0gJ2Fzc2V0cy8nO1xuXG4gICAgdGhpcy5hc3NldCA9IHRoaXMuYWRkLnNwcml0ZSgzMjAsIDI0MCwgJ3ByZWxvYWRlcicpO1xuICAgIHRoaXMuYXNzZXQuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcblxuICAgIHRoaXMubG9hZC5vbkxvYWRDb21wbGV0ZS5hZGRPbmNlKHRoaXMub25Mb2FkQ29tcGxldGUsIHRoaXMpO1xuICAgIHRoaXMubG9hZC5zZXRQcmVsb2FkU3ByaXRlKHRoaXMuYXNzZXQpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnU0FHRFgnLCAnYXNzZXRzL3NhZ2R4X2xvZ28ucG5nJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdjaW5kZXJMb2dvJywgJ2Fzc2V0cy9jaW5kZXItbG9nby5wbmcnKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2NpbmRlckZyYW1lJywgJ2Fzc2V0cy9jaW5kZXItZnJhbWUucG5nJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdtYXRjaCcsICdhc3NldHMvaXRzX2FfbWF0Y2guanBnJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdub3BlJywgJ2Fzc2V0cy9OT1BFLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnbGlrZScsICdhc3NldHMvbGlrZS5wbmcnKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2hlYWRlcicsICdhc3NldHMvaGVhZGVyLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgneEJ1dHRvbicsICdhc3NldHMveF9idXR0b24ucG5nJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdoZWFydEJ1dHRvbicsICdhc3NldHMvaGVhcnRfYnV0dG9uLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgncmV2ZWFsVGV4dEFyZWEnLCAnYXNzZXRzL3JldmVhbF90ZXh0X2FyZWEuanBnJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCd0aW1lci1hbmltYXRpb24nLCAnYXNzZXRzL3RpbWVyLWFuaW1hdGlvbi5wbmcnKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2Zvb3QnLCAnYXNzZXRzL2Zvb3QucG5nJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdzbGlwcGVyJywgJ2Fzc2V0cy9zbGlwcGVyLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnc3BhcmsnLCAnYXNzZXRzL3BhcnRpY2xlLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgndGF4YmcnLCAnYXNzZXRzL3RheGJnLnBuZycpO1xuXG4gICAgdGhpcy5sb2FkLmltYWdlKCdoZWFydCcsICdhc3NldHMvaGVhcnQucG5nJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdzbWFsbGhlYXJ0JywgJ2Fzc2V0cy9oZWFydHNtYWxsLnBuZycpO1xuXG4gICAgdGhpcy5sb2FkLmltYWdlKCdmcm9nSGF1cycsICdhc3NldHMvZnJvZ2hhdXNfY29sb3IuanBnJyk7XG4gICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdmcm9nUGxheWVyJywgJ2Fzc2V0cy9uYWtlZF9ydW5uZXIucG5nJywgMTYwLCAxOTAsIDMpO1xuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnZnJvZ0NoYXNlcicsICdhc3NldHMvZnJvZ3J1bi5wbmcnLCAxNTIsIDE4OSwgNCk7XG4gICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdsZWZ0U2hvZScsICdhc3NldHMvbGVmdF9zaG9lLnBuZycsIDQ4LCAxMTAsIDMpO1xuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgncmlnaHRTaG9lJywgJ2Fzc2V0cy9yaWdodF9zaG9lLnBuZycsIDQ4LCAxMTAsIDMpO1xuICAgIHRoaXMuZ2FtZS5sb2FkLmF1ZGlvKCdibGlwJywgJ2Fzc2V0cy9zb3VuZHMvYmxpcC5tcDMnKTtcblxuICAgIHRoaXMubG9hZC5pbWFnZSgnc25ha2VCaXRlJywgJ2Fzc2V0cy9zbmFrZV9iaXRlLnBuZycpO1xuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnc25ha2UnLCAnYXNzZXRzL3NuYWtlX3Nwcml0ZS5wbmcnLCAxNzMsIDQxNiwgMik7XG4gICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdjb25kb20nLCAnYXNzZXRzL2NvbmRvbV9zcHJpdGUucG5nJywgMjA4LCA0OTksIDQpO1xuICAgIHRoaXMuZ2FtZS5sb2FkLmF1ZGlvKCdoaXNzJywgJ2Fzc2V0cy9zb3VuZHMvaGlzcy5tcDMnKTtcblxuICAgIHRoaXMubG9hZC5pbWFnZSgnY29zYnlCZycsICdhc3NldHMvY29zYnlfYmcuanBnJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdjdXAnLCAnYXNzZXRzL3NvbG9fY3VwLnBuZycpO1xuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgncGlsbCcsICdhc3NldHMvcGlsbC5wbmcnLCA1MCwgNTAsIDYpO1xuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnc3BsYXNoJywgJ2Fzc2V0cy9zcGxhc2gucG5nJywgMjUwLCA5MCwgNCk7XG5cbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3RjaEJhY2tncm91bmQnLCAnYXNzZXRzL3RjaF9iZy5qcGcnKTtcbiAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ3Zhc2UnLCAnYXNzZXRzL3Zhc2UucG5nJywgMjksIDQwLCAyKTtcbiAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2JvdHRsZScsICdhc3NldHMvYm90dGxlLnBuZycsIDM1LCAzNSwgMik7XG4gICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdjb2F0UmFjaycsICdhc3NldHMvY29hdF9yYWNrLnBuZycsIDUzLCAxNzYsIDIpO1xuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnY2F0JywgJ2Fzc2V0cy9jYXQucG5nJywgNTMsIDI0LCA0KTtcbiAgICB0aGlzLmdhbWUubG9hZC5hdWRpbygnY3Jhc2gnLCAnYXNzZXRzL3NvdW5kcy9jcmFzaC5tcDMnKTtcblxuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnY2xhbScsICdhc3NldHMvY2xhbS5wbmcnLCAyMDIsIDIxNSwgNCk7XG4gICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdmaXNoJywgJ2Fzc2V0cy9maXNoLnBuZycsIDc1LCA1MCwgNCk7XG5cbiAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ3NrZWxseScsICdhc3NldHMvc2tlbGx5LnBuZycsIDM4MywgNTAwLCA2KTtcbiAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ3VwLWFycm93JywgJ2Fzc2V0cy91cC1hcnJvdy5wbmcnLCA1MCwgOTAsIDQpO1xuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnZG93bi1hcnJvdycsICdhc3NldHMvZG93bi1hcnJvdy5wbmcnLCA1MCwgOTAsIDQpO1xuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgncmlnaHQtYXJyb3cnLCAnYXNzZXRzL3JpZ2h0LWFycm93LnBuZycsIDkwLCA1MCwgNCk7XG4gICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdsZWZ0LWFycm93JywgJ2Fzc2V0cy9sZWZ0LWFycm93LnBuZycsIDkwLCA1MCwgNCk7XG4gICAgdGhpcy5nYW1lLmxvYWQuYXVkaW8oJ3lheScsICdhc3NldHMvc291bmRzL3lheS1kaW5nLm1wMycpO1xuICAgIHRoaXMuZ2FtZS5sb2FkLmF1ZGlvKCdib28nLCAnYXNzZXRzL3NvdW5kcy9ib28tZGluZy5tcDMnKTtcblxuICAgIHRoaXMuZ2FtZS5sb2FkLmF1ZGlvKCdnb29kJywgJ2Fzc2V0cy9zb3VuZHMvZ29vZC53YXYnKTtcbiAgICB0aGlzLmdhbWUubG9hZC5hdWRpbygnYmFkJywgJ2Fzc2V0cy9zb3VuZHMvYmFkLndhdicpO1xuICAgIHRoaXMuZ2FtZS5sb2FkLmF1ZGlvKCd3YWJhbmcnLCAnYXNzZXRzL3NvdW5kcy93YS1iYW5nLndhdicpO1xuICAgIHRoaXMuZ2FtZS5sb2FkLmF1ZGlvKCdiZ011c2ljJywgJ2Fzc2V0cy9zb3VuZHMvc2FnZHgubXAzJyk7XG4gICAgdGhpcy5nYW1lLmxvYWQuYXVkaW8oJ3RhZGEnLCAnYXNzZXRzL3NvdW5kcy90YWRhLm1wMycpO1xuXG4gICAgdGhpcy5sb2FkLm9uTG9hZENvbXBsZXRlLmFkZE9uY2UodGhpcy5vbkxvYWRDb21wbGV0ZSwgdGhpcyk7XG4gICAgdGhpcy5sb2FkLnNldFByZWxvYWRTcHJpdGUodGhpcy5hc3NldCk7XG5cbiAgICB3aW5kb3cuQ3VycmVudFByb2ZpbGVJZHggPSAtMTtcbiAgICB3aW5kb3cuQ2luZGVyUHJvZmlsZXMgPSB0aGlzLnNodWZmbGVQcm9maWxlcygpO1xuXG4gICAgdGhpcy5sb2FkLmltYWdlKCdjaW5kZXJMb2dvJywgYXNzZXRSb290ICsgJ2NpbmRlci1sb2dvLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnY2luZGVyRnJhbWUnLCBhc3NldFJvb3QgKyAnY2luZGVyLWZyYW1lLnBuZycpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aW5kb3cuQ2luZGVyUHJvZmlsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBwcm9maWxlID0gd2luZG93LkNpbmRlclByb2ZpbGVzW2ldO1xuICAgICAgdGhpcy5sb2FkLmltYWdlKHByb2ZpbGUuaW1hZ2UsIGFzc2V0Um9vdCArIHByb2ZpbGUuaW1hZ2UpO1xuICAgICAgdGhpcy5sb2FkLmltYWdlKHByb2ZpbGUucmV2ZWFsSW1hZ2UsIGFzc2V0Um9vdCArIHByb2ZpbGUucmV2ZWFsSW1hZ2UpO1xuICAgICAgaWYoISFwcm9maWxlLnJldmVhbEltYWdlMikgdGhpcy5sb2FkLmltYWdlKHByb2ZpbGUucmV2ZWFsSW1hZ2UyLCBhc3NldFJvb3QgKyBwcm9maWxlLnJldmVhbEltYWdlMik7XG4gICAgfVxuICB9LFxuXG4gIHNodWZmbGVQcm9maWxlczogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGN1cnJlbnRJZHggPSBDaW5kZXJQcm9maWxlcy5QUk9GSUxFUy5sZW5ndGgsIHRtcCwgcmFuZG9tSWR4O1xuXG4gICAgd2hpbGUgKDAgIT09IGN1cnJlbnRJZHgpIHtcbiAgICAgIHJhbmRvbUlkeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGN1cnJlbnRJZHgpO1xuICAgICAgY3VycmVudElkeCAtPSAxO1xuXG4gICAgICB0bXAgPSBDaW5kZXJQcm9maWxlcy5QUk9GSUxFU1tjdXJyZW50SWR4XTtcbiAgICAgIENpbmRlclByb2ZpbGVzLlBST0ZJTEVTW2N1cnJlbnRJZHhdID0gQ2luZGVyUHJvZmlsZXMuUFJPRklMRVNbcmFuZG9tSWR4XTtcbiAgICAgIENpbmRlclByb2ZpbGVzLlBST0ZJTEVTW3JhbmRvbUlkeF0gPSB0bXA7XG4gICAgfVxuXG4gICAgcmV0dXJuIENpbmRlclByb2ZpbGVzLlBST0ZJTEVTO1xuICB9LFxuXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYXNzZXQuY3JvcEVuYWJsZWQgPSBmYWxzZTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoISF0aGlzLnJlYWR5KSB7XG4gICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ0NsaWNrTWUnKTtcbiAgICB9XG4gIH0sXG5cbiAgb25Mb2FkQ29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcbiAgfVxufTtcbiIsInZhciBTQUdEWCA9IGZ1bmN0aW9uICgpIHtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gU0FHRFg7XG5cblNBR0RYLnByb3RvdHlwZSA9IHtcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYoIXdpbmRvdy5iZ011c2ljKSB7XG4gICAgICB3aW5kb3cuYmdNdXNpYyA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ2JnTXVzaWMnKTtcbiAgICAgIHdpbmRvdy5iZ011c2ljLnBsYXkoJycsIDAsIDAuNywgdHJ1ZSk7XG4gICAgfVxuICAgIHRoaXMuYmx1ZSA9IHRydWU7XG4gICAgdGhpcy5nYW1lLnN0YWdlLmJhY2tncm91bmRDb2xvciA9ICcjOUNENEU2JztcblxuICAgIHZhciBsb2dvVyA9IHRoaXMuZ2FtZS5jYWNoZS5nZXRJbWFnZSgnU0FHRFgnKS53aWR0aDtcbiAgICB2YXIgbG9nb0ggPSB0aGlzLmdhbWUuY2FjaGUuZ2V0SW1hZ2UoJ1NBR0RYJykuaGVpZ2h0O1xuXG4gICAgdmFyIHggPSAodGhpcy5nYW1lLndpZHRoIC8gMikgLSAobG9nb1cgLyAyKTtcbiAgICB2YXIgeSA9ICh0aGlzLmdhbWUuaGVpZ2h0IC8gMikgLSAobG9nb0ggLyAyKTtcblxuICAgIHRoaXMuZ2FtZS5hZGQuc3ByaXRlKHgsIHksICdTQUdEWCcpO1xuXG4gICAgdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMub25Eb3duLCB0aGlzKTtcbiAgICB0aGlzLnRpbWVvdXQgPSB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKDMwMDAsIHRoaXMuc3RhcnRHYW1lLCB0aGlzKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZih0aGlzLmJsdWUpIHtcbiAgICAgIHRoaXMuZ2FtZS5zdGFnZS5iYWNrZ3JvdW5kQ29sb3IgPSAnI0FDRTRGNic7XG4gICAgICB0aGlzLmJsdWUgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5nYW1lLnN0YWdlLmJhY2tncm91bmRDb2xvciA9ICcjOENDNEQ2JztcbiAgICAgIHRoaXMuYmx1ZSA9IHRydWU7XG4gICAgfVxuICB9LFxuXG4gIG9uRG93bjogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUuZnVsbFNjcmVlblNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc3RhcnRGdWxsU2NyZWVuKHRydWUpO1xuICAgIH1cblxuICAgIHRoaXMuc3RhcnRHYW1lKCk7XG4gIH0sXG5cbiAgc3RhcnRHYW1lOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ01lbnUnKTtcbiAgfVxufTtcbiIsInZhciBUZXh0TWFuYWdlciA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9UZXh0TWFuYWdlci5qcycpO1xudmFyIEludGVyc3RpdGlhbCA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL0ludGVyc3RpdGlhbC5qcycpO1xudmFyIFRpbWVyID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvVGltZXIuanMnKTtcbnZhciBTd2lwZU1hbmFnZXIgPSByZXF1aXJlKCcuLi91dGlsaXRpZXMvU3dpcGVNYW5hZ2VyLmpzJyk7XG5cbnZhciBTV0lQRVNfUEVSX1NUQUdFID0gNDtcbnZhciBCQVNFX1NUQUdFX1RJTUUgPSAxNjAwO1xuXG52YXIgU25ha2VHYW1lID0gZnVuY3Rpb24gKCkge1xufTtcblxuU25ha2VHYW1lLnByb3RvdHlwZSA9IHtcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5iYWQgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdiYWQnKTtcbiAgICB0aGlzLmdvb2QgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdnb29kJyk7XG4gICAgdGhpcy5oaXNzID0gdGhpcy5nYW1lLmFkZC5hdWRpbygnaGlzcycpO1xuXG4gICAgaWYgKCF0aGlzLmdhbWUuZGV2aWNlLmRlc2t0b3ApIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLmdvRnVsbHNjcmVlbiwgdGhpcyk7XG5cbiAgICB0aGlzLlRleHRNYW5hZ2VyID0gbmV3IFRleHRNYW5hZ2VyKHRoaXMuZ2FtZSk7XG5cbiAgICB0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gJyMyYjI1NDQnO1xuXG4gICAgdGhpcy5nYW1lLnBsdWdpbnMuYWRkKG5ldyBTd2lwZU1hbmFnZXIodGhpcy5nYW1lLCB0aGlzLnN3aXBlLCB0aGlzLCB0cnVlKSk7XG5cbiAgICB0aGlzLlRpbWVVcCA9IG5ldyBUaW1lcih0aGlzLmdhbWUsIDEwMDAwLCB0aGlzLm9uVGltZVVwLCB0aGlzKTtcblxuICAgIHRoaXMuc3RhZ2VUaW1lID0gQkFTRV9TVEFHRV9USU1FIC0gKHdpbmRvdy5TcGVlZE11bHRpcGxpZXIgKiAxMDApO1xuXG4gICAgdGhpcy5jb25kb21UaW1lciA9IG51bGw7XG5cbiAgICB0aGlzLnNuYWtlID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUoMCwgMTkwLCAnc25ha2UnKTtcbiAgICB0aGlzLmNvbmRvbSA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKDAsIDk1LCAnY29uZG9tJyk7XG5cbiAgICB0aGlzLmNvbmRvbVN0YXRlID0gMDtcbiAgICB0aGlzLnN3aXBlQ291bnQgPSAwO1xuXG4gICAgdGhpcy5zbmFrZS54ID0gKHRoaXMuZ2FtZS53aWR0aCAvIDIpIC0gKHRoaXMuc25ha2Uud2lkdGggLyAyKTtcbiAgICB0aGlzLmNvbmRvbS54ID0gKHRoaXMuZ2FtZS53aWR0aCAvIDIpIC0gKHRoaXMuY29uZG9tLndpZHRoIC8gMik7XG5cbiAgICB0aGlzLnNuYWtlLmFuaW1hdGlvbnMuYWRkKCd3cmlnZ2xlJyk7XG4gICAgdGhpcy5zbmFrZS5hbmltYXRpb25zLnBsYXkoJ3dyaWdnbGUnLCAxLjIgKiB3aW5kb3cuU3BlZWRNdWx0aXBsaWVyLCB0cnVlKTtcblxuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcblxuICAgIHRoaXMuaW50ZXIgPSBuZXcgSW50ZXJzdGl0aWFsKHRoaXMuZ2FtZSwgXCJXUkFQIElUIFVQXCIsIDE1MDAsIGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5pbnRlci5kZXN0cm95KCk7XG4gICAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcbiAgICAgIHRoaXMuVGltZVVwLnN0YXJ0KCk7XG4gICAgfSwgdGhpcyk7XG4gIH0sXG5cbiAgZ29GdWxsc2NyZWVuOiBmdW5jdGlvbigpIHtcbiAgICBpZih0aGlzLmdhbWUuc2NhbGUuaXNGdWxsU2NyZWVuKSByZXR1cm47XG4gICAgdGhpcy5nYW1lLnNjYWxlLmZ1bGxTY3JlZW5TY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuICAgIHRoaXMuZ2FtZS5zY2FsZS5zdGFydEZ1bGxTY3JlZW4odHJ1ZSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbigpIHtcbiAgICBpZiAoIXRoaXMucmVhZHkpIHJldHVybjtcbiAgfSxcblxuICBzd2lwZTogZnVuY3Rpb24oc3dpcGVEaXJlY3Rpb24pIHtcbiAgICBpZighdGhpcy5yZWFkeSkgcmV0dXJuO1xuXG4gICAgaWYgKHN3aXBlRGlyZWN0aW9uID09IFN3aXBlTWFuYWdlci5TV0lQRV9ESVJFQ1RJT05TLkRPV04pIHtcbiAgICAgIHRoaXMub25Td2lwZURvd24oKTtcbiAgICB9XG4gIH0sXG5cbiAgb25Td2lwZURvd246IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc3dpcGVDb3VudCsrO1xuICAgIGlmKHRoaXMuc3dpcGVDb3VudCA+PSBTV0lQRVNfUEVSX1NUQUdFKSB0aGlzLmNoYW5nZUNvbmRvbVN0YXRlKDEpO1xuICB9LFxuXG4gIHJlc3RhcnRDb25kb21UaW1lcjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRpbWVFdmVudHMgPSB0aGlzLmdhbWUudGltZS5ldmVudHM7XG4gICAgaWYodGhpcy5jb25kb21UaW1lcikgdGltZUV2ZW50cy5yZW1vdmUodGhpcy5jb25kb21UaW1lcik7XG5cbiAgICB0aGlzLmNvbmRvbVRpbWVyID0gdGltZUV2ZW50cy5hZGQodGhpcy5zdGFnZVRpbWUsIHRoaXMucmV0cmVhdENvbmRvbSwgdGhpcyk7XG4gIH0sXG5cbiAgcmV0cmVhdENvbmRvbTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5jaGFuZ2VDb25kb21TdGF0ZSgtMSk7XG4gIH0sXG5cbiAgY2hhbmdlQ29uZG9tU3RhdGU6IGZ1bmN0aW9uKGNoYW5nZSkge1xuICAgIGlmICghdGhpcy5yZWFkeSkgcmV0dXJuO1xuXG4gICAgdGhpcy5yZXN0YXJ0Q29uZG9tVGltZXIoKTtcblxuICAgIHRoaXMuc3dpcGVDb3VudCA9IDA7XG5cbiAgICB0aGlzLmNvbmRvbVN0YXRlICs9IGNoYW5nZTtcblxuICAgIGlmKHRoaXMuY29uZG9tU3RhdGUgPCAwKSB7XG4gICAgICB0aGlzLmNvbmRvbVN0YXRlID0gMDtcbiAgICAgIHJldHVybjtcbiAgICB9O1xuXG4gICAgdGhpcy5jb25kb20uZnJhbWUgPSB0aGlzLmNvbmRvbVN0YXRlO1xuXG4gICAgaWYodGhpcy5jb25kb21TdGF0ZSA+IDIpIHtcbiAgICAgIHRoaXMud2luKCk7XG4gICAgICByZXR1cm47XG4gICAgfTtcbiAgfSxcblxuICBvblRpbWVVcDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc25ha2VCaXRlKCk7XG4gICAgdGhpcy5sb3NlKCk7XG4gIH0sXG5cbiAgc25ha2VCaXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5nYW1lLmFkZC5pbWFnZSg4MCwgNDUsICdzbmFrZUJpdGUnKTtcbiAgICB0aGlzLmNvbmRvbS5hbmdsZSArPSAzNTtcbiAgfSxcblxuICBsb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5iYWQucGxheSgpO1xuICAgIHRoaXMuaGlzcy5wbGF5KCk7XG4gICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuICAgIHdpbmRvdy5TY29yZSAtPSAxMDA7XG4gICAgd2luZG93LkxpdmVzIC09IDI7XG4gICAgdGhpcy5UZXh0TWFuYWdlci5zdGF0dXNUZXh0KFwiTE9TRSFcIik7XG4gICAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCgyMDAwLCB0aGlzLmVuZCwgdGhpcyk7XG4gIH0sXG5cbiAgd2luOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5nb29kLnBsYXkoKTtcbiAgICB0aGlzLnJlYWR5ID0gZmFsc2U7XG4gICAgd2luZG93LlNwZWVkTXVsdGlwbGllciArPSAwLjU7XG4gICAgd2luZG93LlNjb3JlICs9IDEwMDtcbiAgICB0aGlzLlRleHRNYW5hZ2VyLnN0YXR1c1RleHQoXCJXSU4hXCIpO1xuICAgIHRoaXMuVGltZVVwLmVuZCgpO1xuICAgIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoMjAwMCwgdGhpcy5lbmQsIHRoaXMpO1xuICB9LFxuXG4gIGVuZDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gICAgdGhpcy5nYW1lLnN0YWdlLmJhY2tncm91bmRDb2xvciA9ICcjRkZGRkZGJztcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTbmFrZUdhbWU7XG4iLCJ2YXIgU3BsYXNoID0gZnVuY3Rpb24gKCkge1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTcGxhc2g7XG5cblNwbGFzaC5wcm90b3R5cGUgPSB7XG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICB9XG59OyIsInZhciBUZXh0TWFuYWdlciA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9UZXh0TWFuYWdlci5qcycpO1xudmFyIEludGVyc3RpdGlhbCA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL0ludGVyc3RpdGlhbC5qcycpO1xudmFyIFRpbWVyID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvVGltZXIuanMnKTtcbnZhciBCQVNFX0NBVF9YX1ZFTCA9IDIwMDtcbnZhciBCQVNFX0NBVF9ZX1ZFTCA9IDEwMDtcblxudmFyIENvbGxpZGFibGUgPSBmdW5jdGlvbihnYW1lLCB4LCB5LCBzcHJpdGUsIGJyb2tlbikge1xuICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgc3ByaXRlKTtcblxuICB0aGlzLm5hbWUgPSBzcHJpdGU7XG4gIHRoaXMuYnJva2VuID0gYnJva2VuO1xufVxuQ29sbGlkYWJsZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcbkNvbGxpZGFibGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ29sbGlkYWJsZTtcblxudmFyIFRoaXNDYXRJc0hvcnNlU2hpdCA9IGZ1bmN0aW9uICgpIHtcbn07XG5cblRoaXNDYXRJc0hvcnNlU2hpdC5wcm90b3R5cGUgPSB7XG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHRoaXMuY3Jhc2ggPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdjcmFzaCcpO1xuICAgIHRoaXMuZGluZyA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ3lheScpO1xuXG4gICAgdGhpcy5iYWQgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdiYWQnKTtcbiAgICB0aGlzLmdvb2QgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdnb29kJyk7XG5cbiAgICBpZiAoIXRoaXMuZ2FtZS5kZXZpY2UuZGVza3RvcCkgdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMuZ29GdWxsc2NyZWVuLCB0aGlzKTtcblxuICAgIHRoaXMuYmFja2dyb3VuZCA9IHRoaXMuZ2FtZS5hZGQuaW1hZ2UoMCwgMCwgJ3RjaEJhY2tncm91bmQnKTtcblxuICAgIHRoaXMuVGV4dE1hbmFnZXIgPSBuZXcgVGV4dE1hbmFnZXIodGhpcy5nYW1lKTtcbiAgICB0aGlzLlRpbWVyID0gbnVsbDtcblxuICAgIHRoaXMuZ2FtZS5waHlzaWNzLnN0YXJ0U3lzdGVtKFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XG5cbiAgICB0aGlzLmNhdCA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKDE5MiwgMzMwLCAnY2F0Jyk7XG5cbiAgICB0aGlzLmNvYXRSYWNrID0gdGhpcy5nYW1lLmFkZC5leGlzdGluZyhuZXcgQ29sbGlkYWJsZSh0aGlzLmdhbWUsIDUzLCAyMDUsICdjb2F0UmFjaycsIGZhbHNlKSk7XG4gICAgdGhpcy5ib3R0bGUgPSB0aGlzLmdhbWUuYWRkLmV4aXN0aW5nKG5ldyBDb2xsaWRhYmxlKHRoaXMuZ2FtZSwgMjU1LCAzMjAsICdib3R0bGUnLCBmYWxzZSkpO1xuICAgIHRoaXMudmFzZSA9IHRoaXMuZ2FtZS5hZGQuZXhpc3RpbmcobmV3IENvbGxpZGFibGUodGhpcy5nYW1lLCAzNjEsIDI3OSwgJ3Zhc2UnLCBmYWxzZSkpO1xuXG4gICAgdGhpcy5jb2xsaWRhYmxlcyA9IFt0aGlzLmNvYXRSYWNrLCB0aGlzLnZhc2UsIHRoaXMuYm90dGxlXTtcblxuICAgIHRoaXMuY2F0LmFuaW1hdGlvbnMuYWRkKCdydW4nKTtcbiAgICB0aGlzLmNhdC5hbmltYXRpb25zLnBsYXkoJ3J1bicsIDEwLCB0cnVlKTtcblxuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcblxuICAgIHRoaXMuaW50ZXIgPSBuZXcgSW50ZXJzdGl0aWFsKHRoaXMuZ2FtZSwgXCJUSElTIENBVCBJUyBIT1JTRVNISVRcIiwgMjAwMCwgZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmludGVyLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMucmVhZHkgPSB0cnVlO1xuICAgICAgdGhpcy5pbml0R2FtZSgpO1xuICAgICAgdGhpcy5UaW1lciA9IG5ldyBUaW1lcih0aGlzLmdhbWUsIDQ1MDAsIHRoaXMub25UaW1lVXAsIHRoaXMpO1xuICAgICAgdGhpcy5UaW1lci5zdGFydCgpO1xuICAgIH0sIHRoaXMpO1xuICB9LFxuXG4gIGluaXRHYW1lOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmdhbWUucGh5c2ljcy5hcmNhZGUuc2V0Qm91bmRzKDAsIDE1NCwgNDE0LCAyMjIpO1xuXG4gICAgdGhpcy5nYW1lLnBoeXNpY3MuZW5hYmxlKHRoaXMuY2F0LCBQaGFzZXIuUGh5c2ljcy5BUkNBREUpO1xuXG4gICAgdGhpcy5pbml0Q29sbGlkYWJsZXMoKTtcbiAgICB0aGlzLmluaXRDYXQoKTtcblxuICB9LFxuXG4gIGluaXRDb2xsaWRhYmxlczogZnVuY3Rpb24oKSB7XG4gICAgZm9yIChpIGluIHRoaXMuY29sbGlkYWJsZXMpIHtcbiAgICAgIHZhciBjb2xsaWRhYmxlID0gdGhpcy5jb2xsaWRhYmxlc1tpXTtcblxuICAgICAgdGhpcy5nYW1lLnBoeXNpY3MuZW5hYmxlKGNvbGxpZGFibGUsIFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XG4gICAgICBjb2xsaWRhYmxlLmJvZHkuaW1tb3ZhYmxlID0gdHJ1ZTtcblxuICAgICAgY29sbGlkYWJsZS5ldmVudHMub25JbnB1dERvd24uYWRkKHRoaXMub25DbGlja0NvbGxpZGFibGUgLCB0aGlzKTtcbiAgICAgIGNvbGxpZGFibGUuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICB9XG4gIH0sXG5cbiAgaW5pdENhdDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJhbmRYID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNTApO1xuICAgIHZhciByYW5kWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUwKTtcbiAgICB2YXIgcmFuZFhTaWduID0gKE1hdGgucmFuZG9tKCkgPiAuNSkgPyAxIDogLTE7XG4gICAgdmFyIHJhbmRZU2lnbiA9IChNYXRoLnJhbmRvbSgpID4gLjUpID8gMSA6IC0xO1xuXG4gICAgdmFyIHNwZWVkTW9kaWZpZXIgPSAoKHdpbmRvdy5TcGVlZE11bHRpcGxpZXIgLSAxKSAvIDIpICsgMTtcblxuICAgIHZhciB2ZWxYID0gKEJBU0VfQ0FUX1hfVkVMICsgcmFuZFggKiBzcGVlZE1vZGlmaWVyKSAqIHJhbmRYU2lnbjtcbiAgICB2YXIgdmVsWSA9IChCQVNFX0NBVF9ZX1ZFTCArIHJhbmRZICogc3BlZWRNb2RpZmllcikgKiByYW5kWVNpZ247XG5cbiAgICB0aGlzLmNhdC5ib2R5LnZlbG9jaXR5LnNldFRvKHZlbFgsIHZlbFkpO1xuXG4gICAgdGhpcy5jYXQuYm9keS5jb2xsaWRlV29ybGRCb3VuZHMgPSB0cnVlO1xuXG4gICAgdGhpcy5jYXQuYm9keS5ib3VuY2Uuc2V0KDEuMCk7XG4gIH0sXG5cbiAgb25DbGlja0NvbGxpZGFibGU6IGZ1bmN0aW9uKGNvbGxpZGFibGUpIHtcbiAgICBpZiAodGhpcy5yZWFkeSkge1xuICAgICAgY29sbGlkYWJsZS5icm9rZW4gPSBmYWxzZTtcbiAgICAgIGNvbGxpZGFibGUuZnJhbWUgPSAwO1xuICAgICAgdGhpcy5kaW5nLnBsYXkoKTtcbiAgICB9XG4gIH0sXG5cbiAgZ29GdWxsc2NyZWVuOiBmdW5jdGlvbigpIHtcbiAgICBpZih0aGlzLmdhbWUuc2NhbGUuaXNGdWxsU2NyZWVuKSByZXR1cm47XG4gICAgdGhpcy5nYW1lLnNjYWxlLmZ1bGxTY3JlZW5TY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuICAgIHRoaXMuZ2FtZS5zY2FsZS5zdGFydEZ1bGxTY3JlZW4odHJ1ZSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbigpIHtcbiAgICBpZiAoIXRoaXMucmVhZHkpIHJldHVybjtcblxuICAgIGZvcihpIGluIHRoaXMuY29sbGlkYWJsZXMpIHtcbiAgICAgIHZhciBjb2xsaWRhYmxlID0gdGhpcy5jb2xsaWRhYmxlc1tpXTtcbiAgICAgIHRoaXMuZ2FtZS5waHlzaWNzLmFyY2FkZS5vdmVybGFwKHRoaXMuY2F0LCBjb2xsaWRhYmxlLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5jcmFzaC5wbGF5KCcnLCAwLCAwLjIsIGZhbHNlKTtcbiAgICAgICAgY29sbGlkYWJsZS5icm9rZW4gPSB0cnVlO1xuICAgICAgICBjb2xsaWRhYmxlLmZyYW1lID0gMTtcbiAgICAgIH0sIG51bGwsIHRoaXMpO1xuICAgIH1cbiAgfSxcblxuICBvblRpbWVVcDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGJyb2tlbkl0ZW1zID0gMDtcblxuICAgIHRoaXMuY2F0LmJvZHkudmVsb2NpdHkuc2V0VG8oMCwwKTtcblxuICAgIGZvciAoaSBpbiB0aGlzLmNvbGxpZGFibGVzKSB7XG4gICAgICBpZih0aGlzLmNvbGxpZGFibGVzW2ldLmJyb2tlbikgcmV0dXJuIHRoaXMubG9zZSgpO1xuICAgIH1cblxuICAgIHRoaXMud2luKCk7XG4gIH0sXG5cbiAgbG9zZTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5iYWQucGxheSgpO1xuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICB3aW5kb3cuU2NvcmUgLT0gMTAwO1xuICAgIHdpbmRvdy5MaXZlcyAtPSAyO1xuICAgIHRoaXMuVGV4dE1hbmFnZXIuc3RhdHVzVGV4dChcIkxPU0UhXCIpO1xuICAgIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoMjAwMCwgdGhpcy5lbmQsIHRoaXMpO1xuICB9LFxuXG4gIHdpbjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5nb29kLnBsYXkoKTtcbiAgICB0aGlzLnJlYWR5ID0gZmFsc2U7XG4gICAgd2luZG93LlNwZWVkTXVsdGlwbGllciArPSAwLjU7XG4gICAgd2luZG93LlNjb3JlICs9IDEwMDtcbiAgICB0aGlzLlRleHRNYW5hZ2VyLnN0YXR1c1RleHQoXCJXSU4hXCIpO1xuICAgIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoMjAwMCwgdGhpcy5lbmQsIHRoaXMpO1xuICB9LFxuXG4gIGVuZDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVGhpc0NhdElzSG9yc2VTaGl0O1xuIiwidmFyIENsaWNrTWUgPSBmdW5jdGlvbiAoKSB7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IENsaWNrTWU7XG5cbkNsaWNrTWUucHJvdG90eXBlID0ge1xuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gJyMwMDAwMDAnO1xuXG4gICAgdmFyIHdhcm5pbmcgPSBcIldhcm5pbmdcIjtcbiAgICB2YXIgd2FybmluZ1Byb3BzID0geyBmb250OiAnNDhwdCBBcmlhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgZmlsbDogJyNDMjQzMDAnLFxuICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVRoaWNrbmVzczogMCB9O1xuXG4gICAgdmFyIGluZm8gPSBcInRoaXMgZ2FtZSBpcyBiZXN0IGVuam95ZWRcIjtcbiAgICB2YXIgaW5mbzIgPSBcIm9uIGEgc21hcnQgcGhvbmVcIjtcbiAgICB2YXIgaW5mb1Byb3BzID0geyBmb250OiAnMjJwdCBBcmlhbCcsIGZpbGw6ICcjQzI0MzAwJywgc3Ryb2tlVGhpY2tuZXNzOiAwIH07XG5cbiAgICB2YXIgd2FybmluZ1RleHQgPSB0aGlzLmdhbWUuYWRkLnRleHQoMCwgMCwgd2FybmluZywgd2FybmluZ1Byb3BzKTtcbiAgICB2YXIgaW5mb1RleHQgPSB0aGlzLmdhbWUuYWRkLnRleHQoMCwgMCwgaW5mbywgaW5mb1Byb3BzKTtcbiAgICB2YXIgaW5mbzJUZXh0ID0gdGhpcy5nYW1lLmFkZC50ZXh0KDAsIDAsIGluZm8yLCBpbmZvUHJvcHMpO1xuXG4gICAgd2FybmluZ1RleHQueCA9ICh0aGlzLmdhbWUud2lkdGggLyAyKSAtICh3YXJuaW5nVGV4dC53aWR0aCAvIDIpO1xuICAgIHdhcm5pbmdUZXh0LnkgPSAodGhpcy5nYW1lLmhlaWdodCAvIDQpIC0gKHdhcm5pbmdUZXh0LmhlaWdodCAvIDIpO1xuXG4gICAgaW5mb1RleHQueCA9ICh0aGlzLmdhbWUud2lkdGggLyAyKSAtIChpbmZvVGV4dC53aWR0aCAvIDIpO1xuICAgIGluZm9UZXh0LnkgPSAodGhpcy5nYW1lLmhlaWdodCAvIDIpIC0gKGluZm9UZXh0LmhlaWdodCAvIDIpO1xuXG4gICAgaW5mbzJUZXh0LnggPSAodGhpcy5nYW1lLndpZHRoIC8gMikgLSAoaW5mbzJUZXh0LndpZHRoIC8gMik7XG4gICAgaW5mbzJUZXh0LnkgPSAodGhpcy5nYW1lLmhlaWdodCAvIDEuOCkgLSAoaW5mbzJUZXh0LmhlaWdodCAvIDIpO1xuXG4gICAgdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMub25Eb3duLCB0aGlzKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgfSxcblxuICBvbkRvd246IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZ2FtZS5kZXZpY2UuZGVza3RvcCkge1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLmZ1bGxTY3JlZW5TY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLnN0YXJ0RnVsbFNjcmVlbih0cnVlKTtcbiAgICB9XG5cbiAgICB0aGlzLnN0YXJ0R2FtZSgpO1xuICB9LFxuXG4gIHN0YXJ0R2FtZTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdTQUdEWCcpO1xuICB9XG59O1xuIiwidmFyIFN3aXBlTWFuYWdlciA9IGZ1bmN0aW9uKGdhbWUsIGNhbGxiYWNrLCByZWNlaXZlciwgdmVydGljYWxJbmNsdWRlZCkge1xuICBQaGFzZXIuUGx1Z2luLmNhbGwodGhpcywgZ2FtZSk7XG4gIHRoaXMuZ2FtZSA9IGdhbWU7XG4gIHRoaXMub25Db29sZG93biA9IGZhbHNlO1xuICB0aGlzLmNvb2xkb3duID0gMDtcbiAgdGhpcy5jaGVja1ZlcnQgPSB2ZXJ0aWNhbEluY2x1ZGVkIHx8IGZhbHNlO1xuICB0aGlzLm9uU3dpcGUgPSBjYWxsYmFjay5iaW5kKHJlY2VpdmVyKTtcbiAgdGhpcy5zd2lwZURpcmVjdGlvbiA9IFN3aXBlTWFuYWdlci5TV0lQRV9ESVJFQ1RJT05TLkxFRlQ7XG59O1xuXG5Td2lwZU1hbmFnZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuUGx1Z2luLnByb3RvdHlwZSk7XG5Td2lwZU1hbmFnZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gU3dpcGVNYW5hZ2VyO1xuXG5Td2lwZU1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgc3RhcnQgPSB0aGlzLmdhbWUuaW5wdXQuYWN0aXZlUG9pbnRlci5wb3NpdGlvbkRvd247XG4gIHZhciBlbmQgPSB0aGlzLmdhbWUuaW5wdXQuYWN0aXZlUG9pbnRlci5wb3NpdGlvbjtcblxuICB2YXIgZGlzdGFuY2UgPSBQaGFzZXIuUG9pbnQuZGlzdGFuY2Uoc3RhcnQsIGVuZCk7XG4gIHZhciBkdXJhdGlvbiA9IHRoaXMuZ2FtZS5pbnB1dC5hY3RpdmVQb2ludGVyLmR1cmF0aW9uO1xuXG4gIGlmIChkdXJhdGlvbiA+IDAgJiYgIXRoaXMub25Db29sZG93bikge1xuICAgIGlmIChkaXN0YW5jZSA+IFN3aXBlTWFuYWdlci5TV0lQRV9ESVNUICYmIGR1cmF0aW9uIDwgU3dpcGVNYW5hZ2VyLlNXSVBFX1RJTUUpIHtcbiAgICAgIHN3aXBlRGlyZWN0aW9uID0gZW5kLnggPiBzdGFydC54ID8gU3dpcGVNYW5hZ2VyLlNXSVBFX0RJUkVDVElPTlMuUklHSFQgOlxuICAgICAgICBTd2lwZU1hbmFnZXIuU1dJUEVfRElSRUNUSU9OUy5MRUZUO1xuXG4gICAgICBpZiAodGhpcy5jaGVja1ZlcnQpIHtcbiAgICAgICAgdmFyIHhEaXN0ID0gc3RhcnQueCAtIGVuZC54O1xuICAgICAgICB2YXIgeURpc3QgPSBzdGFydC55IC0gZW5kLnk7XG4gICAgICAgIGlmIChNYXRoLmFicyh5RGlzdCkgPiBNYXRoLmFicyh4RGlzdCkpXG4gICAgICAgICAgc3dpcGVEaXJlY3Rpb24gPSBlbmQueSA+IHN0YXJ0LnkgPyBTd2lwZU1hbmFnZXIuU1dJUEVfRElSRUNUSU9OUy5ET1dOIDpcbiAgICAgICAgICAgIFN3aXBlTWFuYWdlci5TV0lQRV9ESVJFQ1RJT05TLlVQO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm9uU3dpcGUoc3dpcGVEaXJlY3Rpb24sIHN0YXJ0LCBlbmQpO1xuICAgICAgdGhpcy5vbkNvb2xkb3duID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBpZiAodGhpcy5vbkNvb2xkb3duKSB7XG4gICAgdGhpcy5jb29sZG93biArPSAxO1xuXG4gICAgaWYgKHRoaXMuY29vbGRvd24gPj0gU3dpcGVNYW5hZ2VyLlNXSVBFX0NPT0xET1dOKSB7XG4gICAgICB0aGlzLmNvb2xkb3duID0gMDtcbiAgICAgIHRoaXMub25Db29sZG93biA9IGZhbHNlO1xuICAgIH1cbiAgfVxufTtcblxuU3dpcGVNYW5hZ2VyLlNXSVBFX1RJTUUgPSAyNTA7XG5Td2lwZU1hbmFnZXIuU1dJUEVfRElTVCA9IDEwMDtcblN3aXBlTWFuYWdlci5TV0lQRV9DT09MRE9XTiA9IDEwO1xuU3dpcGVNYW5hZ2VyLlNXSVBFX0RJUkVDVElPTlMgPSB7XG4gIExFRlQ6IDAsXG4gIFJJR0hUOiAxLFxuICBVUDogMixcbiAgRE9XTjogM1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTd2lwZU1hbmFnZXI7XG4iLCJ2YXIgVGV4dE1hbmFnZXIgPSBmdW5jdGlvbihnYW1lKSB7XG4gIHRoaXMuZ2FtZSA9IGdhbWU7XG4gIHRoaXMuYm9udXNUZXh0cyA9IFtdO1xuICB0aGlzLmZsb2F0aW5nVGV4dHMgPSBbXTtcbn07XG5cblRleHRNYW5hZ2VyLnByb3RvdHlwZS5hZGRGbG9hdGluZ1RleHQgPSBmdW5jdGlvbih0ZXh0LCBkaXIsIHJlYXNvbiwgeCwgeSwgc2l6ZSkge1xuICB2YXIgc3RhcnRYID0geCB8fCB0aGlzLmdhbWUud2lkdGggLyAyO1xuICB2YXIgc3RhcnRZID0geSB8fCB0aGlzLmdhbWUuaGVpZ2h0IC8gMjtcbiAgdmFyIHR4dFNpemUgPSBzaXplIHx8IDQwO1xuICB2YXIgZGlyZWN0ID0gZGlyIHx8IFwidXBcIjtcbiAgdmFyIHRhcmdldCA9IDY0O1xuICB2YXIgdGV4dFJlYXNvbiA9IG51bGw7XG5cbiAgaWYgKGRpcmVjdCA9PT0gXCJkb3duXCIpXG4gICAgdGFyZ2V0ID0gdGhpcy5nYW1lLmhlaWdodCAtIDY0O1xuXG4gIHZhciB0ZXh0T2JqID0gdGhpcy5nYW1lLmFkZC50ZXh0KHN0YXJ0WCwgc3RhcnRZLCB0ZXh0LCB7IGZvbnQ6IHR4dFNpemUgKyAncHggQXJpYWwnIH0pO1xuICBjb25zb2xlLmxvZyh0ZXh0T2JqKTtcbiAgdGV4dE9iai54IC09ICh0ZXh0T2JqLndpZHRoIC8gMikgKyAxNjtcblxuICBpZiAodHlwZW9mIHJlYXNvbiAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHRleHRSZWFzb24gPSB0aGlzLmdhbWUuYWRkLnRleHQoMCwgLTE2LCByZWFzb24sIHsgZm9udDogJzE2cHggQXJpYWwnIH0pO1xuICAgIHRleHRPYmouYWRkQ2hpbGQodGV4dFJlYXNvbik7XG4gIH1cblxuICB2YXIgdHdlZW4gPSB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRleHRPYmouc2NhbGUpXG4gICAgICAgIC50byh7IHk6IDEuMiwgeDogMS4yIH0sIDIwMCwgUGhhc2VyLkVhc2luZy5MaW5lYXIuTm9uZSwgZmFsc2UsIDIwMCk7XG4gIHR3ZWVuLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uKCkge1xuICAgIHZhciB0d2VlbjIgPSB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRleHRPYmopXG4gICAgICAgICAgLnRvKHsgeTogdGFyZ2V0ICwgYWxwaGE6IDAgfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5MaW5lYXIuTm9uZSwgZmFsc2UsIDcwMCk7XG4gICAgdHdlZW4yLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uKCkge1xuICAgICAgdGV4dE9iai5kZXN0cm95KCk7XG4gICAgfSk7XG4gICAgdHdlZW4yLnN0YXJ0KCk7XG4gIH0sIHRoaXMpO1xuICB0d2Vlbi5zdGFydCgpO1xufTtcblxuVGV4dE1hbmFnZXIucHJvdG90eXBlLnN0YXR1c1RleHQgPSBmdW5jdGlvbih0ZXh0KSB7XG4gIHZhciB4ID0gdGhpcy5nYW1lLmNhbWVyYS54ICsgdGhpcy5nYW1lLndpZHRoIC8gMjtcbiAgdmFyIHkgPSAgdGhpcy5nYW1lLmNhbWVyYS55ICsgdGhpcy5nYW1lLmhlaWdodCAvIDI7XG5cbiAgdmFyIGJnID0gdGhpcy5nYW1lLmFkZC5ncmFwaGljcygwLCB5IC0gMzYpO1xuICBiZy5iZWdpbkZpbGwoMHgwMDAwMDAsIDEpO1xuICBiZy5ib3VuZHNQYWRkaW5nID0gMDtcbiAgYmcuZHJhd1JlY3QodGhpcy5nYW1lLmNhbWVyYS54LCAwLCB0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUud2lkdGgsIDY0KTtcblxuICB2YXIgdGV4dE9iaiA9IHRoaXMuZ2FtZS5hZGQudGV4dCh4LCB5LCB0ZXh0LCB7IGZvbnQ6ICc0MHB4IEFyaWFsJywgZmlsbDogJyNmZmZmZmYnIH0pO1xuICB0ZXh0T2JqLnggLT0gKHRleHRPYmoud2lkdGggLyAyKTtcbiAgdGV4dE9iai55IC09ICh0ZXh0T2JqLmhlaWdodCAvIDIpO1xuXG4gIHZhciBmbGFzaFR3ZWVuID0gdGhpcy5nYW1lLmFkZC50d2Vlbih0ZXh0T2JqKTtcbiAgZmxhc2hUd2Vlbi50byh7IHZpc2libGU6ICF0ZXh0T2JqLnZpc2libGUgfSwgMjAsIFBoYXNlci5FYXNpbmcuTGluZWFyLk5vbmUsIHRydWUsIDIwLCAtMSwgdHJ1ZSk7XG4gIGZsYXNoVHdlZW4uc3RhcnQoKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBUZXh0TWFuYWdlcjtcbiIsInZhciBVdGlscyA9IHtcbiAgY29udGFpbnNPYmplY3Q6IGZ1bmN0aW9uKG9iaiwgbGlzdCkge1xuICAgIHZhciBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAobGlzdFtpXSA9PT0gb2JqKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBVdGlscztcbiJdfQ==
